import{as as b,j as s,r as i,ag as I,K as S,a2 as v,W as k}from"./index-8fcf9617.js";import{V as a}from"./common-7ac8785d.js";import{S as M}from"./index-232bd61d.js";import{S as O}from"./index-1dd4ef3f.js";import{A as h}from"./index-bdd08a45.js";function F(){const{envs:r}=b();return Object.keys(r).map(t=>({label:s.jsxs("div",{className:"flex items-center justify-between w-full",children:[s.jsx("span",{children:t}),s.jsx("span",{className:"text-[#999] pl-1",children:r[t]})]}),value:t}))}const g=({className:r,value:t,onChange:e,inputProps:m,inputRender:c,envProps:d})=>{const x=S(),{kind:o,setKind:l}=i.useContext(j),E=F(),{envs:N}=b(),u=i.useMemo(()=>[{value:a.Static,label:x.formatMessage({id:"GisxFq",defaultMessage:[{type:0,value:"静态值"}]})},{value:a.Env,label:x.formatMessage({id:"txDRJz",defaultMessage:[{type:0,value:"环境变量"}]})}],[x]),V=i.useCallback(n=>{l(n),e==null||e(n===a.Env?{kind:n,environmentVariableName:""}:{kind:n,staticVariableContent:""})},[e,l]),p=i.useCallback(n=>{const f=typeof n=="string"?n:n.target.value;e==null||e(o===a.Env?{kind:o,environmentVariableName:f}:{kind:o,staticVariableContent:f})},[o,e]);return i.useEffect(()=>{l((t==null?void 0:t.kind)??a.Static)},[l,t==null?void 0:t.kind]),s.jsxs(M.Compact,{className:v("!flex",r),children:[s.jsx(O,{className:"!w-30",value:o,options:u,onChange:V}),o===a.Env?s.jsxs("div",{className:"relative flex-1",children:[s.jsx(h,{...d,className:"w-full",value:t==null?void 0:t.environmentVariableName,options:E,onChange:p}),(t==null?void 0:t.environmentVariableName)&&s.jsx("div",{className:"absolute right-2 top-0 bottom-0 leading-8 text-[#999] z-10",children:N[t.environmentVariableName]})]}):c?c({...m,value:t==null?void 0:t.staticVariableContent,onChange:p,className:"flex-1"}):s.jsx(k,{...m,className:"flex-1",value:t==null?void 0:t.staticVariableContent,onChange:p})]})},w=({formItemProps:r,rules:t,required:e,...m})=>{const[c,d]=i.useState(a.Static);return s.jsx(j.Provider,{value:{kind:c,setKind:d},children:s.jsx(I.Item,{...r,rules:c===a.Env?e?[{required:!0,message:"请选择一个环境变量或者手动输入"}]:void 0:e?[...t??[],{required:!0,message:"请输入"}]:t,children:s.jsx(g,{...m})})})},z=w,j=i.createContext(null);export{z as I,F as u};
