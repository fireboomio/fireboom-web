import{K as v,ag as m,as as j,r as k,j as e,am as b,an as N,Q as u,ad as C,W as I}from"./index-2eb05974.js";import{i as F}from"./use-immer.module-c1f9a4d1.js";import{s as p}from"./subs.module-3247843c.js";import{P as w}from"./index-642f2e5a.js";import{M as T}from"./index-a38c0e65.js";import{A as P}from"./index-09c103b6.js";import{T as R}from"./Table-53aebd9e.js";import"./index-91940c03.js";import"./PurePanel-327833dd.js";import"./index-bd62ba05.js";import"./useShowArrow-f9335512.js";import"./index-a5647e9f.js";import"./DownOutlined-374f1d77.js";import"./addEventListener-86c471af.js";import"./index-6dc22945.js";import"./conductUtil-ade3d0ab.js";import"./index-b93aa7bc.js";import"./index-3320778c.js";import"./index-06504f03.js";import"./LeftOutlined-91dc5901.js";import"./index-5b35cc76.js";import"./useBreakpoint-a4da2704.js";import"./useForceUpdate-a7e96963.js";import"./index-cd398968.js";function ae(){const s=v(),[i]=m.useForm(),{computed:{asArray:d},updateEnv:c,deleteEnv:g}=j(),[f,x]=F({}),[a,r]=k.useState(),y=t=>{console.log("Failed:",t)},h=()=>{i.resetFields(),r({key:"",value:""})},M=[{title:s.formatMessage({id:"GHE+9W",defaultMessage:[{type:0,value:"变量名"}]}),dataIndex:"key",key:"key",width:320},{title:s.formatMessage({id:"KiiWJR",defaultMessage:[{type:0,value:"变量值"}]}),dataIndex:"value",key:"value",render:(t,l)=>{const o=()=>x(n=>{n[l.key]=!n[l.key]});return e.jsx("div",{className:"flex items-center",children:f[l.key]?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:t}),e.jsx(b,{onClick:o,className:"ml-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"***********"}),e.jsx(N,{onClick:o,className:"ml-4"})]})})}},{title:s.formatMessage({id:"UtE0dS",defaultMessage:[{type:0,value:"操作"}]}),dataIndex:"action",width:200,render:(t,l)=>e.jsxs("div",{children:[e.jsx("img",{alt:"zhongmingming",src:"./assets/iconfont/zhongmingming.svg",style:{height:"1em",width:"1em"},onClick:()=>{r(l),i.setFieldsValue(l)},className:"mr-3"}),e.jsx(w,{title:s.formatMessage({id:"nS8PfW",defaultMessage:[{type:0,value:"确定要删除?"}]}),okText:s.formatMessage({id:"r0/TUu",defaultMessage:[{type:0,value:"确定"}]}),cancelText:s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]}),onConfirm:o=>{o.stopPropagation(),g(l.key)},onCancel:o=>{o.stopPropagation()},children:e.jsx("img",{alt:"shanchu",src:"./assets/iconfont/shanchu.svg",style:{height:"1em",width:"1em"},onClick:o=>o.stopPropagation()})})]})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white h-full px-8 pt-7",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"mt-0",children:e.jsx("span",{children:e.jsx(u,{id:"txDRJz",defaultMessage:[{type:0,value:"环境变量"}]})})}),e.jsx(C,{className:"mb-2mb-2",type:"default",onClick:h,children:e.jsx("span",{className:"h-7",children:e.jsx(u,{id:"qx0Xj9",defaultMessage:[{type:0,value:"新建环境变量"}]})})})]}),e.jsx(T,{mask:!1,title:a!=null&&a.key?s.formatMessage({id:"f0XHRN",defaultMessage:[{type:0,value:"修改环境变量"}]}):s.formatMessage({id:"AeO+ID",defaultMessage:[{type:0,value:"新建变量"}]}),forceRender:!0,transitionName:"",bodyStyle:{width:"549px",margin:"32px auto 48px"},open:!!a,onCancel:()=>r(void 0),okText:e.jsx("span",{className:p["save-env-btn"],onClick:()=>{i.submit()},children:a!=null&&a.key?s.formatMessage({id:"b5l2vN",defaultMessage:[{type:0,value:"保存"}]}):s.formatMessage({id:"BtZh7z",defaultMessage:[{type:0,value:"创建"}]})}),okButtonProps:{style:{background:"none"}},cancelText:e.jsxs("span",{className:"w-10",children:[s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]})," "]}),okType:"text",children:e.jsxs(m,{name:"envList",form:i,validateTrigger:["onBlur","onChange"],className:"ml-15",labelCol:{span:4},wrapperCol:{span:15},onFinish:async t=>{await c(t),r(void 0)},autoComplete:"off",onFinishFailed:y,labelAlign:"left",children:[e.jsx(m.Item,{label:s.formatMessage({id:"ekxzlF",defaultMessage:[{type:0,value:"名称"}]}),name:"key",rules:a!=null&&a.key?[]:[{required:!0,message:s.formatMessage({id:"mfZMW6",defaultMessage:[{type:0,value:"名称不能为空"}]})},{pattern:new RegExp("^[a-zA-Z_][a-zA-Z0-9_]*$","g"),message:s.formatMessage({id:"VmsX4o",defaultMessage:[{type:0,value:"以字母或下划线开头，只能由数字、字母、下划线组成"}]})},{validator:(t,l)=>d.find(n=>n.key==l)?Promise.reject(s.formatMessage({id:"/aSrX0",defaultMessage:[{type:0,value:"名称重复"}]})):Promise.resolve()}],children:e.jsx(P,{disabled:!!(a!=null&&a.key),options:[{value:"GITHUB_PROXY_URL"},{value:"GITHUB_RAW_PROXY_URL"}]})}),e.jsx(m.Item,{label:s.formatMessage({id:"zbqD5q",defaultMessage:[{type:0,value:"值"}]}),name:"value",rules:[{required:!0,pattern:/^.{1,256}$/g,message:s.formatMessage({id:"ILCVXB",defaultMessage:[{type:0,value:"请输入长度不大于256的非空值"}]})}],children:e.jsx(I,{})})]})}),e.jsx(R,{columns:M,dataSource:d,rowKey:t=>t.key,pagination:!1,className:"mb-3 "+p.envTable})]})})}export{ae as default};
