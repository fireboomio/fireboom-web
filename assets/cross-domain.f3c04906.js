import{d as V,Z as t,r as h,c as y,j as e,F as E,f as r,g as f,I as O,B as k}from"./index.e5e6c754.js";import"./iconUtil.31c13224.js";import"./index.5e1fa168.js";import{S as N}from"./index.6926b693.js";import{S as p}from"./index.daad23d2.js";import{i as P}from"./use-immer.module.1d9a0526.js";import{F as T}from"./FormTooltip.a240d273.js";import{H as I}from"./constant.e50476cd.js";import{s as F}from"./subs.module.a70cc990.js";import{P as R}from"./PlusOutlined.5b3e3b8c.js";import"./KeyCode.9c493596.js";import"./pickAttrs.c5bbb5fc.js";import"./Overflow.321ca619.js";import"./DownOutlined.75881d1e.js";import"./index.60d20720.js";import"./css.7dd30b7b.js";import"./DialogWrap.947e0e2f.js";import"./RightOutlined.73e4cc97.js";const j="/assets/tip-cros.822214df.png",q={wrapperCol:{xs:{span:24},sm:{span:16}}};function oe(){const s=V(),[o,S]=P({}),[n]=t.useForm(),[i,d]=h.exports.useState(),u=h.exports.useCallback(async(a,m)=>{await y.post("/global",{key:a,val:m})},[]);return h.exports.useEffect(()=>{y.get("/setting/corsConfiguration").then(a=>{S(a)})},[i]),e(E,{children:o.allowedOrigins?e("div",{className:"pt-8 pl-8",children:r(t,{form:n,initialValues:{allowedMethods:o.allowedMethods,maxAge:o.maxAge,allowedHeaders:o.allowedHeaders,exposedHeaders:o.exposedHeaders,allowCredentials:o.allowCredentials},labelAlign:"left",labelCol:{xs:{span:3},sm:{span:3}},wrapperCol:{xs:{span:10},sm:{span:9}},children:[r(t.Item,{label:r("div",{children:[e("span",{children:e(f,{id:"R5wYZd",defaultMessage:[{type:0,value:"\u5141\u8BB8\u6E90"}]})}),e(T,{className:"!left-4",title:e("img",{src:j,className:"max-w-60vw max-h-60vh",alt:""})})]}),wrapperCol:{xs:{span:20},sm:{span:20}},children:[e(N,{className:F["switch-edit-btn"],checked:o.allowedOriginsEnable,size:"small",onChange:a=>{u("allowedOriginsEnable",a).then(()=>{d(!i)})}}),e("span",{className:"text-default ml-4",children:e(f,{id:"1jRYJf",defaultMessage:[{type:0,value:"\u5141\u8BB8\u5168\u90E8"}]})})]}),!o.allowedOriginsEnable&&e(t.Item,{wrapperCol:{offset:3,xs:{span:20},sm:{span:20}},children:e(t.List,{name:"allowedOrigins",initialValue:o.allowedOrigins,children:(a,{add:m,remove:H},{errors:A})=>r(E,{children:[a.map((v,w)=>{var M;const c=n.getFieldValue(["allowedOrigins",v.name])||"https://",B=(l,g)=>{let[,x="https://",b=""]=(c==null?void 0:c.match(/(^https?:\/\/)(.*)/))||[];l==="protocol"?x=g:b=g;const D=`${x}${b}`;n.setFieldValue(["allowedOrigins",v.name],D),l==="protocol"&&C()},C=()=>{n.getFieldValue("allowedOrigins").filter(l=>l==null?void 0:l.replace(/https?:\/\//,"").trim()),u("allowedOrigins",n.getFieldValue("allowedOrigins")).then(()=>{d(!i)})};return h.exports.createElement(t.Item,{...q,required:!1,key:v.key},e(t.Item,{validateTrigger:["onChange","onBlur"],noStyle:!0,children:r("div",{children:[e("div",{children:s.formatMessage({id:"tdD1O3",defaultMessage:[{type:0,value:"\u57DF\u540D"}]})+(w+1).toString()+":"}),e(O,{addonBefore:r(p,{defaultValue:(M=c.match(/^https?:\/\//))==null?void 0:M[0],className:"select-before",onChange:l=>B("protocol",l),children:[e(p.Option,{value:"https://",children:"https://"}),e(p.Option,{value:"http://",children:"http://"})]}),placeholder:s.formatMessage({id:"Hv6ThW",defaultMessage:[{type:0,value:"\u5BF9\u5E94\u8BF7\u6C42\u54CD\u5E94\u4E2D\u7684: Access-Control-Allow-Origin"}]}),style:{width:"60%"},onChange:l=>B("path",l.target.value),defaultValue:c.replace(/^https?:\/\//,""),onBlur:C,onPressEnter:C}),e("span",{className:`${F["form-delete-icon"]}`,onClick:()=>{y.post("/global",{key:"allowedOrigins",val:n.getFieldValue("allowedOrigins").filter((l,g)=>g!=w)}).then(()=>{H(w)})},children:e("img",{src:"/assets/deleteIcon.svg",alt:" "})})]})}))}),r(t.Item,{wrapperCol:{span:20},className:"mt-4",children:[e(k,{type:"dashed",style:{width:"48%"},icon:e(R,{}),className:"text-gray-500/60",onClick:()=>m(),children:e(f,{id:"5BzHRY",defaultMessage:[{type:0,value:"\u65B0\u589EOrigin"}]})}),e(t.ErrorList,{errors:A})]})]})})}),e(t.Item,{name:"allowedMethods",label:s.formatMessage({id:"3SibWe",defaultMessage:[{type:0,value:"\u5141\u8BB8\u65B9\u6CD5"}]}),className:"-mt-3",children:e(p,{style:{width:"90%"},mode:"multiple",placeholder:s.formatMessage({id:"Xhn2gT",defaultMessage:[{type:0,value:"\u8BF7\u9009\u62E9"}]}),onChange:a=>{u("allowedMethods",a).then(()=>{d(!i)})},children:["GET","POST"].map(a=>e(p.Option,{value:a,children:a},a))})}),e(t.Item,{name:"allowedHeaders",label:s.formatMessage({id:"mA7n5i",defaultMessage:[{type:0,value:"\u5141\u8BB8\u5934"}]}),children:e(p,{mode:"tags",options:I.map(a=>({label:a,value:a})),onChange:a=>{u("allowedHeaders",a).then(()=>{d(!i)})}})}),e(t.Item,{name:"exposedHeaders",label:s.formatMessage({id:"K27Y7X",defaultMessage:[{type:0,value:"\u6392\u9664\u5934"}]}),children:e(p,{mode:"tags",options:I.map(a=>({label:a,value:a})),onChange:a=>{u("exposedHeaders",a).then(()=>{d(!i)})}})}),e(t.Item,{label:s.formatMessage({id:"aE19iu",defaultMessage:[{type:0,value:"\u8DE8\u57DF\u65F6\u95F4"}]}),children:e(t.Item,{name:"maxAge",validateTrigger:["onChange","onBlur"],noStyle:!0,rules:[{validator:(a,m)=>{if(m)return m<0||m>86400?Promise.reject(s.formatMessage({id:"NYgxWS",defaultMessage:[{type:0,value:"\u8BF7\u586B\u5199\u8303\u56F4\u5185\u7684\u8DE8\u57DF\u65F6\u95F4,\u8303\u56F4\u4E3A0 - 86400 \u79D2"}]})):Promise.resolve()}}],children:e(O,{addonAfter:s.formatMessage({id:"XEPmlP",defaultMessage:[{type:0,value:"\u79D2"}]}),onBlur:()=>{u("maxAge",Number(n.getFieldValue("maxAge"))).then(()=>{d(!i)})},onPressEnter:()=>{u("maxAge",Number(n.getFieldValue("maxAge"))).then(()=>{d(!i)})}})})}),r(t.Item,{label:s.formatMessage({id:"WNS/6E",defaultMessage:[{type:0,value:"\u5141\u8BB8\u8BC1\u4E66"}]}),children:[e(t.Item,{valuePropName:"checked",name:"allowCredentials",noStyle:!0,required:!0,children:e(N,{size:"small",className:F["switch-edit-btn"],checked:o.allowCredentials,onChange:a=>{u("allowCredentials",a).then(()=>{d(!i)})}})}),r("span",{className:"h-6 ml-4 text-gray-500 inline-block",children:[e("img",{alt:"zhuyi",src:"assets/iconfont/zhuyi.svg",style:{height:"1em",width:"1em"},className:"text-[14px]"})," ",e(f,{id:"HSZ1vp",defaultMessage:[{type:0,value:"\u662F\u5426\u5141\u8BB8\u8BC1\u4E66"}]})]})]})]})}):""})}export{oe as default};
