import{t as ps,c as xs,d as Nt,r as o,e as gt,f as qt,o as vs,_ as ys,A as it,h as rt,i as Ht,k as B,l as Se,p as bs,R as We,I as pt,w as _s,m as js,n as ws,s as Vt,q as tt,v as xt,U as Fe,x as ze,S as Ms,y as ks,z as G,B as Cs,D as It,E as Pe,F as Ss,G as Ns,H as At,J as Is,K as be,C as Wt,L as Ut,b as Re,M as Kt,N as Gt,j as e,O as _t,u as $e,P as Yt,Q as w,g as vt,T as te,V as ne,W as Qt,X as Zt,Y as As,Z as Es,$ as Ee,a0 as Oe,a1 as ft,a2 as nt,a3 as Rs,a4 as Jt,a5 as $s,a6 as st,a7 as Ge,a8 as jt,a9 as Xt,aa as es,ab as Ts,ac as Fs,ad as qe,ae as yt,af as Ce,ag as Os,ah as Ds,ai as ye,aj as Ps,ak as Bs}from"./index-a194352f.js";import{d as Le}from"./dayjs.min-3f69c204.js";import{i as Ls}from"./use-immer.module-5eff6578.js";import{G as He}from"./globalContext-ca83e6af.js";import{W as Ue}from"./workbenchContext-5e70c262.js";import{S as me}from"./interface-41bd3122.js";import{u as ts}from"./engine-9b49d695.js";import{p as zs,w as qs}from"./db-38bf0aa6.js";import{J as Hs}from"./index-ece89910.js";import{u as wt}from"./variable-62d048d3.js";import{u as Vs}from"./auth-d9a41f11.js";import{r as Ve}from"./hotkey-3a258436.js";import{M as ss}from"./index-24b15e3c.js";import{P as as}from"./index-cbbb9550.js";import{P as Ws}from"./PrismaSchemaContext-b413fd04.js";import{S as ns,L as Us,a as Ks,D as ot,M as Gs}from"./index-9ecf1558.js";import{T as Ys}from"./index-cfc29fbc.js";import{u as Mt}from"./validate-2aa69327.js";import{u as Qs}from"./store-fb3bcbe5.js";import{u as Zs,g as Js,D as Xs,i as ea}from"./datasource-aeb77a97.js";import{P as kt}from"./index-0819aea3.js";import{I as ta}from"./index-f7f97548.js";import{I as sa}from"./index-47a6ce9b.js";import{D as aa}from"./DownOutlined-41d61a23.js";import{W as na}from"./WarningOutlined-bdcc9a41.js";import{V as ia}from"./index-5d7fb404.js";import{u as ra}from"./calcTime-fb7795e9.js";import{c as oa}from"./index-ce3c58de.js";import{f as la}from"./utils-9b986f1e.js";import{u as ca}from"./ServiceDiscovery-2e176802.js";import{C as da}from"./CopyOutlined-e41cebb1.js";import{S as Et}from"./index-1f632c02.js";function ua(t,s,a){return typeof a=="boolean"?a:t.length?!0:ps(s).some(n=>n.type===ns)}const fa=t=>{const{componentCls:s,bodyBg:a,lightSiderBg:i,lightTriggerBg:n,lightTriggerColor:l}=t;return{[`${s}-sider-light`]:{background:i,[`${s}-sider-trigger`]:{color:l,background:n},[`${s}-sider-zero-width-trigger`]:{color:l,background:n,border:`1px solid ${a}`,borderInlineStart:0}}}},ma=fa,ha=t=>{const{antCls:s,componentCls:a,colorText:i,triggerColor:n,footerBg:l,triggerBg:c,headerHeight:u,headerPadding:p,headerColor:v,footerPadding:b,triggerHeight:m,zeroTriggerHeight:_,zeroTriggerWidth:k,motionDurationMid:N,motionDurationSlow:E,fontSize:S,borderRadius:j,bodyBg:P,headerBg:H,siderBg:g}=t;return{[a]:Object.assign(Object.assign({display:"flex",flex:"auto",flexDirection:"column",minHeight:0,background:P,"&, *":{boxSizing:"border-box"},[`&${a}-has-sider`]:{flexDirection:"row",[`> ${a}, > ${a}-content`]:{width:0}},[`${a}-header, &${a}-footer`]:{flex:"0 0 auto"},[`${a}-sider`]:{position:"relative",minWidth:0,background:g,transition:`all ${N}, background 0s`,"&-children":{height:"100%",marginTop:-.1,paddingTop:.1,[`${s}-menu${s}-menu-inline-collapsed`]:{width:"auto"}},"&-has-trigger":{paddingBottom:m},"&-right":{order:1},"&-trigger":{position:"fixed",bottom:0,zIndex:1,height:m,color:n,lineHeight:Nt(m),textAlign:"center",background:c,cursor:"pointer",transition:`all ${N}`},"&-zero-width":{"> *":{overflow:"hidden"},"&-trigger":{position:"absolute",top:u,insetInlineEnd:t.calc(k).mul(-1).equal(),zIndex:1,width:k,height:_,color:n,fontSize:t.fontSizeXL,display:"flex",alignItems:"center",justifyContent:"center",background:g,borderStartStartRadius:0,borderStartEndRadius:j,borderEndEndRadius:j,borderEndStartRadius:0,cursor:"pointer",transition:`background ${E} ease`,"&::after":{position:"absolute",inset:0,background:"transparent",transition:`all ${E}`,content:'""'},"&:hover::after":{background:"rgba(255, 255, 255, 0.2)"},"&-right":{insetInlineStart:t.calc(k).mul(-1).equal(),borderStartStartRadius:j,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:j}}}}},ma(t)),{"&-rtl":{direction:"rtl"}}),[`${a}-header`]:{height:u,padding:p,color:v,lineHeight:Nt(u),background:H,[`${s}-menu`]:{lineHeight:"inherit"}},[`${a}-footer`]:{padding:b,color:i,fontSize:S,background:l},[`${a}-content`]:{flex:"auto",color:i,minHeight:0}}},ga=t=>{const{colorBgLayout:s,controlHeight:a,controlHeightLG:i,colorText:n,controlHeightSM:l,marginXXS:c,colorTextLightSolid:u,colorBgContainer:p}=t,v=i*1.25;return{colorBgHeader:"#001529",colorBgBody:s,colorBgTrigger:"#002140",bodyBg:s,headerBg:"#001529",headerHeight:a*2,headerPadding:`0 ${v}px`,headerColor:n,footerPadding:`${l}px ${v}px`,footerBg:s,siderBg:"#001529",triggerHeight:i+c*2,triggerBg:"#002140",triggerColor:u,zeroTriggerWidth:i,zeroTriggerHeight:i,lightSiderBg:p,lightTriggerBg:p,lightTriggerColor:n}},is=xs("Layout",t=>[ha(t)],ga,{deprecatedTokens:[["colorBgBody","bodyBg"],["colorBgHeader","headerBg"],["colorBgTrigger","triggerBg"]]});var rs=globalThis&&globalThis.__rest||function(t,s){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&s.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)s.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(a[i[n]]=t[i[n]]);return a};function lt(t){let{suffixCls:s,tagName:a,displayName:i}=t;return n=>o.forwardRef((c,u)=>o.createElement(n,Object.assign({ref:u,suffixCls:s,tagName:a},c)))}const Ct=o.forwardRef((t,s)=>{const{prefixCls:a,suffixCls:i,className:n,tagName:l}=t,c=rs(t,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:u}=o.useContext(gt),p=u("layout",a),[v,b,m]=is(p),_=i?`${p}-${i}`:p;return v(o.createElement(l,Object.assign({className:qt(a||_,n,b,m),ref:s},c)))}),pa=o.forwardRef((t,s)=>{const{direction:a}=o.useContext(gt),[i,n]=o.useState([]),{prefixCls:l,className:c,rootClassName:u,children:p,hasSider:v,tagName:b,style:m}=t,_=rs(t,["prefixCls","className","rootClassName","children","hasSider","tagName","style"]),k=vs(_,["suffixCls"]),{getPrefixCls:N,layout:E}=o.useContext(gt),S=N("layout",l),j=ua(i,p,v),[P,H,g]=is(S),I=qt(S,{[`${S}-has-sider`]:j,[`${S}-rtl`]:a==="rtl"},E==null?void 0:E.className,c,u,H,g),R=o.useMemo(()=>({siderHook:{addSider:D=>{n(A=>[].concat(ys(A),[D]))},removeSider:D=>{n(A=>A.filter(V=>V!==D))}}}),[]);return P(o.createElement(Us.Provider,{value:R},o.createElement(b,Object.assign({ref:s,className:I,style:Object.assign(Object.assign({},E==null?void 0:E.style),m)},k),p)))}),xa=lt({tagName:"div",displayName:"Layout"})(pa),va=lt({suffixCls:"header",tagName:"header",displayName:"Header"})(Ct),ya=lt({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(Ct),ba=lt({suffixCls:"content",tagName:"main",displayName:"Content"})(Ct),_a=xa,De=_a;De.Header=va;De.Footer=ya;De.Content=ba;De.Sider=ns;De._InternalSiderContext=Ks;const at=De;var ja={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};const wa=ja;var Ma=function(s,a){return o.createElement(it,rt({},s,{ref:a,icon:wa}))},ka=o.forwardRef(Ma);const Ca=ka;var Sa={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"};const Na=Sa;var Ia=function(s,a){return o.createElement(it,rt({},s,{ref:a,icon:Na}))},Aa=o.forwardRef(Ia);const Ea=Aa;var Ra={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};const $a=Ra;var Ta=function(s,a){return o.createElement(it,rt({},s,{ref:a,icon:$a}))},Fa=o.forwardRef(Ta);const Oa=Fa;var Da={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};const Pa=Da;var Ba=function(s,a){return o.createElement(it,rt({},s,{ref:a,icon:Pa}))},La=o.forwardRef(Ba);const za=La;var ae=(t=>(t.Authentication="authentication",t.Configuration="config",t.DataSource="datasource",t.Operation="operation",t.Role="role",t.Storage="storage",t.SDK="sdk",t))(ae||{});const os=Ht((t,s)=>({logs:[],setLogs:a=>t({logs:a}),questions:[],setQuestions:a=>t({questions:a})})),qa=(t,s)=>B.put("/globalOperation",{globalHttpTransportHooks:{[t]:s}}),Ha=(t,s,a)=>s==="mockResolve"?B.put("/operation",{path:t,hooksConfiguration:{[s]:{enabled:a}}}):B.put("/operation",{path:t,hooksConfiguration:{[s]:a}}),Rt="notification.silent",ct=Ht((t,s)=>({visible:!1,silentMode:localStorage.getItem(Rt)==="1",notifications:[],hide(){t({visible:!1})},toggleVisible(){t({visible:!s().visible})},toggleSilentMode(){t({silentMode:!s().silentMode}),localStorage.setItem(Rt,s().silentMode?"1":"0")},addNotification:a=>{s().notifications.some(i=>i.title===a.title)||(t({notifications:[{id:Se.uniqueId(),...a},...s().notifications]}),s().silentMode||t({visible:!0}))},removeNotification(a){t({notifications:s().notifications.filter(i=>i!==a)}),s().notifications.length||t({visible:!1})},removeByTag(a){t({notifications:s().notifications.filter(i=>i.tag!==a)}),s().notifications.length||t({visible:!1})},clear(){t({notifications:[],visible:!1})}}));class $t{constructor(s){this.cache=void 0,this.cache=s}define(s,a){this.cache[s]=a}get(s){return this.cache[s]}remove(s){delete this.cache[s]}reset(){this.cache={}}load(s){this.cache={...this.cache,...s}}}class dt extends Error{constructor(s){super(s),this.name="Eta Error"}}class ls extends dt{constructor(s){super(s),this.name="EtaParser Error"}}class Va extends dt{constructor(s){super(s),this.name="EtaRuntime Error"}}class bt extends dt{constructor(s){super(s),this.name="EtaFileResolution Error"}}class Wa extends dt{constructor(s){super(s),this.name="EtaNameResolution Error"}}function Be(t,s,a){const i=s.slice(0,a).split(/\n/),n=i.length,l=i[n-1].length+1;throw t+=" at line "+n+" col "+l+`:

  `+s.split(/\n/)[n-1]+`
  `+Array(l).join(" ")+"^",new ls(t)}function Ua(t,s,a,i){const n=s.split(`
`),l=Math.max(a-3,0),c=Math.min(n.length,a+3),u=i,p=n.slice(l,c).map(function(m,_){const k=_+l+1;return(k==a?" >> ":"    ")+k+"| "+m}).join(`
`),v=u?u+":"+a+`
`:"line "+a+`
`,b=new Va(v+p+`

`+t.message);throw b.name=t.name,b}const Ka=(async function(){}).constructor;function Ga(t,s){const a=this.config,i=s&&s.async?Ka:Function;try{return new i(a.varName,"options",this.compileToString.call(this,t,s))}catch(n){throw n instanceof SyntaxError?new ls(`Bad template syntax

`+n.message+`
`+Array(n.message.length+1).join("=")+`
`+this.compileToString.call(this,t,s)+`
`):n}}function Ya(t,s){const a=this.config,i=s&&s.async,n=this.compileBody,l=this.parse.call(this,t);let c=`${a.functionHeader}
let include = (template, data) => this.render(template, data, options);
let includeAsync = (template, data) => this.renderAsync(template, data, options);

let __eta = {res: "", e: this.config.escapeFunction, f: this.config.filterFunction${a.debug?', line: 1, templateStr: "'+t.replace(/\\|"/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n")+'"':""}};

function layout(path, data) {
  __eta.layout = path;
  __eta.layoutData = data;
}${a.debug?"try {":""}${a.useWith?"with("+a.varName+"||{}){":""}

${n.call(this,l)}
if (__eta.layout) {
  __eta.res = ${i?"await includeAsync":"include"} (__eta.layout, {...${a.varName}, body: __eta.res, ...__eta.layoutData});
}
${a.useWith?"}":""}${a.debug?"} catch (e) { this.RuntimeErr(e, __eta.templateStr, __eta.line, options.filepath) }":""}
return __eta.res;
`;if(a.plugins)for(let u=0;u<a.plugins.length;u++){const p=a.plugins[u];p.processFnString&&(c=p.processFnString(c,a))}return c}function Qa(t){const s=this.config;let a=0;const i=t.length;let n="";for(a;a<i;a++){const l=t[a];if(typeof l=="string")n+="__eta.res+='"+l+`'
`;else{const c=l.t;let u=l.val||"";s.debug&&(n+="__eta.line="+l.lineNo+`
`),c==="r"?(s.autoFilter&&(u="__eta.f("+u+")"),n+="__eta.res+="+u+`
`):c==="i"?(s.autoFilter&&(u="__eta.f("+u+")"),s.autoEscape&&(u="__eta.e("+u+")"),n+="__eta.res+="+u+`
`):c==="e"&&(n+=u+`
`)}}return n}function Za(t,s,a,i){let n,l;return Array.isArray(s.autoTrim)?(n=s.autoTrim[1],l=s.autoTrim[0]):n=l=s.autoTrim,(a||a===!1)&&(n=a),(i||i===!1)&&(l=i),!l&&!n?t:n==="slurp"&&l==="slurp"?t.trim():(n==="_"||n==="slurp"?t=t.trimStart():(n==="-"||n==="nl")&&(t=t.replace(/^(?:\r\n|\n|\r)/,"")),l==="_"||l==="slurp"?t=t.trimEnd():(l==="-"||l==="nl")&&(t=t.replace(/(?:\r\n|\n|\r)$/,"")),t)}const Ja={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Xa(t){return Ja[t]}function en(t){const s=String(t);return/[&<>"']/.test(s)?s.replace(/[&<>"']/g,Xa):s}const Tt={autoEscape:!0,autoFilter:!1,autoTrim:[!1,"nl"],cache:!1,cacheFilepaths:!0,debug:!1,escapeFunction:en,filterFunction:t=>String(t),functionHeader:"",parse:{exec:"",interpolate:"=",raw:"~"},plugins:[],rmWhitespace:!1,tags:["<%","%>"],useWith:!1,varName:"it",defaultExtension:".eta"},Ye=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,Qe=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,Ze=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;function Je(t){return t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function tn(t,s){return t.slice(0,s).split(`
`).length}function sn(t){const s=this.config;let a=[],i=!1,n=0;const l=s.parse;if(s.plugins)for(let m=0;m<s.plugins.length;m++){const _=s.plugins[m];_.processTemplate&&(t=_.processTemplate(t,s))}s.rmWhitespace&&(t=t.replace(/[\r\n]+/g,`
`).replace(/^\s+|\s+$/gm,"")),Ye.lastIndex=0,Qe.lastIndex=0,Ze.lastIndex=0;function c(m,_){m&&(m=Za(m,s,i,_),m&&(m=m.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),a.push(m)))}const u=[l.exec,l.interpolate,l.raw].reduce(function(m,_){return m&&_?m+"|"+Je(_):_?Je(_):m},""),p=new RegExp(Je(s.tags[0])+"(-|_)?\\s*("+u+")?\\s*","g"),v=new RegExp("'|\"|`|\\/\\*|(\\s*(-|_)?"+Je(s.tags[1])+")","g");let b;for(;b=p.exec(t);){const m=t.slice(n,b.index);n=b[0].length+b.index;const _=b[1],k=b[2]||"";c(m,_),v.lastIndex=n;let N,E=!1;for(;N=v.exec(t);)if(N[1]){const S=t.slice(n,N.index);p.lastIndex=n=v.lastIndex,i=N[2],E={t:k===l.exec?"e":k===l.raw?"r":k===l.interpolate?"i":"",val:S};break}else{const S=N[0];if(S==="/*"){const j=t.indexOf("*/",v.lastIndex);j===-1&&Be("unclosed comment",t,N.index),v.lastIndex=j}else S==="'"?(Qe.lastIndex=N.index,Qe.exec(t)?v.lastIndex=Qe.lastIndex:Be("unclosed string",t,N.index)):S==='"'?(Ze.lastIndex=N.index,Ze.exec(t)?v.lastIndex=Ze.lastIndex:Be("unclosed string",t,N.index)):S==="`"&&(Ye.lastIndex=N.index,Ye.exec(t)?v.lastIndex=Ye.lastIndex:Be("unclosed string",t,N.index))}E?(s.debug&&(E.lineNo=tn(t,b.index)),a.push(E)):Be("unclosed tag",t,b.index)}if(c(t.slice(n,t.length),!1),s.plugins)for(let m=0;m<s.plugins.length;m++){const _=s.plugins[m];_.processAST&&(a=_.processAST(a,s))}return a}function cs(t,s){const a=s&&s.async?this.templatesAsync:this.templatesSync;if(this.resolvePath&&this.readFile&&!t.startsWith("@")){const i=s.filepath,n=a.get(i);if(this.config.cache&&n)return n;{const l=this.readFile(i),c=this.compile(l,s);return this.config.cache&&a.define(i,c),c}}else{const i=a.get(t);if(i)return i;throw new Wa("Failed to get template '"+t+"'")}}function ds(t,s,a){let i;const n={...a,async:!1};return typeof t=="string"?(this.resolvePath&&this.readFile&&!t.startsWith("@")&&(n.filepath=this.resolvePath(t,n)),i=cs.call(this,t,n)):i=t,i.call(this,s,n)}function us(t,s,a){let i;const n={...a,async:!0};typeof t=="string"?(this.resolvePath&&this.readFile&&!t.startsWith("@")&&(n.filepath=this.resolvePath(t,n)),i=cs.call(this,t,n)):i=t;const l=i.call(this,s,n);return Promise.resolve(l)}function an(t,s){const a=this.compile(t,{async:!1});return ds.call(this,a,s)}function nn(t,s){const a=this.compile(t,{async:!0});return us.call(this,a,s)}class rn{constructor(s){this.config=void 0,this.RuntimeErr=Ua,this.compile=Ga,this.compileToString=Ya,this.compileBody=Qa,this.parse=sn,this.render=ds,this.renderAsync=us,this.renderString=an,this.renderStringAsync=nn,this.filepathCache={},this.templatesSync=new $t({}),this.templatesAsync=new $t({}),this.resolvePath=null,this.readFile=null,s?this.config={...Tt,...s}:this.config={...Tt}}configure(s){this.config={...this.config,...s}}withConfig(s){return{...this,config:{...this.config,...s}}}loadTemplate(s,a,i){if(typeof a=="string")(i&&i.async?this.templatesAsync:this.templatesSync).define(s,this.compile(a,i));else{let n=this.templatesSync;(a.constructor.name==="AsyncFunction"||i&&i.async)&&(n=this.templatesAsync),n.define(s,a)}}}function on(t){let s="";try{s=(void 0)(t,"utf8")}catch(a){throw(a==null?void 0:a.code)==="ENOENT"?new bt(`Could not find template: ${t}`):a}return s}function ln(t,s){let a="";const i=this.config.views;if(!i)throw new bt("Views directory is not defined");const n=s&&s.filepath,l=this.config.defaultExtension===void 0?".eta":this.config.defaultExtension,c=JSON.stringify({filename:n,path:t,views:this.config.views});if(t+=(void 0)(t)?"":l,n){if(this.config.cacheFilepaths&&this.filepathCache[c])return this.filepathCache[c];const u=dn.exec(t);if(u&&u.length){const p=t.replace(/^\/*|^\\*/,"");a=(void 0)(i,p)}else a=(void 0)((void 0)(n),t)}else a=(void 0)(i,t);if(!cn(i,a))throw new bt(`Template '${t}' is not in the views directory`)}function cn(t,s){return(void 0)(t,s)}const dn=/^\\|^\//;class un extends rn{constructor(...s){super(...s),this.readFile=on,this.resolvePath=ln}}const fn=new un;function mn(t,s){const a=s.replace(/^\./,"");return`https://raw.git.fireboom.io/fireboomio/files/main/templates/${t.join("/")}.${a}`}async function hn(t,s){let a="";try{a=await B.get(`/vscode/readFile?uri=template/${t.name}/snippets/${s.join("/")}${t.extension}.eta`,{ignoreError:!0})}catch{}return a||(a=await bs(mn([t.language==="go"?"golang":t.language,...s],t.extension))),a}function gn(t,s){return fn.renderString(t,{...s,upperFirst:Se.upperFirst})}async function Ae(t,s,a){const i=await hn(t,s);return gn(i,a)}async function pn(t,s){const a=t.split("/"),i=a.pop().split(".")[0],n=a[a.length-1];let l="";const c={packageName:n,name:i};if(t.match(/custom-\w+\/global\//))l=await Ae(s,["global",i],c);else if(t.match(/custom-\w+\/authentication\//))l=await Ae(s,["authentication",i],c);else if(t.match(/custom-\w+\/customize\//))l=await Ae(s,["custom","customize"],c);else if(t.match(/custom-\w+\/function\//))l=await Ae(s,["custom","function"],c);else if(t.match(/custom-\w+\/proxy\//))l=await Ae(s,["custom","proxy"],c);else if(t.match(/custom-\w+\/storage/)){const u=a.pop(),p=a.pop();l=await Ae(s,["upload",i],{...c,providerName:p,profileName:u})}else{const u=a.slice(2).join("/"),p=a.slice(2).join("__");l=await Ae(s,["operation",i],{...c,operationPath:u,operationName:p})}return l}const xn="_workbench_19yet_1",vn="_header_19yet_1",yn="_footer_19yet_7",bn="_sider_19yet_13",Xe={workbench:xn,header:vn,footer:yn,sider:bn},Ft=We.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(s=>{t.status="fulfilled",t.value=s},s=>{t.status="rejected",t.reason=s}),t)}),mt={dedupe:!0},_n=(t,s,a)=>{const{cache:i,compare:n,suspense:l,fallbackData:c,revalidateOnMount:u,revalidateIfStale:p,refreshInterval:v,refreshWhenHidden:b,refreshWhenOffline:m,keepPreviousData:_}=a,[k,N,E,S]=Ms.get(i),[j,P]=Vt(t),H=o.useRef(!1),g=o.useRef(!1),I=o.useRef(j),R=o.useRef(s),D=o.useRef(a),A=()=>D.current,V=()=>A().isVisible()&&A().isOnline(),[d,O,$,Q]=ks(i,j),J=o.useRef({}).current,le=G(c)?a.fallback[j]:c,f=(L,T)=>{for(const Y in J){const W=Y;if(W==="data"){if(!n(L[W],T[W])&&(!G(L[W])||!n(he,T[W])))return!1}else if(T[W]!==L[W])return!1}return!0},M=o.useMemo(()=>{const L=(()=>!j||!s?!1:G(u)?A().isPaused()||l?!1:G(p)?!0:p:u)(),T=X=>{const h=tt(X);return delete h._k,L?{isValidating:!0,isLoading:!0,...h}:h},Y=d(),W=Q(),ue=T(Y),_e=Y===W?ue:T(W);let U=ue;return[()=>{const X=T(d());return f(X,U)?(U.data=X.data,U.isLoading=X.isLoading,U.isValidating=X.isValidating,U.error=X.error,U):(U=X,X)},()=>_e]},[i,j]),r=Cs.useSyncExternalStore(o.useCallback(L=>$(j,(T,Y)=>{f(Y,T)||L()}),[i,j]),M[0],M[1]),x=!H.current,y=k[j]&&k[j].length>0,C=r.data,F=G(C)?le:C,oe=r.error,ce=o.useRef(F),he=_?G(C)?ce.current:C:F,ie=(()=>y&&!G(oe)?!1:x&&!G(u)?u:A().isPaused()?!1:l?G(F)?!1:p:G(F)||p)(),de=!!(j&&s&&x&&ie),Te=G(r.isValidating)?de:r.isValidating,se=G(r.isLoading)?de:r.isLoading,pe=o.useCallback(async L=>{const T=R.current;if(!j||!T||g.current||A().isPaused())return!1;let Y,W,ue=!0;const _e=L||{},U=!E[j]||!_e.dedupe,X=()=>pt?!g.current&&j===I.current&&H.current:j===I.current,h={isValidating:!1,isLoading:!1},z=()=>{O(h)},xe=()=>{const ee=E[j];ee&&ee[1]===W&&delete E[j]},re={isValidating:!0};G(d().data)&&(re.isLoading=!0);try{if(U&&(O(re),a.loadingTimeout&&G(d().data)&&setTimeout(()=>{ue&&X()&&A().onLoadingSlow(j,a)},a.loadingTimeout),E[j]=[T(P),xt()]),[Y,W]=E[j],Y=await Y,U&&setTimeout(xe,a.dedupingInterval),!E[j]||E[j][1]!==W)return U&&X()&&A().onDiscarded(j),!1;h.error=Fe;const ee=N[j];if(!G(ee)&&(W<=ee[0]||W<=ee[1]||ee[1]===0))return z(),U&&X()&&A().onDiscarded(j),!1;const K=d().data;h.data=n(K,Y)?K:Y,U&&X()&&A().onSuccess(Y,j,a)}catch(ee){xe();const K=A(),{shouldRetryOnError:Ie}=K;K.isPaused()||(h.error=ee,U&&X()&&(K.onError(ee,j,K),(Ie===!0||It(Ie)&&Ie(ee))&&(!A().revalidateOnFocus||!A().revalidateOnReconnect||V())&&K.onErrorRetry(ee,j,K,Ke=>{const ut=k[j];ut&&ut[0]&&ut[0](Pe.ERROR_REVALIDATE_EVENT,Ke)},{retryCount:(_e.retryCount||0)+1,dedupe:!0})))}return ue=!1,z(),!0},[j,i]),Ne=o.useCallback((...L)=>Ss(i,I.current,...L),[]);if(ze(()=>{R.current=s,D.current=a,G(C)||(ce.current=C)}),ze(()=>{if(!j)return;const L=pe.bind(Fe,mt);let T=0;const W=Ns(j,k,(ue,_e={})=>{if(ue==Pe.FOCUS_EVENT){const U=Date.now();A().revalidateOnFocus&&U>T&&V()&&(T=U+A().focusThrottleInterval,L())}else if(ue==Pe.RECONNECT_EVENT)A().revalidateOnReconnect&&V()&&L();else{if(ue==Pe.MUTATE_EVENT)return pe();if(ue==Pe.ERROR_REVALIDATE_EVENT)return pe(_e)}});return g.current=!1,I.current=j,H.current=!0,O({_k:P}),ie&&(G(F)||At?L():Is(L)),()=>{g.current=!0,W()}},[j]),ze(()=>{let L;function T(){const W=It(v)?v(d().data):v;W&&L!==-1&&(L=setTimeout(Y,W))}function Y(){!d().error&&(b||A().isVisible())&&(m||A().isOnline())?pe(mt).then(T):T()}return T(),()=>{L&&(clearTimeout(L),L=-1)}},[v,b,m,j]),o.useDebugValue(he),l&&G(F)&&j){if(!pt&&At)throw new Error("Fallback data is required when using suspense in SSR.");R.current=s,D.current=a,g.current=!1;const L=S[j];if(!G(L)){const T=Ne(L);Ft(T)}if(G(oe)){const T=pe(mt);G(he)||(T.status="fulfilled",T.value=!0),Ft(T)}else throw oe}return{mutate:Ne,get data(){return J.data=!0,he},get error(){return J.error=!0,oe},get isValidating(){return J.isValidating=!0,Te},get isLoading(){return J.isLoading=!0,se}}},jn=js(_n),Ot=pt?t=>{t()}:We.startTransition,wn=t=>{const[,s]=o.useState({}),a=o.useRef(!1),i=o.useRef(t),n=o.useRef({data:!1,error:!1,isValidating:!1}),l=o.useCallback(c=>{let u=!1;const p=i.current;for(const v in c){const b=v;p[b]!==c[b]&&(p[b]=c[b],n.current[b]&&(u=!0))}u&&!a.current&&s({})},[]);return ze(()=>(a.current=!1,()=>{a.current=!0})),[i,n.current,l]},Mn=()=>(t,s,a={})=>{const{mutate:i}=ws(),n=o.useRef(t),l=o.useRef(s),c=o.useRef(a),u=o.useRef(0),[p,v,b]=wn({data:Fe,error:Fe,isMutating:!1}),m=p.current,_=o.useCallback(async(N,E)=>{const[S,j]=Vt(n.current);if(!l.current)throw new Error("Can’t trigger the mutation: missing fetcher.");if(!S)throw new Error("Can’t trigger the mutation: missing key.");const P=tt(tt({populateCache:!1,throwOnError:!0},c.current),E),H=xt();u.current=H,b({isMutating:!0});try{const g=await i(S,l.current(j,{arg:N}),tt(P,{throwOnError:!0}));return u.current<=H&&(Ot(()=>b({data:g,isMutating:!1,error:void 0})),P.onSuccess==null||P.onSuccess.call(P,g,S,P)),g}catch(g){if(u.current<=H&&(Ot(()=>b({error:g,isMutating:!1})),P.onError==null||P.onError.call(P,g,S,P),P.throwOnError))throw g}},[]),k=o.useCallback(()=>{u.current=xt(),b({data:Fe,error:Fe,isMutating:!1})},[]);return ze(()=>{n.current=t,l.current=s,c.current=a}),{trigger:_,reset:k,get data(){return v.data=!0,m.data},get error(){return v.error=!0,m.error},get isMutating(){return v.isMutating=!0,m.isMutating}}},kn=_s(jn,Mn),Cn=""+new URL("fire-9fc0c83e.svg",import.meta.url).href,Sn=""+new URL("logout-b2b05b85.svg",import.meta.url).href,Nn="_entry_1d5ta_1",In="_panel_1d5ta_14",An="_switchLine_1d5ta_33",En="_itemLine_1d5ta_39",Rn="_logoutLine_1d5ta_50",$n="_userInfo_1d5ta_59",Tn="_head_1d5ta_68",Fn="_fireBg_1d5ta_77",On="_content_1d5ta_84",je={entry:Nn,panel:In,switchLine:An,itemLine:En,logoutLine:Rn,userInfo:$n,head:Tn,fireBg:Fn,content:On};function Dn(){const t=be(),{globalSetting:s}=o.useContext(Wt),{logout:a}=o.useContext(Ue),{doTest:i}=Vs("#/workbench/rapi/loginBack",{closeWindow:!1}),{getConfigurationValue:n}=wt(),{data:l,trigger:c}=kn(`${n(s.nodeOptions.publicNodeUrl)}/auth/cookie/user`,_=>Ut.get(_,{withCredentials:!0}).then(k=>k.data)),{search:u}=Re();o.useEffect(()=>{c(),Kt()},[u,c]);const p=()=>{a(n(s.nodeOptions.publicNodeUrl)).then(async _=>{location.reload()})},v=async _=>{await i(_.name)},b=Gt()??[],m=b==null?void 0:b.filter(_=>_.name!==(l==null?void 0:l.providerId));return e.jsxs("div",{className:je.entry,children:[e.jsx("img",{src:"./assets/icon/oidc.svg",className:"h-3 mr-2 w-3",alt:""}),e.jsx("span",{children:l?l.providerId:t.formatMessage({id:"4WvYRq",defaultMessage:[{type:0,value:"未登录"}]})}),e.jsxs("div",{className:je.panel,children:[l?e.jsxs("div",{className:je.userInfo,children:[e.jsx("img",{src:Cn,alt:"",className:je.fireBg}),e.jsxs("div",{className:je.head,children:[e.jsx("img",{src:"./assets/icon/oidc.svg",className:"h-6 mr-2 w-6",alt:""}),l.providerId]}),e.jsx("div",{className:je.content,children:e.jsx(Hs,{data:l})})]}):null,m.length>0&&e.jsx("div",{className:je.switchLine,children:t.formatMessage({id:"pywg9X",defaultMessage:[{type:0,value:"切换项目"}]})}),m.map(_=>e.jsxs("div",{className:je.itemLine,onClick:()=>v(_),children:[e.jsx("img",{src:"./assets/icon/oidc.svg",className:"h-4 mr-2.5 w-4",alt:""}),_.name]},_.name)),l!=null&&l.userId?e.jsxs("div",{className:je.logoutLine,onClick:p,children:[e.jsx("img",{src:Sn,className:"h-4 mr-2.5 w-4",alt:""}),t.formatMessage({id:"9Qz9G/",defaultMessage:[{type:0,value:"退出项目"}]})]}):null]})]})}const Pn=""+new URL("github-7bfaf42c.svg",import.meta.url).href,Bn=""+new URL("keyboard-ba711ae3.svg",import.meta.url).href,Ln=""+new URL("preview-2d4783d5.svg",import.meta.url).href,zn=""+new URL("question-82f091a9.svg",import.meta.url).href,qn=""+new URL("refresh-1c66fe10.svg",import.meta.url).href,Hn=""+new URL("setting-12dcc5b5.svg",import.meta.url).href,Vn="_header_gzxoc_1",Wn="_dashboardIcon_gzxoc_9",Un="_dashboardIcon2_gzxoc_15",Kn="_logo_gzxoc_23",Gn="_splitLine_gzxoc_31",Yn="_title_gzxoc_36",Qn="_titleIcon_gzxoc_40",Zn="_headBtn_gzxoc_46",Jn="_compiling_gzxoc_55",Xn="_breath_gzxoc_1",ei="_helpIcon_gzxoc_70",ti="_configIcon_gzxoc_78",si="_avatar_gzxoc_88",fe={header:Vn,dashboardIcon:Wn,dashboardIcon2:Un,logo:Kn,splitLine:Gn,title:Yn,titleIcon:Qn,headBtn:Zn,compiling:Jn,breath:Xn,helpIcon:ei,configIcon:ti,avatar:si};function ai(t){const s=be(),{appRuntime:a}=_t(),i=o.useMemo(()=>[{keys:["alt/^","h"],desc:s.formatMessage({id:"ATIkHk",defaultMessage:[{type:0,value:"打开快捷键提示"}]})},{keys:["alt/^","n"],desc:s.formatMessage({id:"qMKYtF",defaultMessage:[{type:0,value:"新建APi/新建模型"}]})},{keys:["alt/^","b"],desc:s.formatMessage({id:"U1eYS0",defaultMessage:[{type:0,value:"批量新建API"}]})},{keys:["alt/^","c"],desc:s.formatMessage({id:"0uAOrg",defaultMessage:[{type:0,value:"编译"}]})},{keys:["alt/^","m"],desc:s.formatMessage({id:"RuZ3Ak",defaultMessage:[{type:0,value:"切换API设计和模型设计"}]})},{keys:["alt/^","r"],desc:s.formatMessage({id:"7cCd7/",defaultMessage:[{type:0,value:"运行当前Operation"}]})},{keys:["alt/^","t"],desc:s.formatMessage({id:"+MrBgm",defaultMessage:[{type:0,value:"模型设计页切换设计/数据视图"}]})},{keys:["alt/^","shift","d"],desc:s.formatMessage({id:"nwr0JF",defaultMessage:[{type:0,value:"创建当前API的拷贝"}]})},{keys:["alt/^","shift","c"],desc:s.formatMessage({id:"EpuhM8",defaultMessage:[{type:0,value:"复制当前API请求链接"}]})},{keys:["alt/^","shift","t"],desc:s.formatMessage({id:"+jyuQU",defaultMessage:[{type:0,value:"API编辑页切换Json/表单模式，模型设计页切换设计/代码模式"}]})}],[s]),{clear:n}=ct(),l=$e(),{pathname:c}=Re(),{isHideSide:u}=o.useContext(Ue),p=()=>{if(!a.dev){ne.error("生产环境禁止重新编译");return}t.isCompiling||(n(),B.get("/engine/restart").then(()=>void ne.success(s.formatMessage({id:"HalctF",defaultMessage:[{type:0,value:"开始编译"}]}))))},{modal:v}=Yt.useApp(),b=o.useCallback(()=>{ss.destroyAll(),v.info({width:"800px",icon:null,title:s.formatMessage({id:"VLmNWR",defaultMessage:[{type:0,value:"页面快捷键"}]}),content:e.jsx("div",{className:"flex flex-wrap",children:i.map(m=>e.jsxs("div",{className:"flex pt-1 pr-4 pb-3 pl-1 w-1/2 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-40",children:m.keys.map(_=>e.jsx("kbd",{className:"rounded bg-true-gray-200 text-sm mr-1.5 py-1 px-1.5",children:_},_))}),e.jsx("span",{children:m.desc})]},m.desc))}),okText:s.formatMessage({id:"r1IImU",defaultMessage:[{type:0,value:"知道了"}]})})},[i,s,v]);return o.useEffect(()=>{const m=Ve("alt+c,^+c",()=>{p()}),_=Ve("alt+h,^+h",()=>{b()});return()=>{m(),_()}},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:fe.header,children:[e.jsx("div",{className:u?fe.dashboardIcon2:fe.dashboardIcon,onClick:()=>t.onToggleSider()}),e.jsx("div",{className:fe.logo,onClick:()=>l("/workbench")}),e.jsx("div",{className:fe.splitLine}),e.jsx("div",{className:fe.title,children:e.jsx(w,{id:"xKCJNb",defaultMessage:[{type:0,value:"飞布控制台"}]})}),e.jsx("div",{className:"flex-1"}),c==="/workbench/rapi"?e.jsxs(e.Fragment,{children:[e.jsx(Dn,{}),e.jsx("div",{className:fe.splitLine,style:{margin:"0 26px"}}),e.jsx("div",{className:"cursor-pointer h-5 text-0px",onClick:()=>{window.open(`/api/engine/swagger?auth-key=${vt()}`,"_blank")},children:e.jsx("img",{src:"./assets/download.svg",alt:""})})]}):e.jsxs(e.Fragment,{children:[a.dev?e.jsx("div",{className:fe.headBtn,onClick:p,children:e.jsx(te,{title:e.jsx(w,{id:"0uAOrg",defaultMessage:[{type:0,value:"编译"}]}),children:e.jsx("span",{className:"flex items-center",children:t.isCompiling?e.jsx("img",{src:"./assets/compile.gif",className:fe.compiling,alt:"编译"}):e.jsx("img",{src:qn,className:"h-5 w-5.25",alt:"编译"})})})}):null,e.jsx("div",{className:fe.headBtn,onClick:()=>window.open("./#/workbench/rapi?t="+Date.now(),"fb_rapi"),children:e.jsx(te,{title:e.jsx(w,{id:"HtIFFg",defaultMessage:[{type:0,value:"Swagger文档"}]}),children:e.jsx("img",{src:Ln,className:"h-5 w-5",alt:"预览"})})})]}),e.jsx("div",{className:fe.splitLine,style:{margin:"0 26px"}}),e.jsx("div",{className:"cursor-pointer flex-0 h-5 mb-1px text-0px w-4",onClick:()=>window.open("https://github.com/fireboomio","_blank"),children:e.jsx("img",{src:Pn,alt:""})}),e.jsx("div",{className:fe.helpIcon,onClick:()=>window.open("https://www.fireboom.io/","_blank"),children:e.jsx("img",{src:zn,alt:""})}),e.jsx(as,{placement:"bottomRight",content:e.jsxs("div",{className:"p-2 bg-white rounded-lg flex flex-col items-center shadow-xl",children:[e.jsx("img",{src:"https://fireboom.oss-cn-hangzhou.aliyuncs.com/img/qun_qr.png",className:"w-45",alt:"qun_qrcode"}),e.jsx("p",{children:"扫码加入开发者交流群"})]}),children:e.jsx("div",{className:"cursor-pointer flex h-5 ml-4 items-center",children:e.jsx(za,{className:"text-[#787D8B] text-base"})})}),e.jsx(te,{title:s.formatMessage({id:"sRkj0b",defaultMessage:[{type:0,value:"快捷键"}]}),children:e.jsx("div",{className:"cursor-pointer flex h-5 ml-4 items-center",onClick:b,children:e.jsx("img",{src:Bn,alt:""})})}),e.jsx("div",{className:fe.configIcon,onClick:()=>l("/workbench/setting"),children:e.jsx("img",{src:Hn,alt:""})})]})})}function fs(t,s){var i;const a=[];for(const[n,l]of t.entries())(i=l.children)!=null&&i.length?a.push(...fs(l.children,`${s}-${n}`)):a.push({...l,pos:`${s}-${n}`});return a}function ni(t,s,a){if(t&&s&&a.length){const i=fs(a,"0"),n=i.findIndex(c=>c.pos===t),l=i.findIndex(c=>c.pos===s);if(n>-1&&l>-1)return n>l?i.slice(l,n+1).map(c=>c.key):i.slice(n,l+1).map(c=>c.key)}return[]}const ms=o.forwardRef((t,s)=>{const a=o.useRef({});o.useImperativeHandle(s,()=>({addItem:O,editItem:$}));const i=o.useRef(null),[n,l]=o.useState(500),[c,u]=o.useState([]),p=be(),[v,b]=o.useState([]),[m,_]=o.useState(null),[k,N]=o.useState([]),[E,S]=o.useState([]),[j,P]=o.useState(""),H=o.useRef(),[g,I]=o.useState(""),R=o.useRef(!1),D=o.useMemo(()=>{function f(r){var x;M[r.key]=r,(x=r.children)==null||x.forEach(f)}const M={};return v==null||v.forEach(f),M},[v]),A=o.useMemo(()=>{if(!v||!m&&!g)return v;const f=Se.cloneDeep(v),M=ht(f,g);if(M&&(M.isInput=!0),m){const r=ht(f,m==null?void 0:m.parentKey),x={name:"",path:"",key:"temp"+Date.now(),isDir:m.isDir,isInput:!0,isNew:!0,parent:r,pos:""};r?(r.children=r.children??[],r.children.unshift(x)):f.unshift(x)}return f},[v,m,g]);o.useEffect(()=>{const f=Se.cloneDeep(t.treeData);function M(r){var x;(x=r.children)==null||x.forEach(y=>{y.parent=r,M(y)})}f==null||f.map(M),b(f)},[t.treeData]);const V=o.useRef(),d=o.useRef();o.useEffect(()=>{if(!(V.current===t.selectedKey&&d.current===D&&t.selectedKey)&&(V.current=t.selectedKey,S(t.selectedKey?[t.selectedKey]:[]),t.selectedKey)){console.log(D);const f=D[t.selectedKey];if(f){const M=[];let r=f.parent;for(;r;)M.push(r.key),r=r.parent;N(x=>[...x,...M])}}},[t.selectedKey,D]);const O=o.useCallback((f,M=!1,r)=>{const x=M?null:D[r??j],y=x!=null&&x.isDir?x:x==null?void 0:x.parent;_({isDir:f,parentKey:(y==null?void 0:y.key)??""}),N([...k,r??j])},[k,D,j]),$=o.useCallback(f=>{I(f)},[I]),Q=o.useCallback((f,M)=>{var x;if(M.node.isInput)return;P(M.node.key);const r=H.current;if(H.current=M.node.pos,M.nativeEvent.shiftKey){if(r){const y=ni(H.current,r,v);S(y)}}else M.nativeEvent.ctrlKey||M.nativeEvent.metaKey?E.includes(M.node.key)?S(E.filter(y=>y!==M.node.key)):S([...E,M.node.key]):(S([M.node.key]),(x=t.onSelectFile)==null||x.call(t,M.node));M.node.isDir&&(k.includes(M.node.key)?N(k.filter(y=>y!==M.node.key)):N([...k,M.node.key]))},[E,t,k]),J=Se.debounce(async(f,M,r)=>{var x,y,C;if(!R.current){if(R.current=!0,f.isNew)(await((y=t.onCreateItem)==null?void 0:y.call(t,ht(v,((x=f.parent)==null?void 0:x.key)??"")??null,f.isDir,M))||r)&&_(null);else{if(f.name===M){I(""),R.current=!1;return}(await((C=t.onRename)==null?void 0:C.call(t,f,M))||r)&&I("")}R.current=!1}},100),le=f=>{var r,x;E.includes(f.key)||(S([f.key]),(r=t.onSelectFile)==null||r.call(t,f));const M=E.includes(f.key)?E.map(y=>D[y]):[f];u(((x=t.onContextMenu)==null?void 0:x.call(t,M,ii(M)))??[])};return o.useEffect(()=>{function f(){var r;l(((r=i.current)==null?void 0:r.clientHeight)??0)}f();const M=new ResizeObserver(f);return M.observe(i.current),()=>{M.disconnect()}},[]),e.jsx(ot,{className:t.rootClassName,open:c.length>0,onOpenChange:f=>!f&&u([]),menu:{items:c,onClick:()=>u([])},trigger:["contextMenu"],children:e.jsxs("div",{onClick:()=>{S([]),P(""),H.current=""},ref:i,onContextMenu:f=>{Se.get(f,"isFromChild")||u([{key:"1",label:p.formatMessage({id:"tVoPUq",defaultMessage:[{type:0,value:"新建"}]})+(t.fileText||p.formatMessage({id:"saeFbf",defaultMessage:[{type:0,value:"文件"}]})),onClick:()=>O(!1,!0)},{key:"2",label:p.formatMessage({id:"iveGBB",defaultMessage:[{type:0,value:"新建文件夹"}]}),onClick:()=>O(!0,!0)}])},children:[e.jsx(Ys,{onClick:f=>f.stopPropagation(),height:n,rootClassName:t.treeClassName,draggable:t.draggable?{icon:!1}:!1,onDrop:({node:f,dragNode:M,dropToGap:r})=>{var y,C;const x=r?f.parent??null:f;((y=M.parent)==null?void 0:y.key)!==(x==null?void 0:x.key)&&((C=t.onMove)==null||C.call(t,M,r?f.parent??null:f))},allowDrop:({dropNode:f,dropPosition:M})=>!(!f.isDir&&M===0),onDragEnter:f=>{for(const M of Object.keys(a.current))clearTimeout(a.current[M]);a.current[f.node.key]=window.setTimeout(()=>{k.includes(f.node.key)||(console.log("expand",f.node.key),N([...k,f.node.key])),delete a.current[f.node.key]},800)},titleRender:f=>{var M;return f.isInput?e.jsx(Qt,{size:"small",autoFocus:!0,defaultValue:f.name,onPressEnter:r=>{J(f,Se.get(r,"target.value"),!1)},onBlur:r=>{J(f,r.target.value,!0)}}):e.jsx("div",{onContextMenu:r=>{Se.set(r,"isFromChild",!0),le(f)},children:(M=t.titleRender)==null?void 0:M.call(t,f)})},defaultExpandParent:!0,treeData:A,multiple:!0,expandedKeys:k,selectedKeys:E,onSelect:Q}),t.footer]})})});ms.displayName="FileTree";const hs=ms;function ht(t,s){const a=[...t];for(;a.length;){const i=a.pop();if(i.key===s)return i;i.children&&a.push(...i.children)}}function ii(t){const s=[...t],a=[];for(;s.length;){const i=s.pop();a.push(i),i.children&&s.push(...i.children)}return a.reverse(),a}const ri="_headerFilter_1a7eo_1",oi="_headerConfig_1a7eo_2",li="_headerRefresh_1a7eo_3",ci="_headerNewFold_1a7eo_4",di="_headerNewFile_1a7eo_5",ui="_createRowWrapper_1a7eo_25",fi="_createRow_1a7eo_25",mi="_btn_1a7eo_44",hi="_graphqlEntry_1a7eo_48",gi="_treeContainer_1a7eo_59",pi="_treeItem_1a7eo_117",xi="_title_1a7eo_117",vi="_treeItemDir_1a7eo_126",yi="_icon_1a7eo_126",bi="_proxyIcon_1a7eo_130",_i="_functionIcon_1a7eo_133",ji="_treeItemFile_1a7eo_136",wi="_treeItemErr_1a7eo_140",Mi="_lighting_1a7eo_144",ki="_treeItemDisable_1a7eo_147",Ci="_suffix_1a7eo_180",Si="_errLabel_1a7eo_185",Ni="_more_1a7eo_198",Ii="_method_1a7eo_208",Ai="_method_get_1a7eo_214",Ei="_method_post_1a7eo_217",Ri="_menuItem_1a7eo_220",q={headerFilter:ri,headerConfig:oi,headerRefresh:li,headerNewFold:ci,headerNewFile:di,createRowWrapper:ui,createRow:fi,btn:mi,graphqlEntry:hi,treeContainer:gi,treeItem:pi,title:xi,treeItemDir:vi,icon:yi,proxyIcon:bi,functionIcon:_i,treeItemFile:ji,treeItemErr:wi,lighting:Mi,treeItemDisable:ki,suffix:Ci,errLabel:Si,more:Ni,method:Ii,method_get:Ai,method_post:Ei,menuItem:Ri},$i="_container_ks0ti_1",Ti="_active_ks0ti_9",Fi="_header_ks0ti_16",Oi="_arrow_ks0ti_26",Di="_headerOpen_ks0ti_33",Pi="_title_ks0ti_36",Bi="_add_ks0ti_47",Li="_action_ks0ti_53",zi="_content_ks0ti_60",we={container:$i,active:Ti,header:Fi,arrow:Oi,headerOpen:Di,title:Pi,add:Bi,action:Li,content:zi};function St(t){const s=be(),[a,i]=o.useState(!1),n=o.useRef(null);o.useEffect(()=>{t.open!==void 0?l(t.open):t.defaultOpen&&l(!0)},[t.defaultOpen,t.open]),o.useEffect(()=>{var c;t.scrollBottom!==void 0&&(c=n==null?void 0:n.current)!=null&&c.scrollTop&&(n.current.scrollTop=1e6)},[t.scrollBottom]);const l=c=>{i(c),t.onOpen&&t.onOpen(c)};return e.jsxs("div",{className:`${we.container} ${a?we.active:""}`,children:[e.jsxs("div",{className:`${we.header} ${a?we.headerOpen:""}`,onClick:c=>l(!a),children:[e.jsx("div",{className:we.arrow}),e.jsx("div",{className:we.title,children:t.title}),e.jsxs("div",{className:we.action,onClick:c=>c.stopPropagation(),children:[t.action?t.action:null,t.hideAdd?null:e.jsx(te,{title:s.formatMessage({id:"tVoPUq",defaultMessage:[{type:0,value:"新建"}]}),children:e.jsx("div",{className:we.add,onClick:t.onAdd})})]})]}),e.jsx("div",{ref:n,className:`${a?"":"hidden"} ${we.content}`,children:t.children})]})}function qi(t){const s=be(),a=$e(),i=Re(),n=Zt(),{checkSupport:l}=Zs(),c=n["*"],[u,p]=o.useState(),[v,b]=o.useState(!1),[m,_]=o.useState(""),{vscode:k}=o.useContext(He),[N,E]=ss.useModal(),S=o.useRef({addItem:()=>{},editItem:()=>{}}),{computed:{saved:j},autoSave:P}=Qs(),{operation:H}=As();o.useEffect(()=>{const r=Ve("alt+n,^+n",()=>{}),x=Ve("alt+b,^+b",()=>{a("/workbench/apimanage/crud")});return()=>{r(),x()}},[a]),o.useEffect(()=>{if(u&&c){const r=Dt(c,u);r?_(r.key):a("/workbench/apimanage")}},[c,i,a,n,u]),o.useEffect(()=>{t.defaultOpen&&b(!0)},[t.defaultOpen]);const g=Es();o.useEffect(()=>{const r=gs(g??[],"0");p(r)},[g]);function I(r){if(r.isDir)return"";if(r.extra.invalid)return e.jsx("div",{className:q.errLabel,children:e.jsx(w,{id:"n6o1H/",defaultMessage:[{type:0,value:"非法"}]})});if(r.extra.internal)return e.jsx(w,{id:"ptadMC",defaultMessage:[{type:0,value:"内部"}]})}const R=o.useCallback((r,x=!1)=>async(...y)=>{const C=ne.loading(s.formatMessage({id:"QpRtOT",defaultMessage:[{type:0,value:"执行中"}]}));try{await r(...y),!x&&await Ee()}catch{}C()},[s]),D=R(async(r,x)=>{const y=r.filter(C=>!C.isDir).map(C=>C.path);await B.put("operation/batch",y.map(C=>({path:C,enabled:x}))),Oe.emit({event:"apiEnableChange",data:{pathList:y,enabled:x}})}),A=R(async r=>{N.confirm({title:s.formatMessage({id:"JJvpR5",defaultMessage:[{type:0,value:"是否确认删除选中的API？"}]}),onOk:R(async()=>{const x=r.filter(y=>!y.isDir).map(y=>y.path);await B.delete("operation/batch",{params:{dataNames:x.join(",")}}),x.forEach(y=>localStorage.removeItem(`_api_args_${y}`)),ne.success(s.formatMessage({id:"aiBGBs",defaultMessage:[{type:0,value:"删除成功"}]}))}),okText:s.formatMessage({id:"FEb7U2",defaultMessage:[{type:0,value:"确认"}]}),cancelText:s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]})})}),V=R(async r=>{r.isDir?await B.delete(`/operation/deleteParent/${r.path}`):await B.delete(`/operation/${r.path}`),localStorage.removeItem(`_api_args_${r.path}`)}),d=R(async(r,x)=>{x?(await B.post("/vscode/createDirectory",{uri:`${H}/${r}`}),await Ee()):(await B.post("/operation",{path:r}),await Ee(),a(`/workbench/apimanage/${r}`))},!0),O=R(async(r,x)=>{const y=r.path,C=y.replace(/[^/]+$/,x);r.isDir?await B.post("/operation/renameParent",{src:y,dst:C,overload:!1}):(await B.post("/operation/rename",{src:y,dst:C,overload:!1}),r.path===c&&Oe.emit({event:"titleChange",data:{title:x,path:C}}))}),$=R(async(r,x,y=!1)=>{var he;const C=r.path,F=`${x!=null&&x.path?`${x.path}/`:""}${(he=r.path)==null?void 0:he.split("/").pop()}`,oe=!!Dt(c,[r]);r.isDir?await B.post("/operation/renameParent",{src:C,dst:F,overload:y},{onError:async({code:ie,result:de})=>{ie==="20000000"&&await Q(de,()=>$(r,x,!0))}}):await B.post("/operation/rename",{src:C,dst:F,overload:y},{onError:async({code:ie,result:de})=>{ie==="20000000"&&await Q([de],()=>$(r,x,!0))}});const ce=await Ee();if(oe){const ie=Hi(c,ce);ie&&Oe.emit({event:"titleChange",data:{title:ie.path.split("/").pop()??"",path:ie.path}})}},!0),Q=o.useCallback((r,x)=>{N.confirm({title:s.formatMessage({id:"4godzk",defaultMessage:[{type:0,value:"以下API已存在，是否覆盖？"}]}),content:r.map(y=>e.jsx("div",{children:y.path},y.path)),onOk:x,okText:s.formatMessage({id:"TEs+AV",defaultMessage:[{type:0,value:"覆盖"}]}),cancelText:s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]})})},[s,N]),J=r=>{var ce,he,ie,de,Te;const x=I(r);let y;r.isDir?y=q.treeItemDir:r.extra.invalid?y=q.treeItemErr:r.extra.enabled?y=q.treeItemFile:y=q.treeItemDisable;let C=r.parent;for(;C&&C.parent;)C=C.parent;const F=!r.isDir&&((ce=r.extra)==null?void 0:ce.engine)!==ft.GraphQL,oe=r.isDir&&["function","proxy"].includes((C==null?void 0:C.name)??r.name);return e.jsxs("div",{className:`${q.treeItem} ${y}`,children:[e.jsx("div",{className:nt(q.icon,[r.name==="proxy"?q.proxyIcon:r.name==="function"?q.functionIcon:""]),children:(he=r.extra)!=null&&he.liveQueryEnabled?e.jsx("div",{className:q.lighting}):null}),e.jsxs(e.Fragment,{children:[((ie=r.extra)==null?void 0:ie.method)&&e.jsx("div",{className:`${q.method} ${q[`method_${(de=r.extra.method)==null?void 0:de.toLowerCase()}`]}`,children:(Te=r.extra.method)==null?void 0:Te.toUpperCase()}),e.jsx("div",{className:q.title,children:r.name}),e.jsx("div",{className:q.suffix,children:x}),!oe&&e.jsx("div",{onClick:se=>se.stopPropagation(),children:e.jsx(ot,{destroyPopupOnHide:!0,menu:{items:[{key:"copy",onClick:async()=>{const se=`${r.path}Copy${Math.random().toString(36).substring(2,5)}`;await B.post("/operation/copy",{dst:se,src:r.path,overload:!1}),ne.success(s.formatMessage({id:"PvMD53",defaultMessage:[{type:0,value:"已复制接口 "},{type:1,value:"path"}]},{path:se})),Ee()},label:e.jsx("div",{children:e.jsxs("span",{className:"ml-1.5",children:[e.jsx(w,{id:"qUKj7E",defaultMessage:[{type:0,value:"复制"}]})," "]})})},{key:"rename",onClick:()=>{S.current.editItem(r.key)},label:e.jsx("div",{children:e.jsxs("span",{className:"ml-1.5",children:[e.jsx(w,{id:"JeJAmT",defaultMessage:[{type:0,value:"重命名"}]})," "]})})},{key:"delete",label:e.jsx("div",{onClick:se=>{var pe,Ne;console.log(se),(Ne=(pe=se.target)==null?void 0:pe.dataset)!=null&&Ne.stoppropagation&&se.stopPropagation()},children:e.jsx(kt,{zIndex:9999,title:s.formatMessage({id:"9Fxs0Y",defaultMessage:[{type:0,value:"确定删除吗?"}]}),onConfirm:()=>{V(r)},okText:s.formatMessage({id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]}),cancelText:s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]}),placement:"right",children:e.jsx("div",{className:q.menuItem,"data-stoppropagation":"1",children:e.jsx("span",{className:"ml-1.5",children:e.jsx(w,{id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]})})})})})}].filter(se=>F?se.key==="delete":se.key!=="copy"||!r.isDir)},trigger:["click"],placement:"bottomRight",children:e.jsx("div",{className:q.more,onClick:se=>se.preventDefault()})})})]})]})},{validateAPI:le}=Mt(),f=(r,x=!1)=>{const y=le(r);return y?(ne.error(y),!1):!0},M=o.useCallback((r,x)=>{if(r.some(F=>{var oe,ce;return F.isDir&&((oe=F.path)==null?void 0:oe.match(/^(proxy|function)/))||((ce=F.extra)==null?void 0:ce.engine)!==ft.GraphQL}))return[];const y=[{key:"on",onClick:()=>void D(x,!0),disabled:!x.some(F=>!F.isDir&&!F.extra.enabled&&!F.extra.invalid),label:e.jsx(w,{id:"WiL7+z",defaultMessage:[{type:0,value:"上线"}]})},{key:"off",onClick:()=>void D(x,!1),disabled:!x.some(F=>!F.isDir&&F.extra.enabled),label:e.jsx(w,{id:"MFe3Kw",defaultMessage:[{type:0,value:"下线"}]})}];return r.some(F=>!F.isDir)&&y.push({key:"delete",onClick:()=>void A(r),label:e.jsx(w,{id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]})}),y},[A,D]);return e.jsxs(St,{...t,title:s.formatMessage({id:"zQEdCX",defaultMessage:[{type:0,value:"API管理"}]}),hideAdd:!0,open:v,onOpen:r=>{b(r),t.onOpen&&t.onOpen(r)},action:e.jsxs(e.Fragment,{children:[e.jsx(te,{title:"筛选",children:e.jsx("div",{className:q.headerFilter,onClick:()=>{Oe.emit({event:"openApiSearch"})}})}),e.jsx(te,{title:s.formatMessage({id:"IQIvYd",defaultMessage:[{type:0,value:"刷新列表"}]}),children:e.jsx("div",{className:q.headerRefresh,onClick:()=>{Ee()}})}),e.jsx(te,{title:s.formatMessage({id:"aI3L5g",defaultMessage:[{type:0,value:"全局设置"}]}),children:e.jsx("div",{className:q.headerConfig,onClick:()=>{a("/workbench/setting/global-api-setting")}})}),e.jsx(te,{title:s.formatMessage({id:"AatDue",defaultMessage:[{type:0,value:"新建目录"}]}),children:e.jsx("div",{className:q.headerNewFold,onClick:()=>{b(!0),S.current.addItem(!0)}})}),e.jsx(te,{title:s.formatMessage({id:"QarRBC",defaultMessage:[{type:0,value:"新建API"}]}),children:e.jsx("div",{className:q.headerNewFile,onClick:()=>{b(!0),S.current.addItem(!1)}})})]}),children:[e.jsx(hs,{draggable:!0,fileText:"API",ref:S,onSelectFile:async r=>{var x;r.isDir||(j||await N.confirm({content:s.formatMessage({id:"A+dL0F",defaultMessage:[{type:0,value:"当前 API 未保存，是否保存"}]}),okText:s.formatMessage({id:"b5l2vN",defaultMessage:[{type:0,value:"保存"}]}),cancelText:s.formatMessage({id:"YG2xru",defaultMessage:[{type:0,value:"不保存"}]}),cancelButtonProps:{danger:!0}})&&(ne.open({type:"loading",content:s.formatMessage({id:"lUmMMK",defaultMessage:[{type:0,value:"自动保存中"}]})}),await P(),ne.destroy()),((x=r.extra)==null?void 0:x.engine)===ft.GraphQL?a(`/workbench/apimanage/${r.path}`):a(`/workbench/apimanage/custom/${r.path}`))},onCreateItem:async(r,x,y)=>{if(y&&f(y,x)){let C=r;for(;C!=null&&C.parent;)C=C==null?void 0:C.parent;if((C==null?void 0:C.name)==="function"||(C==null?void 0:C.name)==="proxy"){if(await l(C.name)){const F=await B.get("/sdk/enabledServer");F!=null&&F.extension&&await k.show(`${F.outputPath}/${r==null?void 0:r.path}/${y}${F.extension}`)&&ne.info(s.formatMessage({id:"qd+Bp3",defaultMessage:[{type:0,value:"数据源创建成功，请在编辑完成后重启钩子服务"}]}))}return!0}else try{return await d(r!=null&&r.path?`${r==null?void 0:r.path}/${y}`:y,x),!0}catch(F){return console.error(F),!1}}return!1},onRename:async(r,x)=>{if(x&&f(x,r.isDir))try{return await O(r,x),!0}catch(y){return console.error(y),!1}return!1},onMove:$,onContextMenu:M,selectedKey:m,rootClassName:"h-full",treeClassName:q.treeContainer,treeData:u??[],titleRender:J,footer:e.jsxs("div",{className:q.createRowWrapper,children:[e.jsxs("div",{className:q.createRow,onContextMenu:r=>r.stopPropagation(),children:[e.jsx("span",{className:q.btn,onClick:()=>S.current.addItem(!1),children:e.jsx(w,{id:"tVoPUq",defaultMessage:[{type:0,value:"新建"}]})}),e.jsxs("span",{children:[" ",e.jsx(w,{id:"/g7pR0",defaultMessage:[{type:0,value:"或者"}]})," "]}),e.jsx("span",{className:q.btn,onClick:()=>a("/workbench/apimanage/crud"),children:e.jsx(w,{id:"SJbKgr",defaultMessage:[{type:0,value:"批量新建"}]})})]}),e.jsx(te,{title:s.formatMessage({id:"mPsm6o",defaultMessage:[{type:0,value:"测试"}]}),children:e.jsx("div",{onContextMenu:r=>r.stopPropagation(),className:q.graphqlEntry,onClick:()=>{window.open(`${window.location.origin}/app/main/graphql`,"_blank")},children:e.jsx("img",{alt:"",src:"./assets/icon/graphql2.svg"})})})]})}),E]})}function gs(t,s="0"){return t?t.map((a,i)=>({...a,key:`${a.isDir?0:1}-${a.path}`,children:gs(a.items??[],`${s}-${i}`)})):[]}function Dt(t,s=[]){const a=[...s];for(;a.length;){const i=a.pop();if(i.path===t)return i;i.children&&a.push(...i.children)}}function Hi(t,s=[]){const a=[...s];for(;a.length;){const i=a.pop();if(i.path===t)return i;i.children&&a.push(...i.children)}}function Vi(){return Rs("/hook/model")}const Wi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAMAAACf4xmcAAAAyVBMVEX///8AAADk5u7r6+vl5fDh5ezh4+zo6P/i5u7p6fTn5+/k5PLh4uzh4+zj4+7l5e/h5e7////////i5O3t7e3h4+zh4+vh5O3g5Ozg4+y5u8Osr7i3ucGprbbg4+zg4+vi4+u0ucHh4+zh4+3h4+ydoqz////KzNL7+/tvb2/a2tp4eHjn5+fz8/P4+PiIiIi9vb2dnZ2WlpaQkJCMjIx1dXXs7Oze3t7V1dXNzc3Kysq6urqkpKSFhYWAgIDBwcG2tra0tLSvr6+PjHOpAAAAJnRSTlMFABsNMU1uCisWHxKykUgmOggHYA5sZlVCjfHx6emtppyZh354ZROrV6sAAAGMSURBVDjLjdTHloIwFIDhSEsCMwFE7L0gKIi965T3f6jRSJGBiP/Cjd+CnHPvBYUwkFH85+O3qEPIp4JQLwaAIlhSMOZSYayU4A1SBnRe4WQVIeFfCKkyp/A6oKzIY3nUHGfWGsmYL94ZgIqMWhajJpIVCO6sxKnamMXGmsqV7kxXZIGwGRFkRb8xiFWtwmYVTcWwAADEqGqwmVFFGAIAeA6RcszsH391eGJlgjieMkE0Y3a+HOebY8xMUYiYFDHPcS1rvo6ZlMm2jmdZh0ses/zzbOv/5jLXd5zFLI/ZrrufuK79knkLJ2jhvWDrpWvT3NWKzfbT6KNm0wmTnZZW1HLOZN+LJ3Zisvnajl7sfzGZd91MgzZXj/3S2W4StLMZL02VZiabmZRFY8koGks65HUWazyGPFiZXmOcWb1HVyZcQGNY63baH4nanW5taNAFDNdZNKRBv/aZqNYfSIZI1zk8DhqpGGVTSmSWjQrR6HEIT40qaFVCxESEVDVBpafm/cOVfwbfP6pvnug/q0l7fEavwhQAAAAASUVORK5CYII=",Ui="_container_13jx4_1",Ki="_row_13jx4_4",Gi="_active_13jx4_16",Yi="_rowDisable_13jx4_30",Qi="_icon_13jx4_30",Zi="_title_13jx4_33",Ji="_tip_13jx4_54",Xi="_more_13jx4_65",er="_bottomRowWrapper_13jx4_75",tr="_bottomRow_13jx4_75",sr="_btn_13jx4_94",ge={container:Ui,row:Ki,active:Gi,rowDisable:Yi,icon:Qi,title:Zi,tip:Ji,more:Xi,bottomRowWrapper:er,bottomRow:tr,btn:sr};function Pt(t){var V;const s=be(),{validateName:a}=Mt(),{vscode:i}=o.useContext(He),n=$e(),l=Jt(),c=$s(),u=Gt(),{getConfigurationValue:p}=wt(),v=o.useMemo(()=>{if(t.type==="dataSource")return c?c.map(d=>{var le,f;let O="other",$=Js(d),Q="",J=d.kind===Xs.Graphql&&d.customGraphql.customized;if(ea(d))if(((le=d.customDatabase)==null?void 0:le.kind)===1)Q=d.customDatabase.databaseAlone.database;else{const M=p(d.customDatabase.databaseUrl);M&&(Q=((f=zs(M))==null?void 0:f.dbName)??"")}return{readonly:J||d.readonly,name:d.name,icon:O,sourceType:d.sourceType,tip:Q,enabled:d.enabled,_row:d,svg:$}}):[];if(t.type==="auth")return u?u.map(d=>{const O="other",$="OIDC";return{name:d.name,icon:O,tip:$,enabled:d.oidcConfigEnabled||d.jwksProviderEnabled,_row:d,svg:"./assets/icon/oidc.svg"}}):[];if(t.type==="storage")return l?l.map(d=>{const O="other",$="";return{name:d.name,icon:O,tip:$,enabled:d.enabled,_row:d,svg:"./assets/icon/file.svg"}}):[]},[c,u,l,t.type]),b=o.useMemo(()=>({dataSource:{title:s.formatMessage({id:"C5D7TM",defaultMessage:[{type:0,value:"数据源"}]}),openItem:d=>`/workbench/data-source/${d}`,newItem:"/workbench/data-source/new",request:{getList:()=>{st()},editItem:async d=>await B.post("/datasource/rename",d),delItem:async d=>await B.delete(`/datasource/${d}`)},navMenu:d=>d.sourceType===4?d.enabled?[{key:"disable",label:e.jsx("div",{onClick:async()=>{await B.put("/datasource",{name:d.name,enabled:!1}),st()},children:e.jsx("span",{className:"ml-1.5",children:e.jsx(w,{id:"jryv+i",defaultMessage:[{type:0,value:"停用"}]})})})}]:[{key:"enable",label:e.jsx("div",{onClick:async()=>{await B.put("/datasource",{name:d.name,enabled:!0}),st()},children:e.jsx("span",{className:"ml-1.5",children:e.jsx(w,{id:"sZSyGZ",defaultMessage:[{type:0,value:"启用"}]})})})}]:[]},auth:{title:s.formatMessage({id:"UEiMSy",defaultMessage:[{type:0,value:"身份验证"}]}),openItem:d=>`/workbench/auth/${d}`,newItem:"/workbench/auth/new",navAction:[{icon:Wi,path:"/workbench/auth/role/role",tooltip:s.formatMessage({id:"WWNrrS",defaultMessage:[{type:0,value:"权限管理"}]})}],bottom:e.jsx("div",{className:ge.bottomRowWrapper,children:e.jsx("div",{className:ge.bottomRow,children:e.jsx("span",{className:ge.btn,onClick:()=>n("/workbench/setting/security"),children:e.jsx(w,{id:"xzl0Bm",defaultMessage:[{type:0,value:"配置登录回调"}]})})})}),request:{getList:()=>{Kt()},editItem:async d=>await B.post("/authentication/rename",d),delItem:async d=>await B.delete(`/authentication/${d}`)}}}),[s,n,i.toggleOperationHook]),m=o.useMemo(()=>b[t.type],[b,t.type]),_=Re(),[k,N]=o.useState(),[E,S]=o.useState(),{refreshMap:j,navCheck:P}=o.useContext(Ue),[H,g]=o.useState(!1);if(!v)return null;const I=d=>{var $;const O=[{key:"rename",disabled:d.readonly,label:e.jsx("div",{onClick:()=>!d.readonly&&N(d),children:e.jsx("span",{className:"ml-1.5",children:e.jsx(w,{id:"JeJAmT",defaultMessage:[{type:0,value:"重命名"}]})})})},{key:"delete",disabled:d.readonly,label:e.jsx(kt,{zIndex:9999,placement:"right",title:s.formatMessage({id:"I0f7tt",defaultMessage:[{type:0,value:"确认删除吗？"}]}),onConfirm:()=>void R(E),okText:s.formatMessage({id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]}),cancelText:s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]}),overlayClassName:ge["delete-label"],okType:"danger",trigger:d.readonly?"":"click",children:e.jsx("div",{children:e.jsx("span",{className:"ml-1.5",children:e.jsx(w,{id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]})})})})}];return m.navMenu&&O.unshift(...(($=m.navMenu)==null?void 0:$.call(m,d))??[]),e.jsx(Gs,{onClick:Q=>{Q.key!=="delete"&&S(void 0)},items:O})},R=async d=>{if(d&&(await m.request.delItem(d),m.request.getList(),S(void 0),m.openItem(d)===_.pathname)){const O=v.findIndex($=>$.name!==d);O>=0?A(v[O]):n(m.newItem)}},D=async d=>{const O=k==null?void 0:k._row;if(O===void 0)return;const $=a(d);if($){ne.error($);return}await m.request.editItem({src:O.name,dst:d,overload:!1}),m.request.getList(),N(void 0),Vi()},A=d=>{if(d.openInNewPage){window.open(d.openInNewPage);return}const O=m.openItem(d.name);P().then($=>{$&&n(O)})};return e.jsx(St,{title:m.title,onAdd:()=>n(m.newItem),onOpen:d=>g(d),defaultOpen:t.defaultOpen,action:e.jsx(e.Fragment,{children:(V=m.navAction)==null?void 0:V.map(d=>e.jsxs(te,{title:d.tooltip,children:[e.jsx("div",{className:"flex mr-1.5",onClick:()=>n(d.path),children:e.jsx("img",{width:19,height:19,src:d.icon,alt:"头像"})})," "]},d.path))}),children:e.jsxs("div",{className:ge.container,children:[v.map(d=>{const O=m.openItem(d.name);return e.jsxs("div",{className:`${ge.row} ${d.enabled?"":ge.rowDisable} ${O===_.pathname?ge.active:""}`,onClick:()=>A(d),children:[(k==null?void 0:k.name)===d.name&&k?e.jsx(Qt,{onPressEnter:$=>void D($.target.value),onBlur:$=>void D($.target.value),onKeyUp:$=>{$.key=="Escape"&&N(void 0)},className:"font-normal h-5 text-sm leading-4 w-5/7",defaultValue:k.name,autoFocus:!0,placeholder:s.formatMessage({id:"nooQRz",defaultMessage:[{type:0,value:"请输入外部数据源名"}]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:ge.icon,children:e.jsx(ta,{width:12,height:12,preview:!1,alt:d.name,src:d.svg??"./assets/icon/github-fill.svg"})}),e.jsx("div",{className:ge.title,children:d.name}),e.jsx("div",{className:ge.tip,title:d.tip,children:d.tip})]}),e.jsx("div",{onClick:$=>$.stopPropagation(),children:e.jsx(ot,{dropdownRender:()=>I(d),trigger:["click"],open:E===d.name,onOpenChange:$=>{S($?d.name:void 0)},placement:"bottomRight",children:e.jsx("div",{className:ge.more,onClick:$=>$.preventDefault()})})})]},d.name)}),m.bottom]})})}const ar="_headerFilter_1fjqx_1",nr="_headerConfig_1fjqx_2",ir="_headerRefresh_1fjqx_3",rr="_headerNewFold_1fjqx_4",or="_headerNewFile_1fjqx_5",lr="_createRowWrapper_1fjqx_25",cr="_createRow_1fjqx_25",dr="_btn_1fjqx_44",ur="_graphqlEntry_1fjqx_48",fr="_treeContainer_1fjqx_59",mr="_treeItem_1fjqx_117",hr="_title_1fjqx_117",gr="_treeItemDir_1fjqx_126",pr="_icon_1fjqx_126",xr="_treeItemFile_1fjqx_130",vr="_lighting_1fjqx_138",yr="_suffix_1fjqx_160",br="_errLabel_1fjqx_165",_r="_more_1fjqx_178",jr="_method_1fjqx_188",wr="_method_get_1fjqx_193",Mr="_method_post_1fjqx_196",kr="_menuItem_1fjqx_199",ve={headerFilter:ar,headerConfig:nr,headerRefresh:ir,headerNewFold:rr,headerNewFile:or,createRowWrapper:lr,createRow:cr,btn:dr,graphqlEntry:ur,treeContainer:fr,treeItem:mr,title:hr,treeItemDir:gr,icon:pr,treeItemFile:xr,lighting:vr,suffix:yr,errLabel:br,more:_r,method:jr,method_get:wr,method_post:Mr,menuItem:kr};function Cr(t){const s=be(),a=$e(),i=Re(),n=Zt(),[l,c]=o.useState(),[u,p]=o.useState(!1),[v,b]=o.useState(""),{validateName:m}=Mt(),_=o.useRef({addItem:()=>{},editItem:()=>{}});o.useEffect(()=>{var I;if(!l||!n.name||n.name==="new"||!i.pathname.startsWith("/workbench/storage")){b("");return}const g=l.find(R=>R.data.name===n.name);if(!g){a("/workbench/storage",{replace:!0});return}if(n.profile&&!((I=g.children)!=null&&I.find(R=>R.key===`${n.name}_${n.profile}`))){a(`/workbench/storage/${n.name}`,{replace:!0});return}b((n.profile?`${n.name}_${n.profile}`:n.name)??"")},[i,a,n,l]),o.useEffect(()=>{t.defaultOpen&&p(!0)},[t.defaultOpen]);const k=Jt();o.useEffect(()=>{const g=(k??[]).map(I=>{const R={data:I,key:I.name,name:I.name,isDir:!0},D=Object.entries(I.uploadProfiles??{}).map(([A,V])=>({data:V,key:`${I.name}_${A}`,name:A,isDir:!1,parent:R}));return R.children=D,R});c(g)},[k]);const N=o.useCallback(function(g,I=!1){return async(...R)=>{const D=ne.loading(s.formatMessage({id:"QpRtOT",defaultMessage:[{type:0,value:"执行中"}]}));try{await g(...R),!I&&await Ge()}catch{}D()}},[s]),E=N(async g=>{g.isDir?await B.delete(`/storage/${g.data.name}`):await B.put("/storage",{name:g.parent.data.name,uploadProfiles:{[g.name]:null}})}),S=(g,I=!1)=>{let R=m(g);return R?(ne.error(R),!1):!0},j=N(async(g,I)=>{g.isDir?(await B.post("/storage/rename",{src:g.data.name,dst:I,overload:!1}),await Ge()):(await B.put("/storage",{name:g.parent.data.name,uploadProfiles:{[g.name]:null,[I]:g.data}}),await Ge(),n.name===g.parent.data.name&&n.profile===g.name&&a(`/workbench/storage/${g.parent.data.name}/profile/${I}`))},!0),P=async(g,I,R)=>{try{return await B.put("/storage",{name:g.name,uploadProfiles:{[R]:{hooks:{},maxAllowedUploadSizeBytes:10*2**20,maxAllowedFiles:1}}}),await Ge(),a(`/workbench/storage/${g.name}/profile/${R}`),!0}catch{return!1}},H=g=>{var R,D;let I;return g.isDir?I=ve.treeItemDir:I=ve.treeItemFile,e.jsxs("div",{className:`${ve.treeItem} ${I}`,children:[e.jsx("div",{className:ve.icon}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${ve.method} ${ve[`method_${(R=g.data.method)==null?void 0:R.toLowerCase()}`]}`,children:(D=g.data.method)==null?void 0:D.toUpperCase()}),e.jsx("div",{className:ve.title,children:g.name}),e.jsx("div",{onClick:A=>A.stopPropagation(),children:e.jsx(ot,{destroyPopupOnHide:!0,menu:{items:[{key:"profile",onClick:async()=>{_.current.addItem(!1,!1,g.key)},label:e.jsx(w,{id:"WeEtDm",defaultMessage:[{type:0,value:"新建 Profile"}]})},{key:"detail",onClick:()=>{a(`/workbench/storage/${g.data.name}`)},label:e.jsx(w,{id:"cDZ00w",defaultMessage:[{type:0,value:"查看"}]})},{key:"rename",onClick:()=>{_.current.editItem(g.key)},label:e.jsx(w,{id:"JeJAmT",defaultMessage:[{type:0,value:"重命名"}]})},{key:"delete",label:e.jsx("div",{onClick:A=>{var V,d;(d=(V=A.target)==null?void 0:V.dataset)!=null&&d.stoppropagation&&A.stopPropagation()},children:e.jsx(kt,{zIndex:9999,title:s.formatMessage({id:"9Fxs0Y",defaultMessage:[{type:0,value:"确定删除吗?"}]}),onConfirm:()=>{E(g)},okText:s.formatMessage({id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]}),cancelText:s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]}),placement:"right",children:e.jsx("div",{className:ve.menuItem,"data-stoppropagation":"1",children:e.jsx(w,{id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]})})})})}].filter(A=>["delete","rename"].includes(A.key)||g.isDir)},trigger:["click"],placement:"bottomRight",children:e.jsx("div",{className:ve.more,onClick:A=>A.preventDefault()})})})]})]})};return e.jsx(St,{...t,title:s.formatMessage({id:"E6yn6S",defaultMessage:[{type:0,value:"文件存储"}]}),hideAdd:!0,open:u,onOpen:g=>{p(g),t.onOpen&&t.onOpen(g)},action:e.jsx(e.Fragment,{children:e.jsx(te,{title:s.formatMessage({id:"tVoPUq",defaultMessage:[{type:0,value:"新建"}]}),children:e.jsx("div",{className:ve.headerNewFile,onClick:()=>{p(!0),a("/workbench/storage/new")}})})}),children:e.jsx(hs,{draggable:!1,fileText:s.formatMessage({id:"E6yn6S",defaultMessage:[{type:0,value:"文件存储"}]}),ref:_,onSelectFile:g=>{g.isDir?a(`/workbench/storage/${g.data.name}/manage`):a(`/workbench/storage/${g.parent.data.name}/profile/${g.name}`)},onRename:async(g,I)=>{if(I&&S(I,g.isDir))try{return await j(g,I),!0}catch(R){return console.error(R),!1}return!1},onCreateItem:P,selectedKey:v,rootClassName:"h-full",treeClassName:ve.treeContainer,treeData:l??[],titleRender:H})})}const Sr="_container_oquhq_1",Nr="_tabs_oquhq_6",Ir="_tabs_inner_oquhq_11",Ar="_tabs_tab_oquhq_19",Er="_tabs_tab__active_oquhq_30",Rr="_apiIcon_oquhq_36",$r="_dataIcon_oquhq_42",Tr="_panels_oquhq_60",Me={container:Sr,tabs:Nr,tabs_inner:Ir,tabs_tab:Ar,tabs_tab__active:Er,apiIcon:Rr,dataIcon:$r,panels:Tr},Fr=We.lazy(()=>jt(()=>import("./index-24e9cd61.js"),["./index-24e9cd61.js","./index-a194352f.js","./index-0fbe7e91.css","./fireBoomAPIOperator-2d14b356.js","./toNumber-ac9ebd8c.js","./fireBoomConstants-acaaa4c8.js","./PrismaSchemaContext-b413fd04.js","./ModelingHelpers-9ea3d100.js","./PrismaSchemaActions-5cb76651.js","./useEntities-31c38161.js","./useCurrentEntity-0159db83.js","./hotkey-3a258436.js","./datasource-aeb77a97.js","./ServiceDiscovery-2e176802.js","./index-712741e9.js","./useShowArrow-630a3465.js","./index-5ad4076b.js","./DownOutlined-41d61a23.js","./PurePanel-1bea721a.js","./use-immer.module-5eff6578.js","./index-9ecf1558.js","./LeftOutlined-e97baa49.js","./index-e03870b1.js","./index-0819aea3.js","./index-cbbb9550.js","./index-78f224a4.css"],import.meta.url)),Bt={api:"/workbench",data:"/workbench/modeling"};function Or(){const[t,s]=o.useState(""),a=Re(),i=$e();o.useContext(Ue),o.useEffect(()=>Ve("alt+m,^+m",()=>{a.pathname.startsWith("/workbench/modeling")?i("/workbench"):i("/workbench/modeling"),s(t)}),[]),o.useEffect(()=>{const m=a.pathname.startsWith("/workbench/modeling")?"data":"api";s(m)},[a.pathname]);const{panel:n}=o.useContext(Ws),{handleToggleDesigner:l,handleClickEntity:c,handleChangeSource:u,setShowType:p,dataSources:v}=n||{},b=m=>{Bt[t]=a.pathname,i(Bt[m])};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:Me.tabs,children:e.jsxs("div",{className:Me.tabs_inner,children:[e.jsxs("div",{className:`${Me.tabs_tab} ${t==="api"?Me.tabs_tab__active:""}`,onClick:()=>{b("api")},children:[e.jsx("div",{className:Me.apiIcon}),e.jsx(w,{id:"aj1rA6",defaultMessage:[{type:0,value:"API设计"}]})]}),e.jsxs("div",{className:`${Me.tabs_tab}  ${t==="data"?Me.tabs_tab__active:""}`,onClick:()=>{b("data")},children:[e.jsx("div",{className:Me.dataIcon}),e.jsx(w,{id:"ueuJlz",defaultMessage:[{type:0,value:"数据建模"}]})]})]})}),t==="api"?e.jsxs("div",{className:Me.panels,children:[e.jsx(qi,{defaultOpen:a.pathname.startsWith("/workbench/apimanage/")}),e.jsx(Pt,{type:"dataSource",defaultOpen:a.pathname.startsWith("/workbench/data-source/")}),e.jsx(Pt,{type:"auth",defaultOpen:a.pathname.startsWith("/workbench/auth/")}),e.jsx(Cr,{defaultOpen:a.pathname.startsWith("/workbench/storage/")})]}):null,t==="data"&&n?e.jsx(o.Suspense,{children:e.jsx(Fr,{setShowType:p,changeToER:()=>p("erDiagram"),addNewModel:()=>p("newModel"),addNewEnum:()=>p("newEnum"),sourceOptions:v,onChangeSource:m=>u(m),onClickEntity:c,onToggleDesigner:l})}):null]})}const Dr={success:e.jsx(Ca,{className:"text-[#52c41a]"}),info:e.jsx(Oa,{className:"text-[#1677ff]"}),warning:e.jsx(na,{className:"text-[#faad14]"}),error:e.jsx(Ea,{className:"text-[#ff4d4f]"})},Pr=t=>{const{silentMode:s,visible:a,toggleVisible:i}=ct();return e.jsxs(e.Fragment,{children:[e.jsx("span",{...t,onClick:i,children:s?e.jsx(Xt,{className:"cursor-pointer"}):e.jsx(es,{className:"cursor-pointer"})}),e.jsx(Br,{})]})},Br=t=>{const{silentMode:s,visible:a,hide:i,removeNotification:n,toggleSilentMode:l,notifications:c,clear:u}=ct();return a?e.jsxs("div",{className:"shadow-lg rounded absolute right-2 bottom-9 z-1000 bg-white min-w-100 max-w-150 overflow-hidden",children:[e.jsxs("div",{className:"px-2 py-2 bg-[#e3e3d3] flex items-center text-xs",children:[e.jsx("span",{className:"mr-auto",children:e.jsx(w,{id:"2QhCqB",defaultMessage:[{type:0,value:"通知"}]})}),e.jsx(Ts,{onClick:u,className:"cursor-pointer"}),s?e.jsx(Xt,{className:"ml-3 cursor-pointer",onClick:l}):e.jsx(es,{className:"ml-3 cursor-pointer",onClick:l}),e.jsx(aa,{className:"ml-3 cursor-pointer",onClick:i})]}),e.jsx("div",{className:"max-h-[80vh] overflow-y-auto",children:c.map(p=>{var v,b;return e.jsxs("div",{className:"p-3 border border-solid border-[transparent] focus:border-[#e92e5e] text-xs",tabIndex:0,style:{boxShadow:"0 1px 0 0 rgba(0,0,0,0.05)"},children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"flex-shrink-0 leading-5",children:Dr[p.type??"info"]}),e.jsx("div",{className:"flex-1 ml-2 text-[#333] leading-5",children:p.title}),e.jsx("span",{className:"ml-4 leading-5",children:e.jsx(Fs,{className:"flex-shrink-0 cursor-pointer text-[#333]",onClick:()=>n(p)})})]}),(p.source||((v=p.buttons)==null?void 0:v.length))&&e.jsxs("div",{className:"mt-2 flex",children:[p.source&&e.jsxs("span",{className:"text-[#999] mr-auto",children:[e.jsx(w,{id:"gHh5tj",defaultMessage:[{type:0,value:"来源:"}]}),"  ",p.source]}),(b=p.buttons)==null?void 0:b.map((m,_)=>e.jsx(qe,{className:nt([_===p.buttons.length-1?"":"mr-1.5",_===0?"ml-auto":"","!text-xs"]),type:m.type,size:"small",onClick:async()=>{await m.handler(),m.closeAfterHandler!==!1&&n(p)},children:m.label},_))]})]},p.id)})})]}):null},Lr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUBAMAAAB/pwA+AAAALVBMVEUAAADcMzfbMzjcMzjcMzfbMzjbMzjbMzjcNDfcMjjbMzncMjndMDrMMzPcMzhS8Fk3AAAADnRSTlMA2oN7v/Kkl4p+VVE1BYqnDOIAAAB9SURBVAjXY2Bg4F0mGph1gQEENj4sNpeTBrE4nhxgYODxawAy+wxAAswvGBi4HzOAgd0GhosOLBMYGDgdWGQZ1h3gfMTAoDeB5xVDIpBWYALyxBjEGRiYHukpMDAUMgQzAIUfAQlTZCZCAbI2hGHIViAsRjgH1ZEIpyM8BADg2ivV/Yu2FwAAAABJRU5ErkJggg==",zr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAASFBMVEUAAAD/phH/phD/phD/phH/phH/phH/phH/phH/phH/phH/pxD/mQD/pRL/phD/pxD/pxP/qBL/pxH/phH/pxH/pg//pRD/pxEWxSq2AAAAF3RSTlMAcsnYz/Lct6SRilEFVTAuGlXFvnZFQZ7lVmoAAACWSURBVBjTbZFZDsMgDESHsAdIIBv3v2lFXbCI6g+MnjR4POBbMTmptXQpYlQwVfpLeFVN6GytdqPbZuvamWgt53YKooEYzhNEAxCNJcGyULcmotR9hlstcAozhHKQ/g29hBZvKPQfeGmWH8eQ86Dn4UGpW8q5W0psXqlhnte877EmBwJiHJP9vbu36Dhk5QWHTBXL9B0fJhYGQqr75V8AAAAASUVORK5CYII=",qr="_dot_137ba_1",Hr="_dotError_137ba_9",Vr="_notSupport_137ba_24",ke={dot:qr,dotError:Hr,notSupport:Vr},Wr=({existed:t,defaultLimits:s,userLimits:a,userCode:i,expireTime:n,type:l})=>{const c=be(),{data:u}=ca("license.json"),p=Le(n).isBefore(Le()),v=Le(n).diff(Le(),"day"),b=v<=7,m={community:c.formatMessage({id:"G8MZAS",defaultMessage:[{type:0,value:"社区版"}]}),professional:c.formatMessage({id:"x7YUWW",defaultMessage:[{type:0,value:"专业版"}]}),enterprise:c.formatMessage({id:"cjjAzK",defaultMessage:[{type:0,value:"企业版"}]}),prismaDatasource:c.formatMessage({id:"1t+raV",defaultMessage:[{type:0,value:"Prisma数据源"}]})},_=k=>k===-1?e.jsx(w,{id:"fDOkY1",defaultMessage:[{type:0,value:"不限制"}]}):k;return e.jsx(as,{placement:"topRight",arrow:!1,content:e.jsxs("div",{className:"w-160 px-3 pt-4.5 pb-5",children:[e.jsxs("div",{className:"text-[#333]",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{id:"8N6B3R",defaultMessage:[{type:0,value:"机器码"}]}),e.jsx("span",{className:"ml-8",children:i}),e.jsx(da,{className:"ml-3 cursor",onClick:()=>{oa(i),ne.success(c.formatMessage({id:"aIrpM5",defaultMessage:[{type:0,value:"已复制"}]}))}})]}),e.jsx("div",{className:"mt-5 mb-2 text-[rgba(95,98,105,0.6)] text-xs",children:e.jsx(w,{id:"DJsFlH",defaultMessage:[{type:0,value:"权益"}]})}),e.jsxs("div",{className:"flex items-center flex-wrap",children:[e.jsxs("div",{className:"min-w-1/4 leading-10 flex items-center",children:[e.jsx("div",{className:ke.dot}),e.jsx(w,{id:"Y+NWSo",defaultMessage:[{type:0,value:"API数量"}]}),e.jsx("span",{className:"ml-5",children:_(a==null?void 0:a.operation)})]}),e.jsxs("div",{className:"min-w-1/4 leading-10 flex items-center",children:[e.jsx("div",{className:ke.dot}),e.jsx(w,{id:"isALfz",defaultMessage:[{type:0,value:"数据源数量"}]}),e.jsx("span",{className:"ml-5",children:_(a==null?void 0:a.datasource)})]}),(a==null?void 0:a.incrementBuild)===1?e.jsxs("div",{className:"min-w-1/4 leading-10 flex items-center",children:[e.jsx("div",{className:ke.dot}),e.jsx(w,{id:"zVrDoA",defaultMessage:[{type:0,value:"增量编译"}]})]}):e.jsx(te,{title:c.formatMessage({id:"BWZSk1",defaultMessage:[{type:0,value:"请购买商业授权"}]}),children:e.jsxs("a",{className:nt("min-w-1/4 leading-10 flex items-center",ke.notSupport),href:u==null?void 0:u.buyLicenseUrl,target:"_blank",rel:"noreferrer",children:[e.jsx("div",{className:ke.dotError,children:"x"}),e.jsx(w,{id:"zVrDoA",defaultMessage:[{type:0,value:"增量编译"}]})]})}),(a==null?void 0:a.prismaDatasource)===1?e.jsxs("div",{className:"min-w-1/4 leading-10 flex items-center",children:[e.jsx("div",{className:ke.dot}),e.jsx(w,{id:"1t+raV",defaultMessage:[{type:0,value:"Prisma数据源"}]})]}):e.jsx(te,{title:c.formatMessage({id:"BWZSk1",defaultMessage:[{type:0,value:"请购买商业授权"}]}),children:e.jsxs("a",{className:nt("min-w-1/4 leading-10 flex items-center",ke.notSupport),href:u==null?void 0:u.buyLicenseUrl,target:"_blank",rel:"noreferrer",children:[e.jsx("div",{className:ke.dotError,children:"x"}),e.jsx(w,{id:"1t+raV",defaultMessage:[{type:0,value:"Prisma数据源"}]})]})}),e.jsxs("div",{className:"min-w-1/4 leading-10 flex items-center",children:[e.jsx("div",{className:ke.dot}),e.jsx(w,{id:"oEls6O",defaultMessage:[{type:0,value:"客服支持"}]})]})]})]}),e.jsx("div",{className:"mt-4 mb-5 h-1px",style:{border:"none",borderTop:"1px dashed #979797"}}),e.jsxs("div",{className:"flex items-center",children:[n&&t&&a&&e.jsxs(e.Fragment,{children:[e.jsx(w,{id:"b/np9H",defaultMessage:[{type:0,value:"过期时间"}]}),e.jsxs("div",{className:"ml-2 flex items-center h-8 bg-[#F8F9FD] px-3 w-69",style:{color:p||b?"#F21212":void 0},children:[la(n),p&&e.jsx("span",{className:"ml-2 text-[10px] bg-[rgba(241,18,18,0.8)] text-white rounded px-1 py-1 scale-75 transform",children:e.jsx(w,{id:"RclhRU",defaultMessage:[{type:0,value:"已过期"}]})}),b&&e.jsxs("span",{className:"ml-2",children:["(",e.jsx(w,{id:"s1uqMz",defaultMessage:[{type:0,value:"剩余"},{type:1,value:"left"},{type:0,value:"天"}],values:{left:v}}),")"]})]})]}),e.jsx(qe,{className:"ml-auto",onClick:()=>window.open(u==null?void 0:u.buyLicenseUrl,"_blank"),children:e.jsx(w,{id:"It/5QC",defaultMessage:[{type:0,value:"购买授权"}]})}),(u==null?void 0:u.freeGiftUrl)&&e.jsxs("div",{className:"relative ml-4",children:[e.jsx(qe,{type:"primary",onClick:()=>window.open(u==null?void 0:u.freeGiftUrl,"_blank"),style:{backgroundImage:"linear-gradient(36deg, #FFAE72 0%, #FF5E5E 100%)",boxShadow:"0px 2px 4px 0px rgba(255,116,99,0.5)",border:"none"},children:e.jsx(w,{id:"naK/qg",defaultMessage:[{type:0,value:"免费获取"}]})}),(u==null?void 0:u.isLimittedTime)&&e.jsx("div",{className:"absolute -right-2 -top-3 z-99 bg-[#F44848] text-white scale-75 transform px-1.5 py-0.5 text-xs rounded border border-solid border-white",children:e.jsx(w,{id:"+Ma7BJ",defaultMessage:[{type:0,value:"限时"}]})})]})]})]}),trigger:"click",children:e.jsx("span",{className:"text-[#326d9f] bg-white rounded-sm cursor-pointer text-xs py-0.5 px-1",children:t&&!a?e.jsx(w,{id:"QdaK6D",defaultMessage:[{type:0,value:"非法授权"}]}):m[l]})})},Ur="_info_enemk_9",Kr="_gitIcon_enemk_17",Gr="_errLabel_enemk_23",Yr="_split_enemk_27",Qr="_hookEntry_enemk_33",Zr="_statusLabel_enemk_36",Jr="_entry_enemk_39",Xr="_label_enemk_44",eo="_hookMask_enemk_47",to="_hookContainer_enemk_55",Z={"status-bar":"_status-bar_enemk_1",info:Ur,gitIcon:Kr,errLabel:Gr,split:Yr,hookEntry:Qr,statusLabel:Zr,entry:Jr,label:Xr,hookMask:eo,hookContainer:to},Lt="dev.tip",so=({className:t,menuWidth:s,toggleWindow:a,license:i})=>{var J,le;const n=be(),{engineStartTime:l,fbCommit:c,fbVersion:u,engineStatus:p,hookStatus:v,hookStartTime:b}=ts(),[m,_]=o.useState(localStorage.getItem(Lt)!=="false"),{getConfigurationValue:k}=wt(),N=ra(),{questions:E}=os(f=>({questions:f.questions})),S=o.useMemo(()=>({[me.Building]:n.formatMessage({id:"T0bxDG",defaultMessage:[{type:0,value:"编译中"}]}),[me.EngineIncrementBuild]:n.formatMessage({id:"QyStY8",defaultMessage:[{type:0,value:"增量编译中"}]}),[me.Built]:n.formatMessage({id:"Zz7nBV",defaultMessage:[{type:0,value:"已编译"}]}),[me.BuildFailed]:n.formatMessage({id:"rbmyiL",defaultMessage:[{type:0,value:"编译失败"}]}),[me.Starting]:n.formatMessage({id:"h3R9PB",defaultMessage:[{type:0,value:"启动中"}]}),[me.EngineIncrementStart]:n.formatMessage({id:"NaeJNm",defaultMessage:[{type:0,value:"增量启动中"}]}),[me.Started]:n.formatMessage({id:"PpQOV5",defaultMessage:[{type:0,value:"已启动"}]}),[me.StartFailed]:n.formatMessage({id:"Xz2JYA",defaultMessage:[{type:0,value:"启动失败"}]})}),[n]),[j,P]=o.useState(),[H,g]=o.useState(),{globalSetting:I,appRuntime:R,updateGlobalSetting:D}=_t(),A=$e(),{vscode:V}=o.useContext(He),{data:d}=yt("/sdk",B.get);o.useEffect(()=>{if(!l)return;P(N(l));const f=setInterval(()=>{P(N(l))},6e4);return()=>{clearInterval(f)}},[l,N]);const O=()=>{localStorage.setItem(Lt,"false"),_(!1)},$=e.jsx("span",{className:`ml-1 ${v==="running"?"text-[#50C772]":"text-[#f0b763]"}`,children:v==="not_started"?n.formatMessage({id:"GbiB/D",defaultMessage:[{type:0,value:"未启动"}]}):v==="running"?n.formatMessage({id:"PpQOV5",defaultMessage:[{type:0,value:"已启动"}]}):n.formatMessage({id:"0SsgZX",defaultMessage:[{type:0,value:"已停止"}]})}),Q=b?new Date(b).toLocaleString():"-";return e.jsxs("div",{className:t,children:[e.jsxs("div",{className:Z["status-bar"],children:[e.jsxs("span",{className:Z.info,children:[e.jsx("span",{className:Z["info-env"]+" mr-2",children:R.dev?e.jsx(te,{open:m,arrow:!0,title:e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{id:"ZhU+bx",defaultMessage:[{type:0,value:"请勿将开发模式用于生产"}]}),e.jsx("span",{className:"ml-4 cursor-pointer",onClick:O,children:e.jsx(w,{id:"r1IImU",defaultMessage:[{type:0,value:"知道了"}]})})]}),children:e.jsx("span",{children:e.jsx(w,{id:"uY5Slp",defaultMessage:[{type:0,value:"开发模式"}]})})}):e.jsx(w,{id:"WeuMpp",defaultMessage:[{type:0,value:"生产模式"}]})}),e.jsxs("span",{className:Z["info-version"]+" mr-2",children:[e.jsx("span",{children:"FB:"}),e.jsx(te,{title:c,children:e.jsx("span",{className:"",children:u})})]}),e.jsx("span",{onClick:()=>{a("0")},className:Z.errLabel+" mr-2 cursor-pointer",children:e.jsx("span",{children:e.jsx(w,{id:"608d8o",defaultMessage:[{type:0,value:"日志"}]})})}),e.jsxs("span",{onClick:()=>{a("1")},className:"cursor-pointer flex items-center",children:[e.jsxs("span",{className:Z.errLabel,children:[e.jsx("img",{height:14,width:14,src:Lr,alt:"错误"}),e.jsx("span",{className:"ml-2",children:E.filter(f=>f.level==="error").length})]}),e.jsxs("span",{className:Z.errLabel,style:{marginLeft:8},children:[e.jsx("img",{height:14,width:14,src:zr,alt:"警告"}),e.jsx("span",{className:"ml-2",children:E.filter(f=>f.level==="warn").length})]})]}),e.jsxs("span",{className:"ml-3",children:[" ",e.jsx(w,{id:"Ipvx+S",defaultMessage:[{type:0,value:"引擎"}]}),":"," "]}),e.jsx("span",{className:Z.errLabel+" ml-1",children:p===me.BuildFailed||p===me.StartFailed?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-[#cd3021] rounded-3px h-3px w-3px"}),e.jsx(te,{open:!0,title:n.formatMessage({id:"XIRdkO",defaultMessage:[{type:0,value:"请检查项目配置并重启fireboom"}]}),children:e.jsx("span",{className:"ml-1 text-[#cd3021]",children:S[p]??""})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-[#50C772] rounded-3px h-3px w-3px"}),e.jsx("span",{className:"ml-1 text-[#50C772]",children:S[p]??""})]})}),e.jsxs("span",{className:"ml-3",children:[" ",e.jsx(w,{id:"UU3d6B",defaultMessage:[{type:0,value:"钩子"}]}),":"," "]}),e.jsxs("span",{className:Z.errLabel+" cursor-pointer ml-1",children:[e.jsxs("div",{className:"flex h-full items-center",children:[e.jsx("div",{className:"rounded-3px h-3px w-3px"+(v==="running"?" bg-[#50C772]":" bg-[#f0b763]")}),v!=="not_started"?e.jsx(te,{title:v==="running"?e.jsx(w,{id:"KmbQjI",defaultMessage:[{type:0,value:"启动时间: "},{type:1,value:"time"}],values:{time:Q}}):e.jsx(w,{id:"GTF+uo",defaultMessage:[{type:0,value:"停止时间: "},{type:1,value:"time"}],values:{time:Q}}),children:$}):$,e.jsx("div",{className:"flex h-full pl-1 items-center",onClick:f=>{Ce({channel:"hookReport",event:"pull"}),f.stopPropagation()},children:e.jsx("img",{alt:"",src:"./assets/refresh.svg"})})]}),e.jsx("div",{className:Z.split}),e.jsxs("div",{className:"flex h-full items-center",onClick:()=>g(!0),children:[e.jsx("div",{className:Z.hookEntry,children:k(I.serverOptions.serverUrl)}),e.jsx("div",{className:"mr-5px ml-8px",style:{transform:H?"rotate(180deg)":""},children:e.jsx("img",{alt:"",src:"./assets/hook-arrow.svg"})})]}),H&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:Z.hookMask,onClick:f=>{f.stopPropagation(),g(!1)}}),e.jsx("div",{className:Z.hookContainer+" common-form",onClick:f=>{f.stopPropagation()},children:e.jsxs(Os,{initialValues:I.serverOptions,onFinish:f=>{D({serverOptions:{...I.serverOptions,...f}})},children:[e.jsx("div",{className:"pt-2 text-[#999] text-sm",children:e.jsx(w,{id:"OzNfBQ",defaultMessage:[{type:0,value:"钩子服务地址"}]})}),e.jsxs("div",{className:"mt-2 flex items-center flex-1",children:[e.jsx(sa,{formItemProps:{name:"serverUrl",className:"flex-1"},inputProps:{placeholder:"http://localhost:9992"},required:!0}),e.jsx(qe,{htmlType:"submit",className:"ml-2 mb-5",type:"primary",children:"保存"})]})]})})]})]}),e.jsxs("div",{className:Z.entry+" cursor-pointer",onClick:()=>A("/workbench/sdk-template"),children:[e.jsx(w,{id:"p5GCek",defaultMessage:[{type:0,value:"钩子模版"}]}),":",e.jsx("span",{className:Z.label,children:((J=d==null?void 0:d.find(f=>f.type==="server"&&f.enabled))==null?void 0:J.language)??"未选择"})]}),e.jsxs("div",{className:Z.entry+" cursor-pointer",onClick:()=>A("/workbench/sdk-template"),children:[e.jsx(w,{id:"gRp6eK",defaultMessage:[{type:0,value:"客户端模版"}]}),":",e.jsx("span",{className:Z.label,children:((le=d==null?void 0:d.filter(f=>f.type==="client"))==null?void 0:le.length)??0})]}),e.jsxs("div",{className:Z.entry,children:[e.jsx(w,{id:"wZkLCJ",defaultMessage:[{type:0,value:"编译时间"}]}),":",e.jsx("span",{className:Z.label,children:j})]})]}),e.jsx("span",{className:"ml-auto",children:i&&e.jsx(Wr,{...i})}),e.jsx("span",{className:"bg-white rounded-sm cursor-pointer ml-4 text-xs py-0.5 px-1 text-[#326d9f]",onClick:()=>{var f;(f=V==null?void 0:V.options)!=null&&f.visible?V.hide():V.show()},children:e.jsx(w,{id:"IOCqZm",defaultMessage:[{type:0,value:"钩子编辑器⇪"}]})}),e.jsx(Pr,{className:"bg-white rounded-sm cursor-pointer ml-4 text-xs py-0.5 px-1 text-[#326d9f] inline-flex items-center"})]}),e.jsx(ia,{className:"top-9 z-1000 fixed",style:{left:`${s}px`,width:`calc(100vw - ${s}px)`,height:"calc(100vh - 64px)"}})]})},ao=so,no=We.lazy(()=>jt(()=>import("./modelingWrapper-66f61bab.js"),["./modelingWrapper-66f61bab.js","./index-a194352f.js","./index-0fbe7e91.css","./use-immer.module-5eff6578.js","./PrismaSchemaActions-5cb76651.js","./fireBoomAPIOperator-2d14b356.js","./toNumber-ac9ebd8c.js","./fireBoomConstants-acaaa4c8.js","./PrismaSchemaContext-b413fd04.js","./ModelingHelpers-9ea3d100.js","./networkStatus-8d5fc8f2.js","./store-fb3bcbe5.js","./parser-0b83345b.js","./predicates-408eacef.js","./datasource-aeb77a97.js","./ServiceDiscovery-2e176802.js"],import.meta.url)),io=We.lazy(()=>jt(()=>import("./index-4a695c69.js"),["./index-4a695c69.js","./index-a194352f.js","./index-0fbe7e91.css","./datasource-aeb77a97.js","./ServiceDiscovery-2e176802.js","./index-5ad4076b.js","./dayjs.min-3f69c204.js","./use-immer.module-5eff6578.js","./globalContext-ca83e6af.js","./workbenchContext-5e70c262.js","./interface-41bd3122.js","./engine-9b49d695.js","./db-38bf0aa6.js","./index-ece89910.js","./variable-62d048d3.js","./common-7ac8785d.js","./auth-d9a41f11.js","./hotkey-3a258436.js","./index-24b15e3c.js","./PurePanel-1bea721a.js","./index-cbbb9550.js","./PrismaSchemaContext-b413fd04.js","./index-9ecf1558.js","./LeftOutlined-e97baa49.js","./index-e03870b1.js","./index-cfc29fbc.js","./useShowArrow-630a3465.js","./DownOutlined-41d61a23.js","./conductUtil-0686c632.js","./index-cd2698a3.js","./validate-2aa69327.js","./store-fb3bcbe5.js","./parser-0b83345b.js","./index-0819aea3.js","./index-f7f97548.js","./addEventListener-3f05c238.js","./index-47a6ce9b.js","./index-712741e9.js","./index-a13c9690.js","./WarningOutlined-bdcc9a41.js","./index-5d7fb404.js","./calcTime-fb7795e9.js","./index-ce3c58de.js","./utils-9b986f1e.js","./CopyOutlined-e41cebb1.js","./index-1f632c02.js","./index-9e52deba.css"],import.meta.url)),{Header:ro,Footer:oo,Sider:lo,Content:co}=at,et=230;function uo(t){const s=be(),[a,i]=ne.useMessage(),{engineStatus:n,setEngineState:l,computed:{isCompiling:c}}=ts(),[u,p]=o.useState(null),{setVersion:v}=_t(),[b,m]=o.useState(!1),[_,k]=o.useState(),[N,E]=o.useState(!1),[S,j]=o.useState(!1),[P,H]=o.useState(!1),g=o.useRef(),{addNotification:I,removeByTag:R,clear:D}=ct(),A={datasource:s.formatMessage({id:"C5D7TM",defaultMessage:[{type:0,value:"数据源"}]}),operation:s.formatMessage({id:"xwEc8K",defaultMessage:[{type:0,value:"API"}]}),teamwork:s.formatMessage({id:"5PSP/z",defaultMessage:[{type:0,value:"团队"}]}),prismaDatasource:s.formatMessage({id:"1t+raV",defaultMessage:[{type:0,value:"Prisma数据源"}]})},[V,d]=o.useState({visible:!1,currentPath:"",config:{}}),[O,$]=o.useState(""),[Q,J]=o.useState(!1),[le,f]=Ls({api:!1,auth:!1,dataSource:!1,storage:!1}),{setLogs:M,logs:r,questions:x,setQuestions:y}=os(h=>({logs:h.logs,setLogs:h.setLogs,questions:h.questions,setQuestions:h.setQuestions})),C=o.useMemo(()=>({[ae.Authentication]:s.formatMessage({id:"OJbZDt",defaultMessage:[{type:0,value:"身份认证"}]}),[ae.Configuration]:s.formatMessage({id:"xE1H+X",defaultMessage:[{type:0,value:"设置"}]}),[ae.DataSource]:s.formatMessage({id:"C5D7TM",defaultMessage:[{type:0,value:"数据源"}]}),[ae.Operation]:s.formatMessage({id:"xwEc8K",defaultMessage:[{type:0,value:"API"}]}),[ae.Role]:s.formatMessage({id:"/F5ua7",defaultMessage:[{type:0,value:"角色管理"}]}),[ae.SDK]:s.formatMessage({id:"pCG/0m",defaultMessage:[{type:0,value:"钩子模板"}]}),[ae.Storage]:s.formatMessage({id:"E6yn6S",defaultMessage:[{type:0,value:"文件存储"}]})}),[s]),F=o.useMemo(()=>({[ae.Authentication]:"/auth/{name}",[ae.Configuration]:"/setting",[ae.DataSource]:"/data-source/{name}",[ae.Operation]:"/apimanage/{name}",[ae.Role]:"/auth/role/role",[ae.SDK]:"/sdk-template",[ae.Storage]:"/storage/{name}"}),[]),oe=vt();function ce({time:h,status:z}){let xe="not_started";z===200?xe="running":z===500&&(xe="stopped"),l({hookStatus:xe,hookStartTime:h})}o.useEffect(()=>{Ds(oe??"")},[oe]),ye("engine","pull",h=>{v({fbVersion:h.fbVersion??"",fbCommit:h.fbCommit??""}),l(h),h.engineStatus===me.Started&&Oe.emit({event:"compileFinish",value:{first:!0}})}),ye("engine","push",h=>{l({engineStatus:h.engineStatus,engineStartTime:h.engineStartTime}),h.engineStatus===me.Started&&(Ce({channel:"question",event:"pull"}),Ee(),st(),Oe.emit({event:"compileFinish"}))}),ye("hookReport","pull",ce),ye("hookReport","push",ce),ye("log","pull",h=>{M(zt(h))}),ye("log","push",h=>{M(r.concat(zt([h])))}),ye("question","pull",h=>{R("question"),y(h||[]),h!=null&&h.length&&I({tag:"question",title:s.formatMessage({id:"B/j4Mh",defaultMessage:[{type:0,value:"构建中存在"},{type:1,value:"count"},{type:0,value:"条问题， 请检查"}]},{count:h.length}),buttons:[{label:e.jsx(w,{id:"cDZ00w",defaultMessage:[{type:0,value:"查看"}]}),handler:()=>{m(!0),k("1")},type:"primary"}]})}),ye("question","push",h=>{y([...x,h]),I({tag:"question-detail",title:h.msg,source:`${C[h.model]}[${h.name}]`,type:h.model===ae.DataSource?"error":"warning",buttons:[{label:e.jsx(w,{id:"vR0fTF",defaultMessage:[{type:0,value:"前往查看"}]}),handler:()=>{L(`/workbench${F[h.model].replace("{name}",h.name)}`)},type:"primary"}]})}),ye("license","pull",h=>{p(h)}),ye("license","push",h=>{a.error(e.jsxs("div",{className:"inline-flex flex-col items-start",children:[e.jsx("div",{children:h.msg}),e.jsx("div",{children:e.jsx(w,{id:"ydOjls",defaultMessage:[{type:0,value:"当前"},{type:1,value:"model"},{type:0,value:"超出"},{type:1,value:"limit"},{type:0,value:"的限制"}],values:{model:A[h.data.function],limit:h.data.limits}})}),e.jsxs("div",{children:[e.jsx(w,{id:"TanXXK",defaultMessage:[{type:0,value:"请访问"}]}),e.jsx("a",{className:"mx-1",href:h.data.contractAddress,target:"_blank",rel:"noreferrer",children:h.data.contractAddress}),e.jsx(w,{id:"a4KYcJ",defaultMessage:[{type:0,value:"获取商业授权"}]})]}),e.jsx("div",{className:"mt-2 flex w-full",children:e.jsx(qe,{size:"small",type:"primary",className:"ml-auto",onClick:()=>a.destroy(),children:s.formatMessage({id:"r1IImU",defaultMessage:[{type:0,value:"知道了"}]})})})]}),0),Ce({channel:"license",event:"pull"})}),o.useEffect(()=>{Ce({channel:"engine",event:"pull"}),Ce({channel:"hookReport",event:"pull"}),Ce({channel:"log",event:"pull"}),Ce({channel:"question",event:"pull"}),Ce({channel:"license",event:"pull"})},[]),o.useEffect(()=>{const h=new AbortController;return new Headers().set("X-FB-Authentication",vt()??""),()=>{h.abort()}},[P]),o.useEffect(()=>{n===me.Building&&(y([]),M([]))},[n,M,y]);const he=h=>{f(z=>{z[h]=!z[h]})},ie=h=>{J(h)},{modal:de}=Yt.useApp(),Te=o.useCallback(async()=>Q?await new Promise(h=>{de.confirm({title:s.formatMessage({id:"5gzWCE",defaultMessage:[{type:0,value:"即将离开当前页面，未保存的内容将被丢失，是否确认？"}]}),onOk:()=>{J(!1),h(!0)},onCancel:()=>h(!1)})}):!0,[Q,s,de]),se=o.useCallback(async(h,z)=>{var ee;const re=(ee=(await Ut.get(`${h}/auth/cookie/user/logout`,{headers:Ps(),params:{logout_openid_connect_provider:(z==null?void 0:z.logoutProvider)??!0},withCredentials:!0})).data)==null?void 0:ee.redirect;if(re){const K=document.createElement("iframe");K.src=re,document.body.appendChild(K),setTimeout(()=>{document.body.removeChild(K)},5e3)}((z==null?void 0:z.closeWindow)??!0)&&(ne.info(s.formatMessage({id:"7xvRgU",defaultMessage:[{type:0,value:"登出成功，即将关闭当前页面"}]})),setTimeout(()=>{window.close()},3e3))},[s]),pe=e.jsxs(at,{className:`h-100vh ${Xe.workbench}`,children:[!S&&e.jsx(ro,{className:Xe.header,children:e.jsx(ai,{onToggleSider:()=>E(!N),isCompiling:c})}),e.jsxs(at,{children:[e.jsx(lo,{width:et,style:{marginLeft:N||S?-1*et:0},theme:"light",className:Xe.sider,children:e.jsx(Or,{})}),e.jsxs(at,{className:"relative",children:[e.jsx(co,{className:"bg-[#FBFBFB]",children:t.children}),b?e.jsx(o.Suspense,{children:e.jsx(io,{style:{left:0,right:0,bottom:0},toggleWindow:()=>m(!b),defaultTab:_})}):e.jsx(e.Fragment,{})]})]}),!S&&e.jsx(oo,{className:Xe.footer,children:e.jsx(ao,{license:u,menuWidth:S?0:et,toggleWindow:h=>{k(h),m(!b)}})})]}),Ne=Re(),L=$e(),{data:T}=yt("/sdk/enabledServer",B),{data:Y,mutate:W}=yt("/sdk",B.get),ue=T==null?void 0:T.language,_e=(!!ue&&(Y==null?void 0:Y.some(h=>h.type==="server")))??!1,U=async(h,z=!1,xe=!1)=>{try{if(!_e)return L("/workbench/sdk-template"),ne.warning(s.formatMessage({id:"PbJmb7",defaultMessage:[{type:0,value:"请选择钩子模版"}]})),!1;let re=T!=null&&T.extension&&h.includes(T.extension)?h:`${h}.${T==null?void 0:T.extension.replace(/^\./,"")}`.replace(/^\//,"");if(T!=null&&T.upperFirst){const K=re.split("/"),Ie=K[K.length-1];re=`${K.slice(0,K.length-1).join("/")}/${Ie[0].toUpperCase()}${Ie.slice(1)}`}let ee=!1;try{await B.get(`/vscode/state?uri=${re}`,{ignoreError:!0}),ee=!0}catch{}if(!ee){if(!xe&&(!await new Promise(Ke=>{de.confirm({title:s.formatMessage({id:"73X0pe",defaultMessage:[{type:0,value:"钩子脚本不存在，是否创建？"}]}),onOk:()=>Ke(!0),onCancel:()=>Ke(!1),zIndex:99999})})||!ue))return!1;$("钩子模板创建中，请稍候");const K=await pn(re,T);return await qs(re,K),!0}return!0}catch(re){return $(""),console.error(re),!1}finally{$("")}},X={vscode:{options:V,isHookServerSelected:_e,checkHookExist:U,toggleOperationHook:async(h,z,xe,re=!1)=>{h&&!await U(z,re)||(z.match(/custom-\w+\/global\//)?await qa(z.split("/").pop(),h):await Ha(xe,z.split("/").pop(),h))},hide:()=>{d({visible:!1,currentPath:"",config:{}})},show:async(h,z)=>h&&!await U(h??"")?!1:(d({visible:!0,currentPath:h??"",config:z??{}}),!0)}};return Ne.pathname.match(/^\/workbench\/modeling($|\/)/)?e.jsxs(o.Suspense,{children:[i,e.jsx(He.Provider,{value:X,children:e.jsx(Et,{tip:O,spinning:!!O,children:e.jsx(no,{children:pe})})})]}):e.jsxs(He.Provider,{value:X,children:[i,e.jsx(Et,{tip:O,spinning:!!O,children:e.jsx(Ue.Provider,{value:{engineStatus:n,triggerPageEvent:h=>{var z;(z=g.current)==null||z.call(g,h)},registerPageListener:h=>{g.current=h},refreshMap:le,onRefreshMenu:he,onRefreshState:()=>H(!P),editFlag:Q,markEdit:ie,navCheck:Te,setFullscreen:j,isFullscreen:S,menuWidth:S?0:et,setHideSide:E,isHideSide:N,logout:se},children:pe})})]})}function zt(t){const s=[];let a;return t==null||t.forEach(i=>{const[,n,l,c]=i.match(/([\d\w-:.+]+) (\w+) (.*)/)||[];n?(a={time:Le(n).format("YYYY-MM-DD HH:mm:ss"),level:l,msg:c},s.push(a)):a&&(a.msg+=`
`+i.trim())}),s}function fo(){const{globalSetting:t}=o.useContext(Wt);return t?e.jsx(uo,{children:e.jsx(o.Suspense,{children:e.jsx(Bs,{})})}):null}const Wo=Object.freeze(Object.defineProperty({__proto__:null,default:fo},Symbol.toStringTag,{value:"Module"}));export{ae as Q,os as u,Wo as w};
