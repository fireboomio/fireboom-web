import{j as a,a2 as k,K as g,X as j,u as y,r as p,a4 as N,l as b,k as C,V as M,a7 as P}from"./index-8780653b.js";import{s as x,P as S}from"./Form-bb5e0fb9.js";import"./index-b7a6f56d.js";import"./fireBoomConstants-acaaa4c8.js";import"./globalContext-587dec34.js";import"./utils-9b986f1e.js";import"./index-5009d2f3.js";import"./index-803510a7.js";import"./DownOutlined-e74f9fb1.js";import"./index-34f891b2.js";import"./useShowArrow-d3943229.js";import"./index-1f0152ff.js";import"./PurePanel-bb693965.js";const U=""+new URL("tabClose-56d8c3de.svg",import.meta.url).href,E="_listWrapper_dxn18_1",W="_list_dxn18_1",w="_item_dxn18_14",R="_label_dxn18_39",T="_active_dxn18_43",$="_close_dxn18_59",m={listWrapper:E,list:W,item:w,label:R,active:T,close:$};function K({activeKey:d,items:s,onClick:o,onClose:u}){return a.jsx("div",{className:m.listWrapper,children:a.jsx("div",{className:m.list,children:s.map((n,f)=>a.jsxs("div",{className:k(m.item,{[m.active]:n.label===d}),onClick:()=>o(n),children:[n.label,s.length>1&&a.jsx("div",{className:m.close,onClick:c=>{c.stopPropagation(),u(n)},children:a.jsx("img",{src:U,alt:""})})]},f))})})}function Q(){const d=g(),{name:s,profile:o}=j(),u=y(),n=p.useRef(),[f,c]=p.useState([]),t=N();p.useEffect(()=>{n.current!==s?(n.current=s,c([{key:o,label:o}])):c(e=>{e=b.cloneDeep(e),e.find(l=>l.key===o)||e.push({key:o,label:o});const i=t==null?void 0:t.find(l=>l.name===s);return e=e.filter(l=>{var v;return(v=i==null?void 0:i.uploadProfiles)==null?void 0:v[l.key]}),e})},[s,o,t]);const _=p.useMemo(()=>t==null?void 0:t.find(e=>e.name===s),[t,s]),r=p.useMemo(()=>{var i;const e=t==null?void 0:t.find(l=>l.name===s);if(e)return(i=e.uploadProfiles)==null?void 0:i[o??""]},[t,o,s]),h=async e=>{await C.put("/storage",{name:s,uploadProfiles:{[o]:e}}),M.success(d.formatMessage({id:"jhfb/7",defaultMessage:[{type:0,value:"保存成功"}]})),P(),(r==null?void 0:r.hooks.preUpload)!=e.hooks.preUpload,(r==null?void 0:r.hooks.postUpload)!=e.hooks.postUpload};return r?a.jsxs("div",{className:x.container,children:[a.jsx(K,{activeKey:o,onClick:e=>{u(`/workbench/storage/${s}/profile/${e.key}`)},items:f,onClose:e=>{c(i=>i.filter(l=>l.key!==e.key))}}),a.jsxs("div",{className:x.content,children:[a.jsx("div",{className:x.title,children:d.formatMessage({id:"V5pGxT",defaultMessage:[{type:0,value:"基本设置"}]})}),a.jsx(S,{storageName:_.name,onSave:h,profile:r})]})]}):null}export{Q as default};
