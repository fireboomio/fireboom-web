import{r as l,e as q,f as C,c as Fe,aU as De,aV as Ge,d as u,cX as I,ch as re,cl as He,o as We,dR as Ie,Y as oe,a3 as k,V as B,aH as O,k as E,j as r,ad as ie,Q as A,bS as H,aq as W,K as ne,dS as le,n as Ke,g as _e,p as Ue}from"./index-b9538a36.js";import{c as Ve}from"./index-f01bf8c9.js";import{E as qe}from"./50x-fe3b56a2.js";import{u as Xe}from"./lock-e4252514.js";import{a as Ze,u as Je}from"./ServiceDiscovery-9e98afc1.js";import{M as Ye}from"./index-a84071ae.js";import{S as Qe}from"./index-dc228f7a.js";import{T as ke}from"./index-be20a5c5.js";import{D as G}from"./index-6f3ba64a.js";import{E as ee}from"./index-7b67667e.js";import{P as et}from"./index-08691016.js";import{S as tt}from"./index-75fcc628.js";import{D as at}from"./index-7f866bdb.js";import{C as st}from"./CopyOutlined-03c410ea.js";import{E as rt}from"./EditFilled-7d4aa699.js";import"./index-203ea36e.js";import"./addEventListener-bdc90ae8.js";import"./LeftOutlined-293b2d04.js";import"./PurePanel-44ecf6ba.js";import"./PlusOutlined-8f251d18.js";import"./useBreakpoint-9fb81576.js";import"./useForceUpdate-f9bdae06.js";import"./index-bdc58452.js";import"./index-d6e19d2c.js";var ot=globalThis&&globalThis.__rest||function(e,a){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)a.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(t[s[o]]=e[s[o]]);return t};const it=e=>{var{prefixCls:a,className:t,hoverable:s=!0}=e,o=ot(e,["prefixCls","className","hoverable"]);const{getPrefixCls:n}=l.useContext(q),i=n("card",a),d=C(`${i}-grid`,t,{[`${i}-grid-hoverable`]:s});return l.createElement("div",Object.assign({},o,{className:d}))},ce=it,nt=e=>{const{antCls:a,componentCls:t,headerHeight:s,cardPaddingBase:o,tabsMarginBottom:n}=e;return Object.assign(Object.assign({display:"flex",justifyContent:"center",flexDirection:"column",minHeight:s,marginBottom:-1,padding:`0 ${u(o)}`,color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.headerFontSize,background:e.headerBg,borderBottom:`${u(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`,borderRadius:`${u(e.borderRadiusLG)} ${u(e.borderRadiusLG)} 0 0`},I()),{"&-wrapper":{width:"100%",display:"flex",alignItems:"center"},"&-title":Object.assign(Object.assign({display:"inline-block",flex:1},re),{[`
          > ${t}-typography,
          > ${t}-typography-edit-content
        `]:{insetInlineStart:0,marginTop:0,marginBottom:0}}),[`${a}-tabs-top`]:{clear:"both",marginBottom:n,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,"&-bar":{borderBottom:`${u(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`}}})},lt=e=>{const{cardPaddingBase:a,colorBorderSecondary:t,cardShadow:s,lineWidth:o}=e;return{width:"33.33%",padding:a,border:0,borderRadius:0,boxShadow:`
      ${u(o)} 0 0 0 ${t},
      0 ${u(o)} 0 0 ${t},
      ${u(o)} ${u(o)} 0 0 ${t},
      ${u(o)} 0 0 0 ${t} inset,
      0 ${u(o)} 0 0 ${t} inset;
    `,transition:`all ${e.motionDurationMid}`,"&-hoverable:hover":{position:"relative",zIndex:1,boxShadow:s}}},ct=e=>{const{componentCls:a,iconCls:t,actionsLiMargin:s,cardActionsIconSize:o,colorBorderSecondary:n,actionsBg:i}=e;return Object.assign(Object.assign({margin:0,padding:0,listStyle:"none",background:i,borderTop:`${u(e.lineWidth)} ${e.lineType} ${n}`,display:"flex",borderRadius:`0 0 ${u(e.borderRadiusLG)} ${u(e.borderRadiusLG)}`},I()),{"& > li":{margin:s,color:e.colorTextDescription,textAlign:"center","> span":{position:"relative",display:"block",minWidth:e.calc(e.cardActionsIconSize).mul(2).equal(),fontSize:e.fontSize,lineHeight:e.lineHeight,cursor:"pointer","&:hover":{color:e.colorPrimary,transition:`color ${e.motionDurationMid}`},[`a:not(${a}-btn), > ${t}`]:{display:"inline-block",width:"100%",color:e.colorTextDescription,lineHeight:u(e.fontHeight),transition:`color ${e.motionDurationMid}`,"&:hover":{color:e.colorPrimary}},[`> ${t}`]:{fontSize:o,lineHeight:u(e.calc(o).mul(e.lineHeight).equal())}},"&:not(:last-child)":{borderInlineEnd:`${u(e.lineWidth)} ${e.lineType} ${n}`}}})},dt=e=>Object.assign(Object.assign({margin:`${u(e.calc(e.marginXXS).mul(-1).equal())} 0`,display:"flex"},I()),{"&-avatar":{paddingInlineEnd:e.padding},"&-detail":{overflow:"hidden",flex:1,"> div:not(:last-child)":{marginBottom:e.marginXS}},"&-title":Object.assign({color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeLG},re),"&-description":{color:e.colorTextDescription}}),mt=e=>{const{componentCls:a,cardPaddingBase:t,colorFillAlter:s}=e;return{[`${a}-head`]:{padding:`0 ${u(t)}`,background:s,"&-title":{fontSize:e.fontSize}},[`${a}-body`]:{padding:`${u(e.padding)} ${u(t)}`}}},ut=e=>{const{componentCls:a}=e;return{overflow:"hidden",[`${a}-body`]:{userSelect:"none"}}},gt=e=>{const{antCls:a,componentCls:t,cardShadow:s,cardHeadPadding:o,colorBorderSecondary:n,boxShadowTertiary:i,cardPaddingBase:d,extraColor:c}=e;return{[t]:Object.assign(Object.assign({},Ge(e)),{position:"relative",background:e.colorBgContainer,borderRadius:e.borderRadiusLG,[`&:not(${t}-bordered)`]:{boxShadow:i},[`${t}-head`]:nt(e),[`${t}-extra`]:{marginInlineStart:"auto",color:c,fontWeight:"normal",fontSize:e.fontSize},[`${t}-body`]:Object.assign({padding:d,borderRadius:`0 0 ${u(e.borderRadiusLG)} ${u(e.borderRadiusLG)}`},I()),[`${t}-grid`]:lt(e),[`${t}-cover`]:{"> *":{display:"block",width:"100%"},[`img, img + ${a}-image-mask`]:{borderRadius:`${u(e.borderRadiusLG)} ${u(e.borderRadiusLG)} 0 0`}},[`${t}-actions`]:ct(e),[`${t}-meta`]:dt(e)}),[`${t}-bordered`]:{border:`${u(e.lineWidth)} ${e.lineType} ${n}`,[`${t}-cover`]:{marginTop:-1,marginInlineStart:-1,marginInlineEnd:-1}},[`${t}-hoverable`]:{cursor:"pointer",transition:`box-shadow ${e.motionDurationMid}, border-color ${e.motionDurationMid}`,"&:hover":{borderColor:"transparent",boxShadow:s}},[`${t}-contain-grid`]:{borderRadius:`${u(e.borderRadiusLG)} ${u(e.borderRadiusLG)} 0 0 `,[`${t}-body`]:{display:"flex",flexWrap:"wrap"},[`&:not(${t}-loading) ${t}-body`]:{marginBlockStart:e.calc(e.lineWidth).mul(-1).equal(),marginInlineStart:e.calc(e.lineWidth).mul(-1).equal(),padding:0}},[`${t}-contain-tabs`]:{[`> div${t}-head`]:{minHeight:0,[`${t}-head-title, ${t}-extra`]:{paddingTop:o}}},[`${t}-type-inner`]:mt(e),[`${t}-loading`]:ut(e),[`${t}-rtl`]:{direction:"rtl"}}},pt=e=>{const{componentCls:a,cardPaddingSM:t,headerHeightSM:s,headerFontSizeSM:o}=e;return{[`${a}-small`]:{[`> ${a}-head`]:{minHeight:s,padding:`0 ${u(t)}`,fontSize:o,[`> ${a}-head-wrapper`]:{[`> ${a}-extra`]:{fontSize:e.fontSize}}},[`> ${a}-body`]:{padding:t}},[`${a}-small${a}-contain-tabs`]:{[`> ${a}-head`]:{[`${a}-head-title, ${a}-extra`]:{paddingTop:0,display:"flex",alignItems:"center"}}}}},ht=e=>({headerBg:"transparent",headerFontSize:e.fontSizeLG,headerFontSizeSM:e.fontSize,headerHeight:e.fontSizeLG*e.lineHeightLG+e.padding*2,headerHeightSM:e.fontSize*e.lineHeight+e.paddingXS*2,actionsBg:e.colorBgContainer,actionsLiMargin:`${e.paddingSM}px 0`,tabsMarginBottom:-e.padding-e.lineWidth,extraColor:e.colorText}),ft=Fe("Card",e=>{const a=De(e,{cardShadow:e.boxShadowCard,cardHeadPadding:e.padding,cardPaddingBase:e.paddingLG,cardActionsIconSize:e.fontSize,cardPaddingSM:12});return[gt(a),pt(a)]},ht);var te=globalThis&&globalThis.__rest||function(e,a){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)a.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(t[s[o]]=e[s[o]]);return t};const xt=e=>{const{actionClasses:a,actions:t=[],actionStyle:s}=e;return l.createElement("ul",{className:a,style:s},t.map((o,n)=>{const i=`action-${n}`;return l.createElement("li",{style:{width:`${100/t.length}%`},key:i},l.createElement("span",null,o))}))},bt=l.forwardRef((e,a)=>{const{prefixCls:t,className:s,rootClassName:o,style:n,extra:i,headStyle:d={},bodyStyle:c={},title:j,loading:S,bordered:b=!0,size:$,type:w,cover:P,actions:h,tabList:m,children:f,activeTabKey:N,defaultActiveTabKey:Z,tabBarExtraContent:ue,hoverable:ge,tabProps:pe={},classNames:K,styles:_}=e,he=te(e,["prefixCls","className","rootClassName","style","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps","classNames","styles"]),{getPrefixCls:fe,direction:xe,card:y}=l.useContext(q),be=x=>{var g;(g=e.onTabChange)===null||g===void 0||g.call(e,x)},T=x=>{var g;return C((g=y==null?void 0:y.classNames)===null||g===void 0?void 0:g[x],K==null?void 0:K[x])},z=x=>{var g;return Object.assign(Object.assign({},(g=y==null?void 0:y.styles)===null||g===void 0?void 0:g[x]),_==null?void 0:_[x])},ye=l.useMemo(()=>{let x=!1;return l.Children.forEach(f,g=>{g&&g.type&&g.type===ce&&(x=!0)}),x},[f]),p=fe("card",t),[ve,je,Se]=ft(p),$e=l.createElement(Ie,{loading:!0,active:!0,paragraph:{rows:4},title:!1},f),J=N!==void 0,Ce=Object.assign(Object.assign({},pe),{[J?"activeKey":"defaultActiveKey"]:J?N:Z,tabBarExtraContent:ue});let Y;const L=He($),Me=!L||L==="default"?"large":L,Q=m?l.createElement(ke,Object.assign({size:Me},Ce,{className:`${p}-head-tabs`,onChange:be,items:m.map(x=>{var{tab:g}=x,U=te(x,["tab"]);return Object.assign({label:g},U)})})):null;if(j||i||Q){const x=C(`${p}-head`,T("header")),g=C(`${p}-head-title`,T("title")),U=C(`${p}-extra`,T("extra")),Le=Object.assign(Object.assign({},d),z("header"));Y=l.createElement("div",{className:x,style:Le},l.createElement("div",{className:`${p}-head-wrapper`},j&&l.createElement("div",{className:g,style:z("title")},j),i&&l.createElement("div",{className:U,style:z("extra")},i)),Q)}const we=C(`${p}-cover`,T("cover")),Ne=P?l.createElement("div",{className:we,style:z("cover")},P):null,Ae=C(`${p}-body`,T("body")),Oe=Object.assign(Object.assign({},c),z("body")),Be=l.createElement("div",{className:Ae,style:Oe},S?$e:f),Ee=C(`${p}-actions`,T("actions")),Te=h&&h.length?l.createElement(xt,{actionClasses:Ee,actionStyle:z("actions"),actions:h}):null,ze=We(he,["onTabChange"]),Re=C(p,y==null?void 0:y.className,{[`${p}-loading`]:S,[`${p}-bordered`]:b,[`${p}-hoverable`]:ge,[`${p}-contain-grid`]:ye,[`${p}-contain-tabs`]:m&&m.length,[`${p}-${L}`]:L,[`${p}-type-${w}`]:!!w,[`${p}-rtl`]:xe==="rtl"},s,o,je,Se),Pe=Object.assign(Object.assign({},y==null?void 0:y.style),n);return ve(l.createElement("div",Object.assign({ref:a},ze,{className:Re,style:Pe}),Y,Ne,Be,Te))}),yt=bt;var vt=globalThis&&globalThis.__rest||function(e,a){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)a.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(t[s[o]]=e[s[o]]);return t};const jt=e=>{const{prefixCls:a,className:t,avatar:s,title:o,description:n}=e,i=vt(e,["prefixCls","className","avatar","title","description"]),{getPrefixCls:d}=l.useContext(q),c=d("card",a),j=C(`${c}-meta`,t),S=s?l.createElement("div",{className:`${c}-meta-avatar`},s):null,b=o?l.createElement("div",{className:`${c}-meta-title`},o):null,$=n?l.createElement("div",{className:`${c}-meta-description`},n):null,w=b||$?l.createElement("div",{className:`${c}-meta-detail`},b,$):null;return l.createElement("div",Object.assign({},i,{className:j}),S,w)},St=jt,X=yt;X.Grid=ce;X.Meta=St;const de=X;var D={};D.byteLength=Mt;D.toByteArray=Nt;D.fromByteArray=Bt;var M=[],v=[],$t=typeof Uint8Array<"u"?Uint8Array:Array,V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var R=0,Ct=V.length;R<Ct;++R)M[R]=V[R],v[V.charCodeAt(R)]=R;v["-".charCodeAt(0)]=62;v["_".charCodeAt(0)]=63;function me(e){var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");t===-1&&(t=a);var s=t===a?0:4-t%4;return[t,s]}function Mt(e){var a=me(e),t=a[0],s=a[1];return(t+s)*3/4-s}function wt(e,a,t){return(a+t)*3/4-t}function Nt(e){var a,t=me(e),s=t[0],o=t[1],n=new $t(wt(e,s,o)),i=0,d=o>0?s-4:s,c;for(c=0;c<d;c+=4)a=v[e.charCodeAt(c)]<<18|v[e.charCodeAt(c+1)]<<12|v[e.charCodeAt(c+2)]<<6|v[e.charCodeAt(c+3)],n[i++]=a>>16&255,n[i++]=a>>8&255,n[i++]=a&255;return o===2&&(a=v[e.charCodeAt(c)]<<2|v[e.charCodeAt(c+1)]>>4,n[i++]=a&255),o===1&&(a=v[e.charCodeAt(c)]<<10|v[e.charCodeAt(c+1)]<<4|v[e.charCodeAt(c+2)]>>2,n[i++]=a>>8&255,n[i++]=a&255),n}function At(e){return M[e>>18&63]+M[e>>12&63]+M[e>>6&63]+M[e&63]}function Ot(e,a,t){for(var s,o=[],n=a;n<t;n+=3)s=(e[n]<<16&16711680)+(e[n+1]<<8&65280)+(e[n+2]&255),o.push(At(s));return o.join("")}function Bt(e){for(var a,t=e.length,s=t%3,o=[],n=16383,i=0,d=t-s;i<d;i+=n)o.push(Ot(e,i,i+n>d?d:i+n));return s===1?(a=e[t-1],o.push(M[a>>2]+M[a<<4&63]+"==")):s===2&&(a=(e[t-2]<<8)+e[t-1],o.push(M[a>>10]+M[a>>4&63]+M[a<<2&63]+"=")),o.join("")}const Et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAXVBMVEUAAAD29v/19vj09vj09vj19fj19fj19fj19fj29vj09vgzMzPv8PKhoqOFhYZmZmZCQkLCw8Xx8vTr7O7Nzs/AwcO2t7ioqKqcnZ6VlZZ2dnd0dHVVVVVGRkc9PT2jobaUAAAACnRSTlMAG/Py2baba05un7UgfgAAAJJJREFUKM91UtcSwzAIA8cjEV3p3v//mb32HMolRk/WyRZGQBVcUgwhpsJkwRmKbKS+g0HXU8WAGYZ6v9LVZjvW4+8NTz5rkd3k9q2TsRSQiRj4W52UMBU0USi1hUTRWo1KIgW0iiO4gmvlFne/axo8PJ5nJWwiuYq8NRIb4kXkpSHa2Pe3+1Fj9wblj9ZfBnd9Pk2YEmQ3bGOFAAAAAElFTkSuQmCC",Tt="_download_gb3yo_1",zt="_remoteCard_gb3yo_10",Rt="_icon_gb3yo_13",Pt="_btn_gb3yo_24",Lt="_descLine_gb3yo_35",F={download:Tt,remoteCard:zt,icon:Rt,btn:Pt,descLine:Lt},Ft=({sdks:e,onUpdate:a,actionRef:t})=>{const{getRepositoryUrl:s}=Ze(),{initialize:o}=oe(),[n,i]=l.useState(!1),{data:d,isValidating:c,error:j,mutate:S}=Je("sdks.json"),{remoteServer:b,remoteClient:$}=l.useMemo(()=>{const m=[],f=[];return d!=null&&d.official&&d.official.forEach(N=>{N.type==="server"?m.push(N):f.push(N)}),{remoteServer:m,remoteClient:f}},[d]),w=l.useMemo(()=>new Set((e==null?void 0:e.map(m=>m.dirName))??[]),[e]),{loading:P,fun:h}=Xe(async m=>{const f=s(m.gitUrl),N=B.loading(O.formatMessage({id:"/cqdKk",defaultMessage:[{type:0,value:"下载"}]}),-1);try{await E.post("/sdk",{...m,gitUrl:f}),a(),o(),k("/sdk/enabledServer"),B.success(O.formatMessage({id:"WJWR3q",defaultMessage:[{type:0,value:"下载成功"}]}))}catch{B.error(O.formatMessage({id:"eJ2viL",defaultMessage:[{type:0,value:"下载失败"}]}))}N()},[k]);return l.useEffect(()=>{t&&(t.current={show:()=>{i(!0),S()}})},[t,S]),r.jsxs(Ye,{width:"80vw",footer:null,open:n,onCancel:()=>i(!1),title:r.jsx("div",{className:"text-center",children:O.formatMessage({id:"DAKKuk",defaultMessage:[{type:0,value:"模版市场"}]})}),styles:{body:{minHeight:"60vh"}},children:[c?r.jsx("div",{className:"flex h-40vh w-full items-center justify-center",children:r.jsx(Qe,{tip:"Loading",size:"large"})}):null,!c&&j?r.jsxs("div",{className:"flex flex-col h-40vh w-full items-center justify-center",children:[r.jsx(qe,{}),r.jsx(ie,{onClick:()=>{S()},children:O.formatMessage({id:"pR5Kts",defaultMessage:[{type:0,value:"重试"}]})})]}):null,!c&&!j&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs  mb-4 text-[#666]",children:r.jsx(A,{id:"p5GCek",defaultMessage:[{type:0,value:"钩子模版"}]})}),r.jsx(H,{className:"",gutter:[32,32],children:b==null?void 0:b.map((m,f)=>r.jsx(W,{xl:8,xxl:6,md:12,children:r.jsx(ae,{exist:w.has(m.name),sdk:m,onSelect:()=>{h(m)}})},f))}),r.jsx("div",{className:"text-xs  mb-4 mt-8 text-[#666]",children:r.jsx(A,{id:"gRp6eK",defaultMessage:[{type:0,value:"客户端模版"}]})}),r.jsx(H,{className:"",gutter:[32,32],children:$==null?void 0:$.map((m,f)=>r.jsx(W,{xl:8,xxl:6,md:12,children:r.jsx(ae,{exist:w.has(m.name),sdk:m,onSelect:()=>{h(m)}})},f))})]})]})},ae=({onSelect:e,sdk:a,exist:t})=>{const s=ne();return r.jsxs(de,{title:r.jsxs("div",{className:"flex items-center",children:[r.jsx("img",{alt:"",className:F.icon,src:a.icon.startsWith("http")?a.icon:`data:image/svg+xml;base64,${D.fromByteArray(new TextEncoder().encode(`${a.icon}`))}`}),a.title]}),className:F.remoteCard,extra:t?r.jsx("div",{className:"text-[#787D8B]",children:"已下载"}):null,children:[r.jsxs(G,{size:"small",column:1,labelStyle:{width:100},contentStyle:{color:"#787D8B"},children:[r.jsx(G.Item,{label:s.formatMessage({id:"jiM9+b",defaultMessage:[{type:0,value:"模板ID"}]}),children:a.name}),r.jsx(G.Item,{label:s.formatMessage({id:"Ph2Nn+",defaultMessage:[{type:0,value:"功能描述"}]}),children:r.jsx("div",{className:F.descLine,children:a.description})}),r.jsx(G.Item,{label:s.formatMessage({id:"Zlo7bL",defaultMessage:[{type:0,value:"生成路径"}]}),children:a.outputPath})]}),t?null:r.jsx("div",{className:F.download,children:r.jsx("div",{className:F.btn,onClick:e,children:"点击下载"})})]})},ca=()=>{const{data:e,mutate:a}=le("/sdk",E.get),t=l.useRef(),{server:s,client:o}=l.useMemo(()=>{const i=[],d=[];return e&&e.forEach(c=>{c.type==="server"?i.push(c):d.push(c)}),{server:i,client:d}},[e]),n=(i,d)=>{a([...e.slice(0,i-2),d,...e.slice(i-1)])};return r.jsxs(de,{children:[r.jsxs("div",{className:"flex mb-4 items-center",children:[r.jsx("div",{className:"text-base t-medium",children:r.jsx(A,{id:"hw2IgW",defaultMessage:[{type:0,value:"模版仓库"}]})}),r.jsx("div",{className:"flex-1"}),r.jsx(ie,{onClick:()=>{var i;(i=t.current)==null||i.show()},children:O.formatMessage({id:"t9OiGA",defaultMessage:[{type:0,value:"浏览模版市场"}]})})]}),r.jsxs("div",{className:"flex mb-4 items-center",children:[r.jsx("div",{className:"text-xs text-[#666]",children:r.jsx(A,{id:"p5GCek",defaultMessage:[{type:0,value:"钩子模版"}]})}),r.jsx("div",{className:"text-xs ml-3 text-[#787D8B]",children:r.jsx(A,{id:"RKEnyl",defaultMessage:[{type:0,value:"（钩子同时只能开启一个，为toggle模式）"}]})})]}),r.jsxs(H,{className:"",gutter:[32,32],children:[s==null?void 0:s.map((i,d)=>r.jsx(W,{xl:8,xxl:6,md:12,children:r.jsx(se,{sdk:i,onChange:c=>n(d,c)})},i.name)),!(s!=null&&s.length)&&r.jsx(ee,{className:"m-auto",description:O.formatMessage({id:"cLNR9b",defaultMessage:[{type:0,value:"暂无模板"}]})})]}),r.jsx("div",{className:"flex mb-4 items-center mt-8",children:r.jsxs("div",{className:"text-xs text-[#666]",children:[r.jsx(A,{id:"gRp6eK",defaultMessage:[{type:0,value:"客户端模版"}]}),o.length&&r.jsxs("span",{className:"text-xs ml-3 text-[#787D8B]",children:["（",r.jsx("code",{className:"px-1 text-primary",children:"generated-sdk"}),r.jsx(A,{id:"bXiKzU",defaultMessage:[{type:0,value:"目录下生成的文件可以使用"}]}),r.jsxs("span",{className:"mx-1 text-primary cursor-pointer",onClick:()=>{Ve(`${window.location.origin}/generated-sdk`),B.success("已复制")},children:[window.location.origin,"/generated-sdk",r.jsx(st,{className:"ml-0.5 mr-1"})]}),r.jsx(A,{id:"J0Nrpk",defaultMessage:[{type:0,value:"加上文件路径访问"}]}),"）"]})]})}),r.jsxs(H,{className:"",gutter:[32,32],children:[o==null?void 0:o.map((i,d)=>r.jsx(W,{xl:8,xxl:6,md:12,children:r.jsx(se,{sdk:i,onChange:c=>n(d,c)})},d)),!(o!=null&&o.length)&&r.jsx(ee,{className:"m-auto",description:O.formatMessage({id:"7Mbp/s",defaultMessage:[{type:0,value:"暂无 模版"}]})})]}),r.jsx(Ft,{sdks:e??[],onUpdate:a,actionRef:t})]})};async function Dt(e){const a=e.gitUrl.match(/^https?:\/\/(.+)\/(.+\/.+)\.git/);if(a)try{const t=await Ue(`https://api.github.com/repos/${a[2]}/git/refs/heads/${e.gitBranch}`);return t&&t.object.sha!==e.gitCommitHash?{repo:a[2],localSha:e.gitCommitHash,remoteSha:t.object.sha}:!1}catch(t){console.error(t)}return!1}const se=({onChange:e,sdk:a})=>{const t=ne(),{mutate:s}=Ke(),[o,n]=l.useState(!1),[i,d]=l.useState(!1),[c,j]=l.useState(a.outputPath),{initialize:S}=oe(),{mutate:b}=le("/sdk",E.get),$=l.useCallback(h=>{const m=h.currentTarget.value;h.key==="Escape"?(j(a.outputPath),d(!1)):h.key==="Enter"&&E.put("/sdk",{name:a.name,outputPath:m}).then(f=>{console.log("res",f),e({...a,outputPath:m}),B.success(t.formatMessage({id:"jhfb/7",defaultMessage:[{type:0,value:"保存成功"}]}))})},[t,e,a]),w=l.useCallback(h=>{E.put("/sdk",{name:a.name,enabled:h}).then(m=>{b(),S(),s("/globalOperation/httpTransportHookOptions",void 0,{revalidate:!0}),s("/sdk/enabledServer")})},[S,b,a.name]),P=l.useMemo(()=>{const h=[{key:"delete",icon:"",label:r.jsx(et,{title:t.formatMessage({id:"nS8PfW",defaultMessage:[{type:0,value:"确定要删除?"}]}),okText:t.formatMessage({id:"r0/TUu",defaultMessage:[{type:0,value:"确定"}]}),cancelText:t.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]}),onConfirm:async()=>{await E.delete(`/sdk/${a.name}`),B.success(t.formatMessage({id:"aiBGBs",defaultMessage:[{type:0,value:"删除成功"}]})),b()},children:t.formatMessage({id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]})})},{key:"update",label:t.formatMessage({id:"iCvPMa",defaultMessage:[{type:0,value:"升级"}]}),onClick:async()=>{const m=B.loading(t.formatMessage({id:"GdhWnp",defaultMessage:[{type:0,value:"升级中"}]}));try{await E.put("/sdk",{name:a.name,gitCommitHash:"latest"}),B.success(t.formatMessage({id:"uG+OVa",defaultMessage:[{type:0,value:"升级成功"}]})),b()}finally{m()}}}];return a.enabled===!0&&h.push({key:"download",label:t.formatMessage({id:"4bLnOM",defaultMessage:[{type:0,value:"下载生成文件"}]}),onClick:async()=>{const m=_e();window.open(`/api/sdk/downloadOutput/${a.name}?${m?`&auth-key=${m}`:""}`)}}),h},[t,b,a]);return l.useEffect(()=>{Dt(a).then(n)},[a]),r.jsxs("div",{className:"bg-white rounded shadow p-4 hover:shadow-lg",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("img",{alt:"",className:"w-10 h-10 mr-2.5",src:a.icon.startsWith("http")?a.icon:`data:image/svg+xml;base64,${D.fromByteArray(new TextEncoder().encode(`${a.icon}`))}`}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-base t-medium",children:a.name}),o&&r.jsx("a",{className:"ml-4 text-primary italic border border-primary border-solid rounded px-1 py-0.5 leading-2 text-xs",href:`https://github.com/${o.repo}/compare/${o.localSha.substring(0,7)}..${o.remoteSha.substring(0,7)}`,target:"_blank",rel:"noreferrer",children:"new"})]}),r.jsxs("div",{className:"flex mt-1 items-center",children:[r.jsx("div",{className:"rounded-md bg-[#D8D8D8] h-2.5 shadow w-2.5"}),r.jsx("div",{className:"text-xs ml-1 text-[#5F6269]",children:a.author})]})]}),r.jsx(tt,{className:"flex-shrink-0",checked:a.enabled,onChange:w}),r.jsx(at,{menu:{items:P},trigger:["hover"],children:r.jsx("img",{alt:"",className:"cursor-pointer h-3 ml-2 w-3",src:Et})})]}),r.jsx("div",{className:"bg-[rgba(95,98,105,0.1)] h-0.5 mt-2 mb-3"}),r.jsxs("div",{className:"text-xs text-[#787D8B] line-clamp-2",children:[t.formatMessage({id:"Ph2Nn+",defaultMessage:[{type:0,value:"功能描述"}]}),"：",a.description||"-"]}),r.jsxs("div",{className:"flex h-8 mt-3 relative items-center",children:[r.jsxs("span",{className:"flex-shrink-0 text-xs text-[#787D8B] line-clamp-2",children:[t.formatMessage({id:"Zlo7bL",defaultMessage:[{type:0,value:"生成路径"}]}),"："]}),r.jsx("input",{value:c,readOnly:!i,className:"border rounded h-full outline-none border-[rgba(95,98,105,0.1)] text-sm w-full px-3 text-[#5F6269] focus:border-[rgba(95,98,105,0.8)]",onClick:()=>d(!0),onBlur:()=>d(!1),onKeyDown:$,onInput:h=>j(h.currentTarget.value)}),r.jsx(rt,{className:"cursor-pointer top-2 right-3 absolute",size:8})]})]})};export{ca as default};
