import{r as l,e as X,f as M,c as Fe,aU as De,aV as Ge,d as m,cX as I,ch as re,cl as He,o as Ie,dR as We,Y as ie,a3 as q,V as E,aH as B,k as T,j as r,ad as oe,Q as O,bS as G,aq as H,K as ne,dS as le,g as Ke,p as _e}from"./index-a194352f.js";import{c as Ue}from"./index-ce3c58de.js";import{E as Ve}from"./50x-c39b340b.js";import{u as qe}from"./lock-7553aa7c.js";import{a as Xe,u as Ze}from"./ServiceDiscovery-2e176802.js";import{M as Je}from"./index-24b15e3c.js";import{S as Ye}from"./index-1f632c02.js";import{T as Qe}from"./index-a65b0c71.js";import{D}from"./index-108a2a95.js";import{E as ee}from"./index-5ad4076b.js";import{P as ke}from"./index-0819aea3.js";import{S as et}from"./index-3bac1495.js";import{D as tt}from"./index-9ecf1558.js";import{C as at}from"./CopyOutlined-e41cebb1.js";import{E as st}from"./EditFilled-90066675.js";import"./index-f7f97548.js";import"./addEventListener-3f05c238.js";import"./LeftOutlined-e97baa49.js";import"./PurePanel-1bea721a.js";import"./PlusOutlined-1c56fe10.js";import"./useBreakpoint-90f5b703.js";import"./useForceUpdate-590b732c.js";import"./index-cbbb9550.js";import"./index-e03870b1.js";var rt=globalThis&&globalThis.__rest||function(e,a){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)a.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(t[s[i]]=e[s[i]]);return t};const it=e=>{var{prefixCls:a,className:t,hoverable:s=!0}=e,i=rt(e,["prefixCls","className","hoverable"]);const{getPrefixCls:n}=l.useContext(X),o=n("card",a),d=M(`${o}-grid`,t,{[`${o}-grid-hoverable`]:s});return l.createElement("div",Object.assign({},i,{className:d}))},ce=it,ot=e=>{const{antCls:a,componentCls:t,headerHeight:s,cardPaddingBase:i,tabsMarginBottom:n}=e;return Object.assign(Object.assign({display:"flex",justifyContent:"center",flexDirection:"column",minHeight:s,marginBottom:-1,padding:`0 ${m(i)}`,color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.headerFontSize,background:e.headerBg,borderBottom:`${m(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`,borderRadius:`${m(e.borderRadiusLG)} ${m(e.borderRadiusLG)} 0 0`},I()),{"&-wrapper":{width:"100%",display:"flex",alignItems:"center"},"&-title":Object.assign(Object.assign({display:"inline-block",flex:1},re),{[`
          > ${t}-typography,
          > ${t}-typography-edit-content
        `]:{insetInlineStart:0,marginTop:0,marginBottom:0}}),[`${a}-tabs-top`]:{clear:"both",marginBottom:n,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,"&-bar":{borderBottom:`${m(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`}}})},nt=e=>{const{cardPaddingBase:a,colorBorderSecondary:t,cardShadow:s,lineWidth:i}=e;return{width:"33.33%",padding:a,border:0,borderRadius:0,boxShadow:`
      ${m(i)} 0 0 0 ${t},
      0 ${m(i)} 0 0 ${t},
      ${m(i)} ${m(i)} 0 0 ${t},
      ${m(i)} 0 0 0 ${t} inset,
      0 ${m(i)} 0 0 ${t} inset;
    `,transition:`all ${e.motionDurationMid}`,"&-hoverable:hover":{position:"relative",zIndex:1,boxShadow:s}}},lt=e=>{const{componentCls:a,iconCls:t,actionsLiMargin:s,cardActionsIconSize:i,colorBorderSecondary:n,actionsBg:o}=e;return Object.assign(Object.assign({margin:0,padding:0,listStyle:"none",background:o,borderTop:`${m(e.lineWidth)} ${e.lineType} ${n}`,display:"flex",borderRadius:`0 0 ${m(e.borderRadiusLG)} ${m(e.borderRadiusLG)}`},I()),{"& > li":{margin:s,color:e.colorTextDescription,textAlign:"center","> span":{position:"relative",display:"block",minWidth:e.calc(e.cardActionsIconSize).mul(2).equal(),fontSize:e.fontSize,lineHeight:e.lineHeight,cursor:"pointer","&:hover":{color:e.colorPrimary,transition:`color ${e.motionDurationMid}`},[`a:not(${a}-btn), > ${t}`]:{display:"inline-block",width:"100%",color:e.colorTextDescription,lineHeight:m(e.fontHeight),transition:`color ${e.motionDurationMid}`,"&:hover":{color:e.colorPrimary}},[`> ${t}`]:{fontSize:i,lineHeight:m(e.calc(i).mul(e.lineHeight).equal())}},"&:not(:last-child)":{borderInlineEnd:`${m(e.lineWidth)} ${e.lineType} ${n}`}}})},ct=e=>Object.assign(Object.assign({margin:`${m(e.calc(e.marginXXS).mul(-1).equal())} 0`,display:"flex"},I()),{"&-avatar":{paddingInlineEnd:e.padding},"&-detail":{overflow:"hidden",flex:1,"> div:not(:last-child)":{marginBottom:e.marginXS}},"&-title":Object.assign({color:e.colorTextHeading,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeLG},re),"&-description":{color:e.colorTextDescription}}),dt=e=>{const{componentCls:a,cardPaddingBase:t,colorFillAlter:s}=e;return{[`${a}-head`]:{padding:`0 ${m(t)}`,background:s,"&-title":{fontSize:e.fontSize}},[`${a}-body`]:{padding:`${m(e.padding)} ${m(t)}`}}},mt=e=>{const{componentCls:a}=e;return{overflow:"hidden",[`${a}-body`]:{userSelect:"none"}}},ut=e=>{const{antCls:a,componentCls:t,cardShadow:s,cardHeadPadding:i,colorBorderSecondary:n,boxShadowTertiary:o,cardPaddingBase:d,extraColor:c}=e;return{[t]:Object.assign(Object.assign({},Ge(e)),{position:"relative",background:e.colorBgContainer,borderRadius:e.borderRadiusLG,[`&:not(${t}-bordered)`]:{boxShadow:o},[`${t}-head`]:ot(e),[`${t}-extra`]:{marginInlineStart:"auto",color:c,fontWeight:"normal",fontSize:e.fontSize},[`${t}-body`]:Object.assign({padding:d,borderRadius:`0 0 ${m(e.borderRadiusLG)} ${m(e.borderRadiusLG)}`},I()),[`${t}-grid`]:nt(e),[`${t}-cover`]:{"> *":{display:"block",width:"100%"},[`img, img + ${a}-image-mask`]:{borderRadius:`${m(e.borderRadiusLG)} ${m(e.borderRadiusLG)} 0 0`}},[`${t}-actions`]:lt(e),[`${t}-meta`]:ct(e)}),[`${t}-bordered`]:{border:`${m(e.lineWidth)} ${e.lineType} ${n}`,[`${t}-cover`]:{marginTop:-1,marginInlineStart:-1,marginInlineEnd:-1}},[`${t}-hoverable`]:{cursor:"pointer",transition:`box-shadow ${e.motionDurationMid}, border-color ${e.motionDurationMid}`,"&:hover":{borderColor:"transparent",boxShadow:s}},[`${t}-contain-grid`]:{borderRadius:`${m(e.borderRadiusLG)} ${m(e.borderRadiusLG)} 0 0 `,[`${t}-body`]:{display:"flex",flexWrap:"wrap"},[`&:not(${t}-loading) ${t}-body`]:{marginBlockStart:e.calc(e.lineWidth).mul(-1).equal(),marginInlineStart:e.calc(e.lineWidth).mul(-1).equal(),padding:0}},[`${t}-contain-tabs`]:{[`> div${t}-head`]:{minHeight:0,[`${t}-head-title, ${t}-extra`]:{paddingTop:i}}},[`${t}-type-inner`]:dt(e),[`${t}-loading`]:mt(e),[`${t}-rtl`]:{direction:"rtl"}}},gt=e=>{const{componentCls:a,cardPaddingSM:t,headerHeightSM:s,headerFontSizeSM:i}=e;return{[`${a}-small`]:{[`> ${a}-head`]:{minHeight:s,padding:`0 ${m(t)}`,fontSize:i,[`> ${a}-head-wrapper`]:{[`> ${a}-extra`]:{fontSize:e.fontSize}}},[`> ${a}-body`]:{padding:t}},[`${a}-small${a}-contain-tabs`]:{[`> ${a}-head`]:{[`${a}-head-title, ${a}-extra`]:{paddingTop:0,display:"flex",alignItems:"center"}}}}},ht=e=>({headerBg:"transparent",headerFontSize:e.fontSizeLG,headerFontSizeSM:e.fontSize,headerHeight:e.fontSizeLG*e.lineHeightLG+e.padding*2,headerHeightSM:e.fontSize*e.lineHeight+e.paddingXS*2,actionsBg:e.colorBgContainer,actionsLiMargin:`${e.paddingSM}px 0`,tabsMarginBottom:-e.padding-e.lineWidth,extraColor:e.colorText}),pt=Fe("Card",e=>{const a=De(e,{cardShadow:e.boxShadowCard,cardHeadPadding:e.padding,cardPaddingBase:e.paddingLG,cardActionsIconSize:e.fontSize,cardPaddingSM:12});return[ut(a),gt(a)]},ht);var te=globalThis&&globalThis.__rest||function(e,a){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)a.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(t[s[i]]=e[s[i]]);return t};const ft=e=>{const{actionClasses:a,actions:t=[],actionStyle:s}=e;return l.createElement("ul",{className:a,style:s},t.map((i,n)=>{const o=`action-${n}`;return l.createElement("li",{style:{width:`${100/t.length}%`},key:o},l.createElement("span",null,i))}))},xt=l.forwardRef((e,a)=>{const{prefixCls:t,className:s,rootClassName:i,style:n,extra:o,headStyle:d={},bodyStyle:c={},title:S,loading:x,bordered:$=!0,size:C,type:N,cover:b,actions:p,tabList:u,children:y,activeTabKey:A,defaultActiveTabKey:J,tabBarExtraContent:ue,hoverable:ge,tabProps:he={},classNames:K,styles:_}=e,pe=te(e,["prefixCls","className","rootClassName","style","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps","classNames","styles"]),{getPrefixCls:fe,direction:xe,card:v}=l.useContext(X),be=f=>{var g;(g=e.onTabChange)===null||g===void 0||g.call(e,f)},z=f=>{var g;return M((g=v==null?void 0:v.classNames)===null||g===void 0?void 0:g[f],K==null?void 0:K[f])},R=f=>{var g;return Object.assign(Object.assign({},(g=v==null?void 0:v.styles)===null||g===void 0?void 0:g[f]),_==null?void 0:_[f])},ye=l.useMemo(()=>{let f=!1;return l.Children.forEach(y,g=>{g&&g.type&&g.type===ce&&(f=!0)}),f},[y]),h=fe("card",t),[ve,je,Se]=pt(h),$e=l.createElement(We,{loading:!0,active:!0,paragraph:{rows:4},title:!1},y),Y=A!==void 0,Ce=Object.assign(Object.assign({},he),{[Y?"activeKey":"defaultActiveKey"]:Y?A:J,tabBarExtraContent:ue});let Q;const L=He(C),Me=!L||L==="default"?"large":L,k=u?l.createElement(Qe,Object.assign({size:Me},Ce,{className:`${h}-head-tabs`,onChange:be,items:u.map(f=>{var{tab:g}=f,U=te(f,["tab"]);return Object.assign({label:g},U)})})):null;if(S||o||k){const f=M(`${h}-head`,z("header")),g=M(`${h}-head-title`,z("title")),U=M(`${h}-extra`,z("extra")),Le=Object.assign(Object.assign({},d),R("header"));Q=l.createElement("div",{className:f,style:Le},l.createElement("div",{className:`${h}-head-wrapper`},S&&l.createElement("div",{className:g,style:R("title")},S),o&&l.createElement("div",{className:U,style:R("extra")},o)),k)}const we=M(`${h}-cover`,z("cover")),Ne=b?l.createElement("div",{className:we,style:R("cover")},b):null,Ae=M(`${h}-body`,z("body")),Oe=Object.assign(Object.assign({},c),R("body")),Be=l.createElement("div",{className:Ae,style:Oe},x?$e:y),Ee=M(`${h}-actions`,z("actions")),Te=p&&p.length?l.createElement(ft,{actionClasses:Ee,actionStyle:R("actions"),actions:p}):null,ze=Ie(pe,["onTabChange"]),Re=M(h,v==null?void 0:v.className,{[`${h}-loading`]:x,[`${h}-bordered`]:$,[`${h}-hoverable`]:ge,[`${h}-contain-grid`]:ye,[`${h}-contain-tabs`]:u&&u.length,[`${h}-${L}`]:L,[`${h}-type-${N}`]:!!N,[`${h}-rtl`]:xe==="rtl"},s,i,je,Se),Pe=Object.assign(Object.assign({},v==null?void 0:v.style),n);return ve(l.createElement("div",Object.assign({ref:a},ze,{className:Re,style:Pe}),Q,Ne,Be,Te))}),bt=xt;var yt=globalThis&&globalThis.__rest||function(e,a){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)a.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(t[s[i]]=e[s[i]]);return t};const vt=e=>{const{prefixCls:a,className:t,avatar:s,title:i,description:n}=e,o=yt(e,["prefixCls","className","avatar","title","description"]),{getPrefixCls:d}=l.useContext(X),c=d("card",a),S=M(`${c}-meta`,t),x=s?l.createElement("div",{className:`${c}-meta-avatar`},s):null,$=i?l.createElement("div",{className:`${c}-meta-title`},i):null,C=n?l.createElement("div",{className:`${c}-meta-description`},n):null,N=$||C?l.createElement("div",{className:`${c}-meta-detail`},$,C):null;return l.createElement("div",Object.assign({},o,{className:S}),x,N)},jt=vt,Z=bt;Z.Grid=ce;Z.Meta=jt;const de=Z;var W={};W.byteLength=Ct;W.toByteArray=wt;W.fromByteArray=Ot;var w=[],j=[],St=typeof Uint8Array<"u"?Uint8Array:Array,V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var P=0,$t=V.length;P<$t;++P)w[P]=V[P],j[V.charCodeAt(P)]=P;j["-".charCodeAt(0)]=62;j["_".charCodeAt(0)]=63;function me(e){var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");t===-1&&(t=a);var s=t===a?0:4-t%4;return[t,s]}function Ct(e){var a=me(e),t=a[0],s=a[1];return(t+s)*3/4-s}function Mt(e,a,t){return(a+t)*3/4-t}function wt(e){var a,t=me(e),s=t[0],i=t[1],n=new St(Mt(e,s,i)),o=0,d=i>0?s-4:s,c;for(c=0;c<d;c+=4)a=j[e.charCodeAt(c)]<<18|j[e.charCodeAt(c+1)]<<12|j[e.charCodeAt(c+2)]<<6|j[e.charCodeAt(c+3)],n[o++]=a>>16&255,n[o++]=a>>8&255,n[o++]=a&255;return i===2&&(a=j[e.charCodeAt(c)]<<2|j[e.charCodeAt(c+1)]>>4,n[o++]=a&255),i===1&&(a=j[e.charCodeAt(c)]<<10|j[e.charCodeAt(c+1)]<<4|j[e.charCodeAt(c+2)]>>2,n[o++]=a>>8&255,n[o++]=a&255),n}function Nt(e){return w[e>>18&63]+w[e>>12&63]+w[e>>6&63]+w[e&63]}function At(e,a,t){for(var s,i=[],n=a;n<t;n+=3)s=(e[n]<<16&16711680)+(e[n+1]<<8&65280)+(e[n+2]&255),i.push(Nt(s));return i.join("")}function Ot(e){for(var a,t=e.length,s=t%3,i=[],n=16383,o=0,d=t-s;o<d;o+=n)i.push(At(e,o,o+n>d?d:o+n));return s===1?(a=e[t-1],i.push(w[a>>2]+w[a<<4&63]+"==")):s===2&&(a=(e[t-2]<<8)+e[t-1],i.push(w[a>>10]+w[a>>4&63]+w[a<<2&63]+"=")),i.join("")}const Bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAXVBMVEUAAAD29v/19vj09vj09vj19fj19fj19fj19fj29vj09vgzMzPv8PKhoqOFhYZmZmZCQkLCw8Xx8vTr7O7Nzs/AwcO2t7ioqKqcnZ6VlZZ2dnd0dHVVVVVGRkc9PT2jobaUAAAACnRSTlMAG/Py2baba05un7UgfgAAAJJJREFUKM91UtcSwzAIA8cjEV3p3v//mb32HMolRk/WyRZGQBVcUgwhpsJkwRmKbKS+g0HXU8WAGYZ6v9LVZjvW4+8NTz5rkd3k9q2TsRSQiRj4W52UMBU0USi1hUTRWo1KIgW0iiO4gmvlFne/axo8PJ5nJWwiuYq8NRIb4kXkpSHa2Pe3+1Fj9wblj9ZfBnd9Pk2YEmQ3bGOFAAAAAElFTkSuQmCC",Et="_download_gb3yo_1",Tt="_remoteCard_gb3yo_10",zt="_icon_gb3yo_13",Rt="_btn_gb3yo_24",Pt="_descLine_gb3yo_35",F={download:Et,remoteCard:Tt,icon:zt,btn:Rt,descLine:Pt},Lt=({sdks:e,onUpdate:a,actionRef:t})=>{const{getRepositoryUrl:s}=Xe(),{initialize:i}=ie(),[n,o]=l.useState(!1),{data:d,isValidating:c,error:S,mutate:x}=Ze("sdks.json"),{remoteServer:$,remoteClient:C}=l.useMemo(()=>{const u=[],y=[];return d!=null&&d.official&&d.official.forEach(A=>{A.type==="server"?u.push(A):y.push(A)}),{remoteServer:u,remoteClient:y}},[d]),N=l.useMemo(()=>new Set((e==null?void 0:e.map(u=>u.dirName))??[]),[e]),{loading:b,fun:p}=qe(async u=>{const y=s(u.gitUrl),A=E.loading(B.formatMessage({id:"/cqdKk",defaultMessage:[{type:0,value:"下载"}]}),-1);try{await T.post("/sdk",{...u,gitUrl:y}),a(),i(),q("/sdk/enabledServer"),E.success(B.formatMessage({id:"WJWR3q",defaultMessage:[{type:0,value:"下载成功"}]}))}catch{E.error(B.formatMessage({id:"eJ2viL",defaultMessage:[{type:0,value:"下载失败"}]}))}A()},[q]);return l.useEffect(()=>{t&&(t.current={show:()=>{o(!0),x()}})},[t,x]),r.jsxs(Je,{width:"80vw",footer:null,open:n,onCancel:()=>o(!1),title:r.jsx("div",{className:"text-center",children:B.formatMessage({id:"DAKKuk",defaultMessage:[{type:0,value:"模版市场"}]})}),styles:{body:{minHeight:"60vh"}},children:[c?r.jsx("div",{className:"flex h-40vh w-full items-center justify-center",children:r.jsx(Ye,{tip:"Loading",size:"large"})}):null,!c&&S?r.jsxs("div",{className:"flex flex-col h-40vh w-full items-center justify-center",children:[r.jsx(Ve,{}),r.jsx(oe,{onClick:()=>{x()},children:B.formatMessage({id:"pR5Kts",defaultMessage:[{type:0,value:"重试"}]})})]}):null,!c&&!S&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs  mb-4 text-[#666]",children:r.jsx(O,{id:"p5GCek",defaultMessage:[{type:0,value:"钩子模版"}]})}),r.jsx(G,{className:"",gutter:[32,32],children:$==null?void 0:$.map((u,y)=>r.jsx(H,{xl:8,xxl:6,md:12,children:r.jsx(ae,{exist:N.has(u.name),sdk:u,onSelect:()=>{p(u)}})},y))}),r.jsx("div",{className:"text-xs  mb-4 mt-8 text-[#666]",children:r.jsx(O,{id:"gRp6eK",defaultMessage:[{type:0,value:"客户端模版"}]})}),r.jsx(G,{className:"",gutter:[32,32],children:C==null?void 0:C.map((u,y)=>r.jsx(H,{xl:8,xxl:6,md:12,children:r.jsx(ae,{exist:N.has(u.name),sdk:u,onSelect:()=>{p(u)}})},y))})]})]})},ae=({onSelect:e,sdk:a,exist:t})=>{const s=ne();return r.jsxs(de,{title:r.jsxs("div",{className:"flex items-center",children:[r.jsx("img",{alt:"",className:F.icon,src:a.icon.startsWith("http")?a.icon:`data:image/svg+xml;base64,${base64.fromByteArray(new TextEncoder().encode(`${a.icon}`))}`}),a.title]}),className:F.remoteCard,extra:t?r.jsx("div",{className:"text-[#787D8B]",children:"已下载"}):null,children:[r.jsxs(D,{size:"small",column:1,labelStyle:{width:100},contentStyle:{color:"#787D8B"},children:[r.jsx(D.Item,{label:s.formatMessage({id:"jiM9+b",defaultMessage:[{type:0,value:"模板ID"}]}),children:a.name}),r.jsx(D.Item,{label:s.formatMessage({id:"Ph2Nn+",defaultMessage:[{type:0,value:"功能描述"}]}),children:r.jsx("div",{className:F.descLine,children:a.description})}),r.jsx(D.Item,{label:s.formatMessage({id:"Zlo7bL",defaultMessage:[{type:0,value:"生成路径"}]}),children:a.outputPath})]}),t?null:r.jsx("div",{className:F.download,children:r.jsx("div",{className:F.btn,onClick:e,children:"点击下载"})})]})},la=()=>{const{data:e,mutate:a}=le("/sdk",T.get),t=l.useRef(),{server:s,client:i}=l.useMemo(()=>{const o=[],d=[];return e&&e.forEach(c=>{c.type==="server"?o.push(c):d.push(c)}),{server:o,client:d}},[e]),n=(o,d)=>{a([...e.slice(0,o-2),d,...e.slice(o-1)])};return r.jsxs(de,{children:[r.jsxs("div",{className:"flex mb-4 items-center",children:[r.jsx("div",{className:"text-base t-medium",children:r.jsx(O,{id:"hw2IgW",defaultMessage:[{type:0,value:"模版仓库"}]})}),r.jsx("div",{className:"flex-1"}),r.jsx(oe,{onClick:()=>{var o;(o=t.current)==null||o.show()},children:B.formatMessage({id:"t9OiGA",defaultMessage:[{type:0,value:"浏览模版市场"}]})})]}),r.jsxs("div",{className:"flex mb-4 items-center",children:[r.jsx("div",{className:"text-xs text-[#666]",children:r.jsx(O,{id:"p5GCek",defaultMessage:[{type:0,value:"钩子模版"}]})}),r.jsx("div",{className:"text-xs ml-3 text-[#787D8B]",children:r.jsx(O,{id:"RKEnyl",defaultMessage:[{type:0,value:"（钩子同时只能开启一个，为toggle模式）"}]})})]}),r.jsxs(G,{className:"",gutter:[32,32],children:[s==null?void 0:s.map((o,d)=>r.jsx(H,{xl:8,xxl:6,md:12,children:r.jsx(se,{sdk:o,onChange:c=>n(d,c)})},o.name)),!(s!=null&&s.length)&&r.jsx(ee,{className:"m-auto",description:B.formatMessage({id:"cLNR9b",defaultMessage:[{type:0,value:"暂无模板"}]})})]}),r.jsx("div",{className:"flex mb-4 items-center mt-8",children:r.jsxs("div",{className:"text-xs text-[#666]",children:[r.jsx(O,{id:"gRp6eK",defaultMessage:[{type:0,value:"客户端模版"}]}),i.length&&r.jsxs("span",{className:"text-xs ml-3 text-[#787D8B]",children:["（",r.jsx("code",{className:"px-1 text-primary",children:"generated-sdk"}),r.jsx(O,{id:"bXiKzU",defaultMessage:[{type:0,value:"目录下生成的文件可以使用"}]}),r.jsxs("span",{className:"mx-1 text-primary cursor-pointer",onClick:()=>{Ue(`${window.location.origin}/generated-sdk`),E.success("已复制")},children:[window.location.origin,"/generated-sdk",r.jsx(at,{className:"ml-0.5 mr-1"})]}),r.jsx(O,{id:"J0Nrpk",defaultMessage:[{type:0,value:"加上文件路径访问"}]}),"）"]})]})}),r.jsxs(G,{className:"",gutter:[32,32],children:[i==null?void 0:i.map((o,d)=>r.jsx(H,{xl:8,xxl:6,md:12,children:r.jsx(se,{sdk:o,onChange:c=>n(d,c)})},d)),!(i!=null&&i.length)&&r.jsx(ee,{className:"m-auto",description:B.formatMessage({id:"7Mbp/s",defaultMessage:[{type:0,value:"暂无 模版"}]})})]}),r.jsx(Lt,{sdks:e??[],onUpdate:a,actionRef:t})]})};async function Ft(e){const a=e.gitUrl.match(/^https?:\/\/(.+)\/(.+\/.+)\.git/);if(a)try{const t=await _e(`https://api.github.com/repos/${a[2]}/git/refs/heads/${e.gitBranch}`);return t&&t.object.sha!==e.gitCommitHash?{repo:a[2],localSha:e.gitCommitHash,remoteSha:t.object.sha}:!1}catch(t){console.error(t)}return!1}const se=({onChange:e,sdk:a})=>{const t=ne(),[s,i]=l.useState(!1),[n,o]=l.useState(!1),[d,c]=l.useState(a.outputPath),{initialize:S}=ie(),{mutate:x}=le("/sdk",T.get),$=l.useCallback(b=>{const p=b.currentTarget.value;b.key==="Escape"?(c(a.outputPath),o(!1)):b.key==="Enter"&&T.put("/sdk",{name:a.name,outputPath:p}).then(u=>{console.log("res",u),e({...a,outputPath:p}),E.success(t.formatMessage({id:"jhfb/7",defaultMessage:[{type:0,value:"保存成功"}]}))})},[t,e,a]),C=l.useCallback(b=>{T.put("/sdk",{name:a.name,enabled:b}).then(p=>{x(),S(),q("/sdk/enabledServer")})},[S,x,a.name]),N=l.useMemo(()=>{const b=[{key:"delete",icon:"",label:r.jsx(ke,{title:t.formatMessage({id:"nS8PfW",defaultMessage:[{type:0,value:"确定要删除?"}]}),okText:t.formatMessage({id:"r0/TUu",defaultMessage:[{type:0,value:"确定"}]}),cancelText:t.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"取消"}]}),onConfirm:async()=>{await T.delete(`/sdk/${a.name}`),E.success(t.formatMessage({id:"aiBGBs",defaultMessage:[{type:0,value:"删除成功"}]})),x()},children:t.formatMessage({id:"XeiAal",defaultMessage:[{type:0,value:"删除"}]})})},{key:"update",label:t.formatMessage({id:"iCvPMa",defaultMessage:[{type:0,value:"升级"}]}),onClick:async()=>{const p=E.loading(t.formatMessage({id:"GdhWnp",defaultMessage:[{type:0,value:"升级中"}]}));try{await T.put("/sdk",{name:a.name,gitCommitHash:"latest"}),E.success(t.formatMessage({id:"uG+OVa",defaultMessage:[{type:0,value:"升级成功"}]})),x()}finally{p()}}}];return a.enabled===!0&&b.push({key:"download",label:t.formatMessage({id:"4bLnOM",defaultMessage:[{type:0,value:"下载生成文件"}]}),onClick:async()=>{const p=Ke();window.open(`/api/sdk/downloadOutput/${a.name}?${p?`&auth-key=${p}`:""}`)}}),b},[t,x,a]);return l.useEffect(()=>{Ft(a).then(i)},[a]),r.jsxs("div",{className:"bg-white rounded shadow p-4 hover:shadow-lg",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("img",{alt:"",className:"w-10 h-10 mr-2.5",src:a.icon.startsWith("http")?a.icon:`data:image/svg+xml;base64,${W.fromByteArray(new TextEncoder().encode(`${a.icon}`))}`}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-base t-medium",children:a.name}),s&&r.jsx("a",{className:"ml-4 text-primary italic border border-primary border-solid rounded px-1 py-0.5 leading-2 text-xs",href:`https://github.com/${s.repo}/compare/${s.localSha.substring(0,7)}..${s.remoteSha.substring(0,7)}`,target:"_blank",rel:"noreferrer",children:"new"})]}),r.jsxs("div",{className:"flex mt-1 items-center",children:[r.jsx("div",{className:"rounded-md bg-[#D8D8D8] h-2.5 shadow w-2.5"}),r.jsx("div",{className:"text-xs ml-1 text-[#5F6269]",children:a.author})]})]}),r.jsx(et,{className:"flex-shrink-0",checked:a.enabled,onChange:C}),r.jsx(tt,{menu:{items:N},trigger:["hover"],children:r.jsx("img",{alt:"",className:"cursor-pointer h-3 ml-2 w-3",src:Bt})})]}),r.jsx("div",{className:"bg-[rgba(95,98,105,0.1)] h-0.5 mt-2 mb-3"}),r.jsxs("div",{className:"text-xs text-[#787D8B] line-clamp-2",children:[t.formatMessage({id:"Ph2Nn+",defaultMessage:[{type:0,value:"功能描述"}]}),"：",a.description||"-"]}),r.jsxs("div",{className:"flex h-8 mt-3 relative items-center",children:[r.jsxs("span",{className:"flex-shrink-0 text-xs text-[#787D8B] line-clamp-2",children:[t.formatMessage({id:"Zlo7bL",defaultMessage:[{type:0,value:"生成路径"}]}),"："]}),r.jsx("input",{value:d,readOnly:!n,className:"border rounded h-full outline-none border-[rgba(95,98,105,0.1)] text-sm w-full px-3 text-[#5F6269] focus:border-[rgba(95,98,105,0.8)]",onClick:()=>o(!0),onBlur:()=>o(!1),onKeyDown:$,onInput:b=>c(b.currentTarget.value)}),r.jsx(st,{className:"cursor-pointer top-2 right-3 absolute",size:8})]})]})};export{la as default};
