import{c as N,d as le,e as Se,r as n,u as Ae,b as de,j as e,f as l,F as J,g as M,T as ne,m as T,h as tt,i as be,I as ze,R as we,_ as Fe,t as st,s as ve,k as Oe,l as at,n as re,C as nt,O as ot}from"./index.e5e6c754.js";import{M as ue}from"./index.6f73eb32.js";import{I as it,H as rt,F as lt,C as ut,S as ct,D as ye,M as ke}from"./conductUtil.03f406cc.js";import{i as dt}from"./use-immer.module.1d9a0526.js";import{c as ht,u as Ue,I as pt}from"./index.07d786b1.js";import{W as he}from"./workbenchContext.a6b76e3b.js";import{S as W,H as ie}from"./keyBy.400ebaf7.js";import{P as mt}from"./index.67bc873e.js";import{i as ft}from"./index.esm.0df65c6e.js";import{r as ce}from"./printer.b0e2956d.js";import{P as gt}from"./PrismaSchemaContext.c1116ab6.js";import{P as Ye}from"./index.6fa46df0.js";import{T as vt}from"./Tree.4b4dd3c6.js";import{u as _t}from"./uniq.2129c997.js";import{i as Ce,a as He}from"./utils.aecd68b7.js";import{I as bt}from"./index.60d20720.js";import{u as yt}from"./index.esm.e5edd667.js";import{u as kt}from"./dataSource.f9c7deae.js";import{u as At}from"./storage.aee759da.js";import{p as wt}from"./db.84db3282.js";import{R as Ee}from"./index.8958a719.js";import{S as Ft}from"./index.8fd962f9.js";import{T as fe}from"./index.b6cece06.js";import{u as Mt}from"./calcTime.a918c2eb.js";var pe=it;pe.Header=rt;pe.Footer=lt;pe.Content=ut;pe.Sider=ct;const _e=pe;var Be=(s=>(s[s.DatasourceQuestion=1]="DatasourceQuestion",s[s.OperationQuestion=2]="OperationQuestion",s[s.HooksQuestion=3]="HooksQuestion",s[s.AuthQuestion=4]="AuthQuestion",s[s.OssQuestion=5]="OssQuestion",s[s.OauthQuestion=6]="OauthQuestion",s[s.InternalQuestion=7]="InternalQuestion",s))(Be||{});const Te=ht((s,a)=>({logs:[],setLogs:o=>s({logs:o}),questions:[],setQuestions:o=>s({questions:o})})),Ct="_workbench_19yet_1",Et="_header_19yet_1",xt="_footer_19yet_7",Bt="_sider_19yet_13",ge={workbench:Ct,header:Et,footer:xt,sider:Bt};function We(){return ft("/auth",s=>N.get(s))}const Nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAoCAMAAAC/1ZhiAAAA7VBMVEUAAACAhI2BhI2EiJCAhI2AhI2AhIx4foiAhI2Ag41fY2qAhI7f39+Ch4yAmZnb29vb29tiZWyCho7g4ODb29tiZGtfYmpfYmmAhY2BhYxiYmpjaGx0eH/Ky8xlZ2/c3NyAg42AhIxgY2qAhIxydX1gZGtgY2mAg41jZWutr7NhY2pfZGqBhI9hZGqdoKPe3t5iYmxgZG1fZGljY2vb29t/g4xfYmnV1ta5u76PkprOz9Cgo6mUlp2Hi5Kpq7DKysx2eoK8vb+4ubuEh455e4FnaXDR0dLExci/wMOytLiwsbOUl557f4dwcnhmaXAkd/fiAAAANHRSTlMAc1gU/PbxD+LDo3w/Mwrsx0o/Ifr38OdnRkEd/e/r2NDBvLSdkoiGgYBsY11ZVlROPTMfT6pkcAAAAWVJREFUOMvV1GV3gzAUgOEEhrTUZbW5uyYBCtTn8v9/zu7JaJEk2+c+n99zzw0StM6s3hXGWkP/N+wWNii3sY//rjWaYjoVpHYOM8NgNApCHttlVdiskZdXl3Cu50NraPKyVCUZXgSxJi1bJGfow9z8DvU71KwSgQutnT1bn7F+jUgMYQcn89Q7jO24RMaDZ6ajRJGBiEjBCjgprxn3rhpbWJWDTcY9DaXbfk62zo6L9zw9YDEqdOPFN/tV5CkMjccK6ZQtPfD0sV4/mkzC2WxMBGEyNIYpHRGpOS/bg/S3F8hTd8HACVppUBoSuecvxjpWkurwmbqKdtxmFyilQKlHFG4uEUify1eUuyhLN5Vjb1GOQ2kkfbE1lFexYQXJyapNJCgb0ApzWyXVFRBl9p0G21BKWwNi31v+3G8RpSZSKNvQxlfGx5yCQ6RScUyaYpxaSE3Hq+ttT7jexLqhYdztWWit/QAZeJg7kiUxwAAAAABJRU5ErkJggg==",St="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAY1BMVEUAAADU1NRjZmxvcnePkZVgY2rPz9BfY2poaHTAwMOAhIxoa3FgYmpgYmlgY2nFxcbU1NRmZm+Ag427u73U1NRfYml/g4zt7e3k5eXW1te9vsCztLefoaWanKCOkJVydXtucXecDQKGAAAAFXRSTlMAzP336NDOiAvTz/rn2tjSph7Qs6d9epWLAAAAjElEQVQ4y+2T2Q6EIAxFK+A6mzMj4q7//5VaYngCG2N8cDkvNOlJSG9TuCq+XMQ3oiQ4p0jGsx+/fCIByDwrqRFzDYDn4BatYiw4Y1zEhBgIJjUsjJbED5eG19ctBtrr66rD9x05RYH9oVBKtViFTvGB7UZNlFg9N4n01/QwdDwrA0/mU0jtK/zDYRgBwgsrsPomQg4AAAAASUVORK5CYII=",Dt="_header_shpzm_1",It="_dashboardIcon_shpzm_9",Rt="_dashboardIcon2_shpzm_15",Lt="_logo_shpzm_21",Ot="_splitLine_shpzm_29",$t="_title_shpzm_34",Pt="_titleIcon_shpzm_38",qt="_headBtn_shpzm_44",zt="_compiling_shpzm_53",Ut="_breath_shpzm_1",Yt="_helpIcon_shpzm_68",Ht="_configIcon_shpzm_75",Tt="_avatar_shpzm_82",K={header:Dt,dashboardIcon:It,dashboardIcon2:Rt,logo:Lt,splitLine:Ot,title:$t,titleIcon:Pt,headBtn:qt,compiling:zt,breath:Ut,helpIcon:Yt,configIcon:Ht,avatar:Tt};function Wt(s){const a=le(),{config:o}=Se(),d=n.exports.useMemo(()=>[{keys:["alt/^","h"],desc:a.formatMessage({id:"ATIkHk",defaultMessage:[{type:0,value:"\u6253\u5F00\u5FEB\u6377\u952E\u63D0\u793A"}]})},{keys:["alt/^","n"],desc:a.formatMessage({id:"qMKYtF",defaultMessage:[{type:0,value:"\u65B0\u5EFAAPi/\u65B0\u5EFA\u6A21\u578B"}]})},{keys:["alt/^","b"],desc:a.formatMessage({id:"U1eYS0",defaultMessage:[{type:0,value:"\u6279\u91CF\u65B0\u5EFAAPI"}]})},{keys:["alt/^","c"],desc:a.formatMessage({id:"0uAOrg",defaultMessage:[{type:0,value:"\u7F16\u8BD1"}]})},{keys:["alt/^","m"],desc:a.formatMessage({id:"RuZ3Ak",defaultMessage:[{type:0,value:"\u5207\u6362API\u8BBE\u8BA1\u548C\u6A21\u578B\u8BBE\u8BA1"}]})},{keys:["alt/^","r"],desc:a.formatMessage({id:"7cCd7/",defaultMessage:[{type:0,value:"\u8FD0\u884C\u5F53\u524DOperation"}]})},{keys:["alt/^","t"],desc:a.formatMessage({id:"+MrBgm",defaultMessage:[{type:0,value:"\u6A21\u578B\u8BBE\u8BA1\u9875\u5207\u6362\u8BBE\u8BA1/\u6570\u636E\u89C6\u56FE"}]})},{keys:["alt/^","shift","d"],desc:a.formatMessage({id:"nwr0JF",defaultMessage:[{type:0,value:"\u521B\u5EFA\u5F53\u524DAPI\u7684\u62F7\u8D1D"}]})},{keys:["alt/^","shift","c"],desc:a.formatMessage({id:"EpuhM8",defaultMessage:[{type:0,value:"\u590D\u5236\u5F53\u524DAPI\u8BF7\u6C42\u94FE\u63A5"}]})},{keys:["alt/^","shift","t"],desc:a.formatMessage({id:"+jyuQU",defaultMessage:[{type:0,value:"API\u7F16\u8F91\u9875\u5207\u6362Json/\u8868\u5355\u6A21\u5F0F\uFF0C\u6A21\u578B\u8BBE\u8BA1\u9875\u5207\u6362\u8BBE\u8BA1/\u4EE3\u7801\u6A21\u5F0F"}]})}],[a]),p=Ae(),{pathname:b}=de(),{isFullscreen:f}=n.exports.useContext(he),{data:r=[]}=We(),[F,C]=n.exports.useState(!1),y=s.engineStatus===W.Starting||s.engineStatus===W.Building,x=()=>{if(!o.devSwitch){T.error("\u751F\u4EA7\u73AF\u5883\u7981\u6B62\u91CD\u65B0\u7F16\u8BD1");return}y||N.get("/wdg/reStart").then(()=>void T.success(a.formatMessage({id:"HalctF",defaultMessage:[{type:0,value:"\u5F00\u59CB\u7F16\u8BD1"}]})))},B=n.exports.useCallback(()=>{ue.destroyAll(),ue.info({width:"800px",icon:null,title:a.formatMessage({id:"VLmNWR",defaultMessage:[{type:0,value:"\u9875\u9762\u5FEB\u6377\u952E"}]}),content:e("div",{className:"flex flex-wrap",children:d.map(k=>l("div",{className:"flex pt-1 pr-4 pb-3 pl-1 w-1/2 items-start",children:[e("div",{className:"flex-shrink-0 w-40",children:k.keys.map(A=>e("kbd",{className:"rounded bg-true-gray-200 text-sm mr-1.5 py-1 px-1.5",children:A},A))}),e("span",{children:k.desc})]},k.desc))}),okText:a.formatMessage({id:"r1IImU",defaultMessage:[{type:0,value:"\u77E5\u9053\u4E86"}]})})},[]);n.exports.useEffect(()=>{const k=ce("alt+c,^+c",()=>{x()}),A=ce("alt+h,^+h",()=>{B()});return()=>{k(),A()}},[]);const E=k=>{const A=new URL(location.toString());A.hash="#/workbench/rapi/loginBack";let q;try{q=new URL((k==null?void 0:k.point)+encodeURIComponent(A.toString()))}catch($){T.error(a.formatMessage({id:"iW9zfZ",defaultMessage:[{type:0,value:"\u5730\u5740\u5F02\u5E38\uFF0C\u8BF7\u68C0\u67E5\u7CFB\u7EDF\u8BBE\u7F6E\u4E2D\u7684API\u57DF\u540D\u662F\u5426\u6B63\u786E"}]})),console.error($);return}o.apiHost||(q.protocol=location.protocol,q.hostname=location.hostname,q.port=location.port),window.open(q.toString())},I=()=>{N.options("/auth/cookie/user/logout").then(k=>{console.log(k)})};return e(J,{children:l("div",{className:K.header,children:[e("div",{className:f?K.dashboardIcon2:K.dashboardIcon,onClick:()=>s.onToggleSider()}),e("div",{className:K.logo,onClick:()=>p("/workbench")}),e("div",{className:K.splitLine}),e("div",{className:K.title,children:e(M,{id:"xKCJNb",defaultMessage:[{type:0,value:"\u98DE\u5E03\u63A7\u5236\u53F0"}]})}),e("div",{className:"flex-1"}),b==="/workbench/rapi"?l(J,{children:[e(ye,{className:"mr-4",overlay:e(ke,{items:[...r.map(k=>({key:k.id,label:e("div",{onClick:()=>E(k),children:k.name})})),{key:"0",label:e("div",{onClick:I,children:"\u767B\u51FA"})}]}),children:e("div",{className:"cursor-pointer",children:"\u767B\u5F55OIDC"})}),e("img",{src:"/assets/share.svg",alt:""}),e(mt,{color:"#2A2B2CFF",content:l("div",{children:[e("a",{className:"text-[#f0f8ff]",onClick:()=>C(!1),href:"/api/v1/file/postToSwag",download:"Swagger.json",children:e(M,{id:"N188jr",defaultMessage:[{type:0,value:"\u4E0B\u8F7D swagger"}]})}),e("br",{}),e("a",{className:"text-[#f0f8ff]",onClick:()=>C(!1),href:"/api/v1/file/postToSwag",download:"OpenAPI",children:e(M,{id:"rNWfUf",defaultMessage:[{type:0,value:"\u4E0B\u8F7D OpenAPI"}]})}),e("br",{}),e("a",{className:"text-[#f0f8ff]",onClick:()=>C(!1),href:"/api/v1/operateApi/sdk",download:"SDK",children:e(M,{id:"BGgRyA",defaultMessage:[{type:0,value:"\u4E0B\u8F7D React SDK"}]})})]}),title:!1,trigger:"click",open:F,onOpenChange:k=>C(k),children:l("div",{className:"cursor-pointer",children:[e("img",{src:"/assets/download.svg",alt:"",className:"ml-7"}),e("img",{src:"/assets/shape-down.svg",alt:""})]})})]}):l(J,{children:[o.devSwitch?e("div",{className:K.headBtn,onClick:x,children:y?e("img",{src:"/assets/compile.gif",className:K.compiling,alt:"\u7F16\u8BD1"}):e("img",{src:Nt,className:"h-5 w-5.25",alt:"\u7F16\u8BD1"})}):null,e("div",{className:K.headBtn,onClick:()=>window.open("/#/workbench/rapi?t="+Date.now(),"fb_rapi"),children:e("img",{src:St,className:"h-5 w-5",alt:"\u9884\u89C8"})})]}),e("div",{className:K.splitLine,style:{margin:"0 26px"}}),e("div",{className:"cursor-pointer flex-0 h-4 text-0px w-4",onClick:()=>window.open("https://github.com/fireboomio","_blank"),children:e("img",{className:"h-4 w-4",src:"/assets/github.svg",alt:""})}),e("div",{className:K.helpIcon,onClick:()=>window.open("https://doc.fireboom.io/","_blank")}),e(ne,{title:a.formatMessage({id:"sRkj0b",defaultMessage:[{type:0,value:"\u5FEB\u6377\u952E"}]}),children:e("svg",{className:"cursor-pointer ml-4",onClick:B,width:"1.25em",height:"1.25em",viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M20 3H4c-1.1 0-1.99.9-1.99 2L2 15c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 12H4V5h16v10zm-9-9h2v2h-2zm0 3h2v2h-2zM8 6h2v2H8zm0 3h2v2H8zM5 9h2v2H5zm0-3h2v2H5zm3 6h8v2H8zm6-3h2v2h-2zm0-3h2v2h-2zm3 3h2v2h-2zm0-3h2v2h-2zm-5 17l4-4H8z"})})}),e("div",{className:K.configIcon,onClick:()=>p("/workbench/setting")})]})})}const Vt="_headerFilter_eq3rn_1",Qt="_headerConfig_eq3rn_2",jt="_headerRefresh_eq3rn_3",Kt="_headerNewFold_eq3rn_4",Gt="_headerNewFile_eq3rn_5",Zt="_createRowWrapper_eq3rn_25",Jt="_createRow_eq3rn_25",Xt="_btn_eq3rn_44",es="_graphqlEntry_eq3rn_48",ts="_treeContainer_eq3rn_59",ss="_treeItem_eq3rn_117",as="_title_eq3rn_117",ns="_treeItemDir_eq3rn_126",os="_icon_eq3rn_126",is="_treeItemFile_eq3rn_130",rs="_treeItemErr_eq3rn_134",ls="_lighting_eq3rn_138",us="_treeItemDisable_eq3rn_144",cs="_suffix_eq3rn_177",ds="_errLabel_eq3rn_182",hs="_more_eq3rn_195",ps="_method_eq3rn_205",ms="_method_get_eq3rn_210",fs="_method_post_eq3rn_213",D={headerFilter:Vt,headerConfig:Qt,headerRefresh:jt,headerNewFold:Kt,headerNewFile:Gt,createRowWrapper:Zt,createRow:Jt,btn:Xt,graphqlEntry:es,treeContainer:ts,treeItem:ss,title:as,treeItemDir:ns,icon:os,treeItemFile:is,treeItemErr:rs,lighting:ls,treeItemDisable:us,suffix:cs,errLabel:ds,more:hs,method:ps,method_get:ms,method_post:fs},gs="_container_1sy73_1",vs="_active_1sy73_9",_s="_header_1sy73_16",bs="_arrow_1sy73_26",ys="_headerOpen_1sy73_33",ks="_title_1sy73_36",As="_add_1sy73_47",ws="_action_1sy73_53",Fs="_content_1sy73_60",te={container:gs,active:vs,header:_s,arrow:bs,headerOpen:ys,title:ks,add:As,action:ws,content:Fs};function Ve(s){const a=le(),[o,d]=n.exports.useState(!1),p=n.exports.useRef(null);n.exports.useEffect(()=>{s.open!==void 0?b(s.open):s.defaultOpen&&b(!0)},[s.defaultOpen,s.open]),n.exports.useEffect(()=>{var f;s.scrollBottom!==void 0&&(f=p==null?void 0:p.current)!=null&&f.scrollTop&&(p.current.scrollTop=1e6)},[s.scrollBottom]);const b=f=>{d(f),s.onOpen&&s.onOpen(f)};return l("div",{className:`${te.container} ${o?te.active:""}`,children:[l("div",{className:`${te.header} ${o?te.headerOpen:""}`,onClick:f=>b(!o),children:[e("div",{className:te.arrow}),e("div",{className:te.title,children:s.title}),l("div",{className:te.action,onClick:f=>f.stopPropagation(),children:[s.action?s.action:null,s.hideAdd?null:e(ne,{title:a.formatMessage({id:"tVoPUq",defaultMessage:[{type:0,value:"\u65B0\u5EFA"}]}),children:e("div",{className:te.add,onClick:s.onAdd})})]})]}),e("div",{ref:p,className:`${o?"":"hidden"} ${te.content}`,children:s.children})]})}function Ms(s){const a=le(),{config:o}=Se(),d=Ae(),p=de(),[b,f]=n.exports.useState(null),[r,F]=n.exports.useState([]),[C,y]=n.exports.useState([]),[x,B]=n.exports.useState(null),[E,I]=n.exports.useState(""),[k,A]=n.exports.useState(!1),[q,$]=n.exports.useState(!1),[V,P]=n.exports.useState(!1),[X,z]=n.exports.useState(),[G,j]=n.exports.useState([]),[oe,i]=n.exports.useState(),[w,m]=n.exports.useState(),g=n.exports.useMemo(()=>x?Pe(x,r):null,[x,r]),O=n.exports.useMemo(()=>{var c;const t={},h=[...r];for(;h.length;){const _=h.pop();!_||((c=_.children)!=null&&c.length&&h.push(..._.children),t[_.key]=_)}return t},[r]),L=n.exports.useMemo(()=>C.map(t=>O[t]).filter(t=>t),[C,O]),{refreshMap:v,navCheck:Z,triggerPageEvent:u}=n.exports.useContext(he);n.exports.useEffect(()=>{const t=ce("alt+n,^+n",()=>{me("\u521B\u5EFA\u6587\u4EF6")}),h=ce("alt+b,^+b",()=>{d("/workbench/apimanage/crud")});return()=>{t(),h()}},[]),n.exports.useEffect(()=>{var t,h;if(!p.pathname.match(/^\/workbench\/apimanage(?:\/\d*)?$/))y([]);else if(r){const c=Number((h=((t=p.pathname.match(/\/apimanage\/(\d+)/))!=null?t:[])[1])!=null?h:0);if(c){const _=$e(c,r);_&&y([_.key])}}},[p]),n.exports.useEffect(()=>{s.defaultOpen&&P(!0)},[s.defaultOpen]),n.exports.useEffect(()=>{X&&(me(X),z(void 0))},[r]);const{data:U,mutate:Q}=Ue();n.exports.useEffect(()=>{var c,_;const t=Ne(U!=null?U:[],"0");F(t);const h=Number((_=((c=p.pathname.match(/\/apimanage\/(\d+)/))!=null?c:[])[1])!=null?_:0);if(h){const S=$e(h,t);Xe(t,h),S&&y([S.key])}},[U]),n.exports.useEffect(()=>{Q()},[V,v.api]),n.exports.useEffect(()=>{if(g){const t=Cs(r);if(!t)return;B(t.key)}},[r]),n.exports.useEffect(()=>{!k&&q&&(f(null),B(null),Q()),$(!1)},[k,q]);const Qe=n.exports.useCallback((t,h)=>{(async()=>{let{node:c}=h;if(h.nativeEvent.shiftKey){let _;if(C.includes(c.key)?(_=C.filter(S=>S!==c.key),y(_)):(_=[...C,c.key],y(_)),_.length!==1)return;{const S=Pe(_[0],r);if(!S)return;c=S}}!await Z()||(y([]),c.isDir?d("/workbench/apimanage",{replace:!0}):d(`/workbench/apimanage/${c.id}`,{replace:!0}),c.key!==C[0]?y([c.key]):y([]))})()},[Z,C]);function je(t){if(t.inlegal)return e("div",{className:D.errLabel,children:e(M,{id:"n6o1H/",defaultMessage:[{type:0,value:"\u975E\u6CD5"}]})});if(!t.isPublic)return e(M,{id:"ptadMC",defaultMessage:[{type:0,value:"\u5185\u90E8"}]})}const Ke=n.exports.useCallback(t=>I(t.target.value),[]),Ge=n.exports.useCallback(t=>{t.stopPropagation()},[]),me=t=>{var ee,Y;if(C.length>1){T.error(a.formatMessage({id:"OPt+As",defaultMessage:[{type:0,value:"\u53EA\u80FD\u9009\u62E9\u4E00\u4E2A\u8282\u70B9"}]}));return}if(!V){z(t),P(!0);return}f(t);const{parent:h,curr:c}=Bs(C[0],r),_={title:"",baseDir:(ee=c==null?void 0:c.currDir)!=null?ee:"",isDir:t==="\u521B\u5EFA\u76EE\u5F55",key:Date.now().toString()};(c==null?void 0:c.children)===null&&(c.children=[]);const S=r!=null?r:[];let R;c!=null&&c.isDir?R=c:h&&(R=h),R?((Y=R.children)==null||Y.push(_),G.includes(R.key)||j([...G,R.key])):S.push(_),m(!w),I(""),B(_.key),F([...S])},De=(t,h=!1)=>Ce(t[0])?t.match(/^\w[a-zA-Z0-9]*$/)?!0:(T.error(a.formatMessage({id:"gxjC5l",defaultMessage:[{type:0,value:"\u8BF7\u8F93\u5165\u5B57\u6BCD\u6216\u6570\u5B57"}]})),!1):(T.error(a.formatMessage({id:"jGexDU",defaultMessage:[{type:0,value:"\u63A5\u53E3\u540D\u79F0\u5FC5\u987B\u5927\u5199\u5F00\u5934"}]})),!1),Me=t=>t?t.filter(h=>(h.children&&(h.children=Me(h.children)),h.id!==void 0)):(F(r.filter(h=>(h.children&&(h.children=Me(h.children)),h.id!==void 0))),r),Ie=()=>{if(!g){f(null);return}if(!!De(E,g.isDir))switch(b){case"\u91CD\u547D\u540D":if(g.isDir)Es(g,E).then(t=>{B(null),Q()});else{if(!Ce(E[0])){T.error(a.formatMessage({id:"jGexDU",defaultMessage:[{type:0,value:"\u63A5\u53E3\u540D\u79F0\u5FC5\u987B\u5927\u5199\u5F00\u5934"}]}));return}xs(g,E).then(t=>{B(null),t&&be.emit({event:"titleChange",data:{title:E,path:`${g.baseDir}/${E}`}}),Q()})}break;case"\u521B\u5EFA\u76EE\u5F55":Ss(g,E).then(()=>{B(null),Q()});break;case"\u521B\u5EFA\u6587\u4EF6":He(E)?(B(null),Q()):Ce(E.at(0))?(Ze(),g.title=E):T.warn(a.formatMessage({id:"Tm3YfU",defaultMessage:[{type:0,value:"\u63A5\u53E3\u540D\u79F0\u5FC5\u987B\u5927\u5199\u5F00\u5934\uFF01"}]}));break}},Ze=()=>{if(b==="\u521B\u5EFA\u6587\u4EF6"){if(!g)return;Ds(g,E).then(t=>{t!=null&&t.id&&(d(`/workbench/apimanage/${t==null?void 0:t.id}`),B(null),Q())}).catch(t=>{f("\u521B\u5EFA\u6587\u4EF6")})}f(null)},Re=t=>{var c;if(!!t.find(_=>`/workbench/apimanage/${_}`===p.pathname)){const _=[...r];for(;;){const S=_.shift();if(!S){d("/workbench/apimanage");return}if((c=S.children)!=null&&c.length){_.push(...S.children);continue}if(!S.isDir&&!t.includes(S.id)){d(`/workbench/apimanage/${S.id}`);return}}}},Je=t=>{f(null),Ns(t).then(()=>{B(null),Q(),localStorage.removeItem(`_api_args_${t.id}`),Re([t.id])})},Xe=(t,h)=>{const c=[];let _;for(let R=0;R<t.length;R++){const ee=t[R];if(_=S(ee),_)break}function S(R){if(!R.isDir&&(!h||h===R.id))return R;if(R.children){const ee=R.children.find(S);if(ee)return c.push(R.key),ee}}return _?(j(_t([...G,...c])),_):!1};async function Le(t){const h=T.loading(a.formatMessage({id:"QpRtOT",defaultMessage:[{type:0,value:"\u6267\u884C\u4E2D"}]})),c=L.map(_=>_.id);try{await N.post("operateApi/batchOnline",{Ids:c,enable:t})}finally{h()}T.success(a.formatMessage({id:"V0RiZp",defaultMessage:[{type:0,value:"\u64CD\u4F5C\u6210\u529F"}]})),Q(),be.emit({event:"apiEnableChange",data:{ids:c,enable:t}})}const et=t=>{var R,ee;const h=je(t);let c;t.isDir?c=D.treeItemDir:t.inlegal?c=D.treeItemErr:t.enable?c=D.treeItemFile:c=D.treeItemDisable;let _=[{key:"rename",label:l("div",{onClick:()=>{B(t.key),I(t.title),f("\u91CD\u547D\u540D")},children:[e("img",{alt:"zhongmingming",src:"assets/iconfont/zhongmingming.svg",style:{height:"1em",width:"1em"}}),l("span",{className:"ml-1.5",children:[e(M,{id:"JeJAmT",defaultMessage:[{type:0,value:"\u91CD\u547D\u540D"}]})," "]})]})},{key:"delete",label:e("div",{onClick:Y=>Y.stopPropagation(),children:l(Ye,{zIndex:9999,title:a.formatMessage({id:"9Fxs0Y",defaultMessage:[{type:0,value:"\u786E\u5B9A\u5220\u9664\u5417?"}]}),onConfirm:()=>{Je(t),i(void 0)},onCancel:()=>{i(void 0)},okText:a.formatMessage({id:"XeiAal",defaultMessage:[{type:0,value:"\u5220\u9664"}]}),cancelText:a.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"\u53D6\u6D88"}]}),placement:"right",children:[e("img",{alt:"shanchu",src:"assets/iconfont/shanchu.svg",style:{height:"1em",width:"1em"}}),e("span",{className:"ml-1.5",children:e(M,{id:"XeiAal",defaultMessage:[{type:0,value:"\u5220\u9664"}]})})]})})}];t.isDir&&(_=_.filter(Y=>Y.key!=="edit"));const S=e(ke,{onClick:Y=>{Y.key!=="delete"&&i(void 0)},items:_});return l("div",{className:`${D.treeItem} ${c}`,children:[e("div",{className:D.icon,children:t.liveQuery?e("div",{className:D.lighting}):null}),x&&t.key===x?e(ze,{size:"small",defaultValue:t.title,onPressEnter:Ie,onBlur:()=>{E&&De(E,g==null?void 0:g.isDir)?Ie():(B(null),Me())},onChange:Ke,autoFocus:!0,onClick:Ge}):l(J,{children:[e("div",{className:`${D.method} ${D[`method_${(R=t.method)==null?void 0:R.toLowerCase()}`]}`,children:(ee=t.method)==null?void 0:ee.toUpperCase()}),e("div",{className:D.title,children:t.title}),e("div",{className:D.suffix,children:h}),e("div",{onClick:Y=>Y.stopPropagation(),children:e(ye,{open:oe===t.key,onOpenChange:Y=>{i(Y?t.key:void 0)},destroyPopupOnHide:!0,overlay:S,trigger:["click"],placement:"bottomRight",children:e("div",{className:D.more,onClick:Y=>Y.preventDefault()})})})]})]})};return l(Ve,{...s,title:a.formatMessage({id:"zQEdCX",defaultMessage:[{type:0,value:"API\u7BA1\u7406"}]}),hideAdd:!0,scrollBottom:w,open:V,onOpen:t=>{P(t),s.onOpen&&s.onOpen(t)},action:l(J,{children:[e(ne,{title:a.formatMessage({id:"IQIvYd",defaultMessage:[{type:0,value:"\u5237\u65B0\u5217\u8868"}]}),children:e("div",{className:D.headerRefresh,onClick:()=>{tt("/operateApi").then(t=>F(Ne(t))).then(()=>T.success(a.formatMessage({id:"BOZ5lK",defaultMessage:[{type:0,value:"\u5237\u65B0\u5B8C\u6210\uFF01"}]}))).catch(t=>{throw T.error(a.formatMessage({id:"V8c5V8",defaultMessage:[{type:0,value:"\u83B7\u53D6\u6587\u4EF6\u5217\u8868\u5931\u8D25\uFF01"}]})),t})}})}),e(ne,{title:a.formatMessage({id:"aI3L5g",defaultMessage:[{type:0,value:"\u5168\u5C40\u8BBE\u7F6E"}]}),children:e("div",{className:D.headerConfig,onClick:()=>A(!0)})}),e(ne,{title:a.formatMessage({id:"QarRBC",defaultMessage:[{type:0,value:"\u65B0\u5EFAAPI"}]}),children:e("div",{className:D.headerNewFile,onClick:()=>me("\u521B\u5EFA\u6587\u4EF6")})})]}),children:[e(ye,{overlay:e(ke,{items:[{disabled:!L.some(t=>!t.enable),key:"enable",label:e("div",{onClick:()=>{!L.some(t=>!t.enable)||Le(!0)},children:e(M,{id:"WiL7+z",defaultMessage:[{type:0,value:"\u4E0A\u7EBF"}]})})},{disabled:!L.some(t=>t.enable),key:"disable",label:e("div",{onClick:()=>{!L.some(t=>t.enable)||Le(!1)},children:e(M,{id:"MFe3Kw",defaultMessage:[{type:0,value:"\u4E0B\u7EBF"}]})})},{disabled:!L.length,key:"delete",label:e("div",{onClick:()=>{y([]),ue.confirm({title:a.formatMessage({id:"JJvpR5",defaultMessage:[{type:0,value:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u9009\u4E2D\u7684API\uFF1F"}]}),onOk:()=>{const t=L.map(h=>h.id).filter(h=>h);N.post("operateApi/batchDelete",{ids:t}).then(()=>{t.forEach(h=>localStorage.removeItem(`_api_args_${h}`)),T.success(a.formatMessage({id:"aiBGBs",defaultMessage:[{type:0,value:"\u5220\u9664\u6210\u529F"}]})),Re(t),Q()})},okText:a.formatMessage({id:"FEb7U2",defaultMessage:[{type:0,value:"\u786E\u8BA4"}]}),cancelText:a.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"\u53D6\u6D88"}]})})},children:e(M,{id:"XeiAal",defaultMessage:[{type:0,value:"\u5220\u9664"}]})})},{key:"cancel",label:e("div",{onClick:()=>{y([])},children:e(M,{id:"2QzYmY",defaultMessage:[{type:0,value:"\u53D6\u6D88"}]})})}]}),trigger:["contextMenu"],children:l("div",{className:"flex flex-col h-full justify-between",children:[l("div",{className:D.treeContainer,children:[r.length?e(vt,{rootClassName:"overflow-auto",titleRender:et,showIcon:!0,defaultExpandParent:!0,expandedKeys:G,onExpand:j,treeData:r,multiple:!0,selectedKeys:C,onSelect:Qe}):null,x&&["\u521B\u5EFA\u6587\u4EF6","\u521B\u5EFA\u76EE\u5F55"].includes(b!=null?b:"")&&e("div",{style:{height:12}})]}),l("div",{className:D.createRowWrapper,children:[l("div",{className:D.createRow,children:[e("span",{className:D.btn,onClick:()=>me("\u521B\u5EFA\u6587\u4EF6"),children:e(M,{id:"tVoPUq",defaultMessage:[{type:0,value:"\u65B0\u5EFA"}]})}),l("span",{children:[" ",e(M,{id:"/g7pR0",defaultMessage:[{type:0,value:"\u6216\u8005"}]})," "]}),e("span",{className:D.btn,onClick:()=>d("/workbench/apimanage/crud"),children:e(M,{id:"SJbKgr",defaultMessage:[{type:0,value:"\u6279\u91CF\u65B0\u5EFA"}]})})]}),e(ne,{title:a.formatMessage({id:"mPsm6o",defaultMessage:[{type:0,value:"\u6D4B\u8BD5"}]}),children:e("div",{className:D.graphqlEntry,onClick:()=>{const t=new URL(window.location.href);o.apiHost?window.open(`${t.protocol}//localhost:${t.port}/app/main/graphql`,"_blank"):window.open(`${t.protocol}//${t.hostname}:${o.apiPort}/app/main/graphql`,"_blank")},children:e("img",{alt:"",src:"/assets/icon/graphql2.svg"})})})]})]})}),e(ue,{title:a.formatMessage({id:"Uzsm7t",defaultMessage:[{type:0,value:"API\u5168\u5C40\u8BBE\u7F6E"}]}),open:k,onOk:()=>{A(!1)},onCancel:()=>{A(!1)},footer:null,centered:!0,destroyOnClose:!0,children:e(pt,{type:"global",onClose:()=>A(!1)})})]})}function Ne(s,a="0"){return s?s.map((o,d)=>({...o,key:`${a}-${d}`,title:o.path.split("/")[o.path.split("/").length-1],baseDir:o.path.split("/").slice(0,-1).join("/"),currDir:o.isDir?o.path:o.path.split("/").slice(0,-1).join("/"),children:Ne(o.children,`${a}-${d}`)})):[]}function Cs(s){let a;const o=d=>{!d||d.find(p=>{var b;return p.title===""?(a=p,p):o((b=p.children)!=null?b:void 0)})};return o(s),a}function $e(s,a){let o;const d=(p,b)=>{!b||b.find(f=>{var r;return f.id===s?(o=f,f):d(p,(r=f.children)!=null?r:void 0)})};return d(s,a),o}function Pe(s,a){let o;const d=(p,b)=>{!b||b.find(f=>{var r;return f.key===p?(o=f,f):d(p,(r=f.children)!=null?r:void 0)})};return d(s,a),o}function Es(s,a){return N.put("/operateApi/dir",{oldPath:`${s.path}`,newPath:`${s.baseDir}/${a}`})}function xs(s,a){return N.put(`/operateApi/rename/${s.id}`,{path:`${s.baseDir}/${a}`}).catch(o=>{console.error(o)})}function Bs(s,a){let o,d;const p=(b,f)=>{if(!f)return[];o=void 0,f.find(r=>{var F;return r.key===b?(d=r,[o,d]):(He(r.children)||(o=r),p(b,(F=r.children)!=null?F:void 0))})};return p(s,a),o=d?o:void 0,{parent:o,curr:d}}function Ns(s){return s.isDir?N.delete("/operateApi/dir",{data:{path:s.path}}):N.delete(`/operateApi/${s.id}`)}function Ss(s,a){return N.post("/operateApi/dir",{path:`${s.baseDir}/${a}`})}function Ds(s,a){return N.post("/operateApi",{path:`${s.baseDir}/${a}`})}function Is(s,a){switch(a.type){case"fetched":return a.data;case"selected":return s;case"added":return[...s,a.data];case"changed":return s.map(o=>o.id===a.data.id?a.data:o);case"deleted":return s.filter(o=>o.id!==a.data.id);default:return s}}const Rs="_container_18kpt_1",Ls="_row_18kpt_4",Os="_active_18kpt_16",$s="_rowDisable_18kpt_30",Ps="_icon_18kpt_30",qs="_title_18kpt_33",zs="_tip_18kpt_52",Us="_more_18kpt_59",se={container:Rs,row:Ls,active:Os,rowDisable:$s,icon:Ps,title:qs,tip:zs,more:Us};function xe(s){var oe;const a=le(),{mutate:o}=yt(),{mutate:d}=At(),{mutate:p}=We(),{mutate:b}=kt(),f=n.exports.useMemo(()=>({dataSource:{title:a.formatMessage({id:"C5D7TM",defaultMessage:[{type:0,value:"\u6570\u636E\u6E90"}]}),openItem:i=>`/workbench/data-source/${i}`,newItem:"/workbench/data-source/new",request:{getList:i=>{b(),N.get("/dataSource").then(w=>{i({type:"fetched",data:w.map(m=>{var v,Z;let g="other",O="/assets/icon/db-other.svg",L="";switch(m.sourceType){case 1:if(L=String(m.config.dbName||""),typeof m.config.databaseUrl=="object"&&((v=m.config.databaseUrl)==null?void 0:v.val)){const u=(Z=wt(m.config.databaseUrl.val))==null?void 0:Z.dbName;u&&(L=u)}O={mysql:"/assets/icon/mysql.svg",pgsql:"/assets/icon/pg.svg",graphql:"/assets/icon/graphql.svg",mongodb:"/assets/icon/mongodb.svg",rest:"/assets/icon/rest.svg",sqlite:"/assets/icon/sqlite.svg"}[String(m.config.dbType).toLowerCase()]||O;break;case 2:O="/assets/icon/rest.svg";break;case 3:O="/assets/icon/graphql.svg";break}return{id:m.id,name:m.name,icon:g,tip:L,switch:m.switch,_row:m,svg:O}})})})},editItem:async i=>await N.put("/dataSource",i),delItem:async i=>await N.delete(`/dataSource/${i}`)},mutateKey:i=>["/dataSource",String(i)]},storage:{title:a.formatMessage({id:"E6yn6S",defaultMessage:[{type:0,value:"\u6587\u4EF6\u5B58\u50A8"}]}),openItem:i=>`/workbench/storage/${i}/manage`,newItem:"/workbench/storage/new",request:{getList:i=>{d(),N.get("/storageBucket").then(w=>{i({type:"fetched",data:(w!=null?w:[]).map(m=>{const g="other",O="";return{id:m.id,name:m.name,icon:g,tip:O,switch:m.switch,_row:m,svg:"/assets/icon/file.svg"}})})})},editItem:async i=>await N.put("/storageBucket",i),delItem:async i=>await N.delete(`/storageBucket/${i}`)},mutateKey:i=>["/dataSource",String(i)],navMenu:[{icon:"assets/iconfont/wenjian1.svg",name:a.formatMessage({id:"cDZ00w",defaultMessage:[{type:0,value:"\u67E5\u770B"}]}),menuPath:i=>`/workbench/storage/${i}`}]},auth:{title:a.formatMessage({id:"UEiMSy",defaultMessage:[{type:0,value:"\u8EAB\u4EFD\u9A8C\u8BC1"}]}),openItem:i=>`/workbench/auth/${i}`,newItem:"/workbench/auth/new",navAction:[{icon:"/assets/workbench/panel-role.png",path:"/workbench/auth/role",tooltip:a.formatMessage({id:"WWNrrS",defaultMessage:[{type:0,value:"\u6743\u9650\u7BA1\u7406"}]})}],mutateKey:i=>["/auth",String(i)],request:{getList:i=>{p(),N.get("/auth").then(w=>{const m=w.map(g=>{var v;const O="other",L="OIDC";return{id:g.id,name:g.name,icon:O,tip:L,switch:!!((v=g.switchState)!=null&&v.length),_row:g,svg:"/assets/icon/oidc.svg"}});i({type:"fetched",data:m})})},editItem:async i=>await N.put("/auth",i),delItem:async i=>await N.delete(`/auth/${i}`)}}}),[a]),r=n.exports.useMemo(()=>f[s.type],[s.type,a]),F=Ae(),C=de(),[y,x]=n.exports.useState(),[B,E]=n.exports.useState(),[I,k]=n.exports.useReducer(Is,[]),{refreshMap:A,navCheck:q}=n.exports.useContext(he),[$,V]=n.exports.useState(!1),P=A[s.type];n.exports.useEffect(()=>{!$||r.request.getList(k)},[s.type,P,$]);const X=i=>{const w=[{key:"rename",label:l("div",{onClick:()=>x(i),children:[e("img",{alt:"zhongmingming",src:"assets/iconfont/zhongmingming.svg",style:{height:"1em",width:"1em"}}),e("span",{className:"ml-1.5",children:e(M,{id:"JeJAmT",defaultMessage:[{type:0,value:"\u91CD\u547D\u540D"}]})})]})},{key:"delete",label:e(Ye,{zIndex:9999,placement:"right",title:a.formatMessage({id:"I0f7tt",defaultMessage:[{type:0,value:"\u786E\u8BA4\u5220\u9664\u5417\uFF1F"}]}),onConfirm:()=>void z(B),okText:a.formatMessage({id:"XeiAal",defaultMessage:[{type:0,value:"\u5220\u9664"}]}),cancelText:a.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"\u53D6\u6D88"}]}),overlayClassName:se["delete-label"],okType:"danger",children:l("div",{children:[e("img",{alt:"a-shanchu2",src:"assets/iconfont/a-shanchu2.svg",style:{height:"1em",width:"1em"}}),e("span",{className:"ml-1.5",children:e(M,{id:"XeiAal",defaultMessage:[{type:0,value:"\u5220\u9664"}]})})]})})}];return r.navMenu&&w.unshift(...r.navMenu.map(m=>({key:m.name,label:l("div",{onClick:()=>F(m.menuPath(i.id)),children:[e("img",{alt:"",src:m.icon,style:{height:"1em",width:"1em"}}),e("span",{className:"ml-1.5",children:m.name})]},i.id)}))),e(ke,{onClick:m=>{m.key!=="delete"&&E(void 0)},items:w})},z=async i=>{if(!!i&&(await r.request.delItem(i),r.request.getList(k),E(void 0),r.openItem(i)===C.pathname)){const w=I.findIndex(m=>m.id!==i);w>=0?j(I[w]):F(r.newItem)}},G=async i=>{const w=y==null?void 0:y._row;if(w!==void 0){if(!i.match(/^\w[a-zA-Z0-9_]*$/)){T.error(a.formatMessage({id:"0o/d0Y",defaultMessage:[{type:0,value:"\u8BF7\u8F93\u5165\u5B57\u6BCD\u3001\u6570\u5B57\u6216\u4E0B\u5212\u7EBF"}]}));return}w.name=i,await r.request.editItem(w),r.request.getList(k),x(void 0),await o(r.mutateKey(String(y==null?void 0:y.id)))}},j=i=>{if(i.openInNewPage){window.open(i.openInNewPage);return}const w=r.openItem(i.id);q().then(m=>{m&&F(w)})};return e(Ve,{title:r.title,onAdd:()=>F(r.newItem),onOpen:i=>V(i),defaultOpen:s.defaultOpen,action:e(J,{children:(oe=r.navAction)==null?void 0:oe.map(i=>l(ne,{title:i.tooltip,children:[e("div",{className:"flex mr-1.5",onClick:()=>F(i.path),children:e("img",{width:19,height:19,src:i.icon,alt:"\u5934\u50CF"})})," "]},i.path))}),children:e("div",{className:se.container,children:I.map(i=>{var m;const w=r.openItem(i.id);return l("div",{className:`${se.row} ${i.switch?"":se.rowDisable} ${w===C.pathname?se.active:""}`,onClick:()=>j(i),children:[e("div",{className:se.icon,children:e(bt,{width:12,height:12,preview:!1,alt:i.name,src:(m=i.svg)!=null?m:"/assets/icon/github-fill.svg"})}),(y==null?void 0:y.id)===i.id?e(ze,{onPressEnter:g=>void G(g.target.value),onBlur:g=>void G(g.target.value),onKeyUp:g=>{g.key=="Escape"&&x(void 0)},className:"font-normal h-5 text-sm leading-4 w-5/7",defaultValue:y.name,autoFocus:!0,placeholder:a.formatMessage({id:"nooQRz",defaultMessage:[{type:0,value:"\u8BF7\u8F93\u5165\u5916\u90E8\u6570\u636E\u6E90\u540D"}]})}):e("div",{className:se.title,children:i.name}),e("div",{className:se.tip,children:i.tip}),!i.disableMenu&&e("div",{onClick:g=>g.stopPropagation(),children:e(ye,{overlay:X(i),trigger:["click"],open:B===i.id,onOpenChange:g=>{E(g?i.id:void 0)},placement:"bottomRight",children:e("div",{className:se.more,onClick:g=>g.preventDefault()})})})]},i.id)})})})}const Ys="_container_xritx_1",Hs="_tabs_xritx_6",Ts="_tabs_inner_xritx_11",Ws="_tabs_tab_xritx_19",Vs="_tabs_tab__active_xritx_30",Qs="_apiIcon_xritx_36",js="_dataIcon_xritx_42",Ks="_panels_xritx_60",ae={container:Ys,tabs:Hs,tabs_inner:Ts,tabs_tab:Ws,tabs_tab__active:Vs,apiIcon:Qs,dataIcon:js,panels:Ks},Gs=we.lazy(()=>Fe(()=>import("./index.17d0be80.js"),["assets/index.17d0be80.js","assets/fireboom-prisma-ast.esm.6ae74454.js","assets/index.e5e6c754.js","assets/index.384edb68.css","assets/_createAggregator.87a98d7b.js","assets/get.131f9f4f.js","assets/_baseGet.6a7418c9.js","assets/_baseClone.e2094da0.js","assets/flatten.8e198855.js","assets/_baseSet.aed078ba.js","assets/uniq.2129c997.js","assets/_baseUniq.d23dbdee.js","assets/difference.6d57e3ed.js","assets/groupBy.88271069.js","assets/ModelingHelpers.b83dc1e3.js","assets/PrismaSchemaContext.c1116ab6.js","assets/pannel.module.e5b79f38.js","assets/pannel.e359a1f4.css","assets/printer.b0e2956d.js","assets/printer.3ab34835.css","assets/DownOutlined.75881d1e.js","assets/KeyCode.9c493596.js","assets/index.b6cece06.js","assets/index.6edff92c.css","assets/iconUtil.31c13224.js","assets/iconUtil.0f5769c3.css","assets/pickAttrs.c5bbb5fc.js","assets/Overflow.321ca619.js","assets/index.5e1fa168.js","assets/index.3603af3c.css","assets/index.daad23d2.js","assets/index.esm.e5edd667.js","assets/conductUtil.03f406cc.js","assets/conductUtil.5824820e.css","assets/RightOutlined.73e4cc97.js","assets/index.e54b5c9c.js","assets/index.67bc873e.js","assets/index.50ece414.css","assets/index.6fa46df0.js","assets/index.698d0db5.css","assets/index.6f73eb32.js","assets/index.39f6a8a8.css","assets/DialogWrap.947e0e2f.js","assets/use-immer.module.1d9a0526.js"])),qe={api:"/workbench",data:"/workbench/modeling"};function Zs(){const[s,a]=n.exports.useState(""),o=de(),d=Ae();n.exports.useContext(he),n.exports.useEffect(()=>ce("alt+m,^+m",()=>{o.pathname.startsWith("/workbench/modeling")?d("/workbench"):d("/workbench/modeling"),a(s)}),[]),n.exports.useEffect(()=>{const x=o.pathname.startsWith("/workbench/modeling")?"data":"api";a(x)},[o.pathname]);const{panel:p}=n.exports.useContext(gt),{handleToggleDesigner:b,handleClickEntity:f,handleChangeSource:r,setShowType:F,dataSources:C}=p||{},y=x=>{qe[s]=o.pathname,d(qe[x])};return l("div",{className:"flex flex-col h-full",children:[e("div",{className:ae.tabs,children:l("div",{className:ae.tabs_inner,children:[l("div",{className:`${ae.tabs_tab} ${s==="api"?ae.tabs_tab__active:""}`,onClick:()=>{y("api")},children:[e("div",{className:ae.apiIcon}),e(M,{id:"aj1rA6",defaultMessage:[{type:0,value:"API\u8BBE\u8BA1"}]})]}),l("div",{className:`${ae.tabs_tab}  ${s==="data"?ae.tabs_tab__active:""}`,onClick:()=>{y("data")},children:[e("div",{className:ae.dataIcon}),e(M,{id:"ueuJlz",defaultMessage:[{type:0,value:"\u6570\u636E\u5EFA\u6A21"}]})]})]})}),s==="api"?l("div",{className:ae.panels,children:[e(Ms,{defaultOpen:o.pathname.startsWith("/workbench/apimanage/")}),e(xe,{type:"dataSource",defaultOpen:o.pathname.startsWith("/workbench/data-source/")}),e(xe,{type:"auth",defaultOpen:o.pathname.startsWith("/workbench/auth/")}),e(xe,{type:"storage",defaultOpen:o.pathname.startsWith("/workbench/storage/")})]}):null,s==="data"&&p?e(n.exports.Suspense,{children:e(Gs,{setShowType:F,changeToER:()=>F("erDiagram"),addNewModel:()=>F("newModel"),addNewEnum:()=>F("newEnum"),sourceOptions:C,onChangeSource:x=>r(x),onClickEntity:f,onToggleDesigner:b})}):null]})}const Js="_info_1xof0_9",Xs="_gitIcon_1xof0_17",ea="_errLabel_1xof0_23",ta="_split_1xof0_27",sa="_hookEntry_1xof0_33",aa="_statusLabel_1xof0_36",na="_hookMask_1xof0_39",oa="_hookContainer_1xof0_47",H={"status-bar":"_status-bar_1xof0_1",info:Js,gitIcon:Xs,errLabel:ea,split:ta,hookEntry:sa,statusLabel:aa,hookMask:na,hookContainer:oa},ia=we.lazy(()=>Fe(()=>import("./index.efdf9744.js"),["assets/index.efdf9744.js","assets/index.e5e6c754.js","assets/index.384edb68.css","assets/iconUtil.31c13224.js","assets/iconUtil.0f5769c3.css","assets/KeyCode.9c493596.js","assets/pickAttrs.c5bbb5fc.js","assets/Overflow.321ca619.js","assets/DownOutlined.75881d1e.js","assets/index.5e1fa168.js","assets/index.3603af3c.css","assets/index.daad23d2.js"])),ra=({className:s,env:a,version:o,startTime:d,engineStatus:p,hookStatus:b,toggleWindow:f})=>{var m,g,O,L;const r=le(),F=Mt(),{questions:C}=Te(v=>({questions:v.questions})),y=n.exports.useMemo(()=>({[W.Building]:r.formatMessage({id:"T0bxDG",defaultMessage:[{type:0,value:"\u7F16\u8BD1\u4E2D"}]}),[W.Starting]:r.formatMessage({id:"h3R9PB",defaultMessage:[{type:0,value:"\u542F\u52A8\u4E2D"}]}),[W.Started]:r.formatMessage({id:"PpQOV5",defaultMessage:[{type:0,value:"\u5DF2\u542F\u52A8"}]}),[W.StartFailed]:r.formatMessage({id:"Xz2JYA",defaultMessage:[{type:0,value:"\u542F\u52A8\u5931\u8D25"}]}),[W.BuildFailed]:r.formatMessage({id:"rbmyiL",defaultMessage:[{type:0,value:"\u7F16\u8BD1\u5931\u8D25"}]}),[W.Built]:r.formatMessage({id:"Zz7nBV",defaultMessage:[{type:0,value:"\u5DF2\u7F16\u8BD1"}]}),[W.NotStarted]:r.formatMessage({id:"GbiB/D",defaultMessage:[{type:0,value:"\u672A\u542F\u52A8"}]})}),[r]),x=n.exports.useMemo(()=>({[ie.Running]:r.formatMessage({id:"PpQOV5",defaultMessage:[{type:0,value:"\u5DF2\u542F\u52A8"}]}),[ie.Stopped]:r.formatMessage({id:"GbiB/D",defaultMessage:[{type:0,value:"\u672A\u542F\u52A8"}]})}),[r]),[B,E]=n.exports.useState(),[I,k]=n.exports.useState(),[A,q]=n.exports.useState(),[$,V]=n.exports.useState(),[P,X]=n.exports.useState(),{config:z,refreshConfig:G}=Se();n.exports.useState();const j=n.exports.useMemo(()=>{const v=new URL(window.location.href);return v.port="9123",v.origin+"/ws"},[window.location]);n.exports.useEffect(()=>{X((z==null?void 0:z.hooksServerURL)||localStorage.getItem("hooksServerURL")||""),z.hooksServerURL===j?V(1):z.hooksServerURL==="http://127.0.0.1:9992"?V(2):V(3)},[z.hooksServerURL,I]),n.exports.useEffect(()=>{I&&oe(P!=null?P:"")},[P,I]);const oe=n.exports.useCallback(st(async v=>{try{const Z=await N.get(`/hook/status?url=${encodeURIComponent(v)}`);q(Z)}catch(Z){console.error(Z)}},2e3),[]);n.exports.useEffect(()=>{if(!d)return;E(F(d));const v=setInterval(()=>{E(F(d))},6e4);return()=>{clearInterval(v)}},[d,F]);async function i(v){N.post("/setting",{key:"hooksServerURL",val:v}).then(()=>{G()})}const w=n.exports.useCallback(()=>{window.open("https://stackblitz.com/local","_blank")},[]);return e("div",{className:s,children:e("div",{className:H["status-bar"],children:l("span",{className:H.info,children:[e("span",{className:H["info-env"]+" mr-2",children:e("span",{children:a})}),l("span",{className:H["info-version"]+" mr-2",children:[e("span",{children:"FB:"}),e("span",{className:"",children:o})]}),e("span",{onClick:()=>{f("0")},className:H.errLabel+" mr-2 cursor-pointer",children:e("span",{children:e(M,{id:"608d8o",defaultMessage:[{type:0,value:"\u65E5\u5FD7"}]})})}),l("span",{onClick:()=>{f("1")},className:"cursor-pointer flex items-center",children:[l("span",{className:H.errLabel,children:[e("img",{height:14,width:14,src:"/assets/workbench/footer-error.png",alt:"\u9519\u8BEF"}),e("span",{className:"ml-2",children:C.filter(v=>v.model===Be.DatasourceQuestion).length})]}),l("span",{className:H.errLabel,style:{marginLeft:8},children:[e("img",{height:14,width:14,src:"/assets/workbench/footer-warning.png",alt:"\u8B66\u544A"}),e("span",{className:"ml-2",children:C.filter(v=>v.model!==Be.DatasourceQuestion).length})]})]}),l("span",{className:"ml-8",children:[" ",e(M,{id:"Ipvx+S",defaultMessage:[{type:0,value:"\u5F15\u64CE"}]}),":"," "]}),e("span",{className:H.errLabel,children:p===W.NotStarted?l(J,{children:[e("div",{className:"bg-[#cd3021] rounded-3px h-3px w-3px"}),e(ne,{open:!0,title:r.formatMessage({id:"eHYMSo",defaultMessage:[{type:0,value:"\u8BF7\u914D\u7F6E\u6216\u5F00\u542F\u6570\u636E\u6E90"}]}),children:e("span",{className:"ml-1 text-[#cd3021]",children:(m=y[p])!=null?m:""})})]}):p===W.BuildFailed||p===W.StartFailed?l(J,{children:[e("div",{className:"bg-[#cd3021] rounded-3px h-3px w-3px"}),e(ne,{open:!0,title:r.formatMessage({id:"XIRdkO",defaultMessage:[{type:0,value:"\u8BF7\u68C0\u67E5\u9879\u76EE\u914D\u7F6E\u5E76\u91CD\u542Ffireboom"}]}),children:e("span",{className:"ml-1 text-[#cd3021]",children:(g=y[p])!=null?g:""})})]}):l(J,{children:[e("div",{className:"bg-[#50C772] rounded-3px h-3px w-3px"}),e("span",{className:"ml-1 text-[#50C772]",children:(O=y[p])!=null?O:""})]})}),l("span",{className:"ml-4.5",children:[" ",e(M,{id:"UU3d6B",defaultMessage:[{type:0,value:"\u94A9\u5B50"}]}),":"," "]}),l("span",{className:H.errLabel+" cursor-pointer",children:[l("div",{className:"flex h-full items-center",onClick:()=>{$===1&&w()},children:[e("div",{className:"rounded-3px h-3px w-3px"+(b===ie.Running?" bg-[#50C772]":" bg-[#f0b763]")}),e("span",{className:"ml-1 "+(b===ie.Running?"text-[#50C772]":"text-[#f0b763]"),children:(L=x[b])!=null?L:""}),e("div",{className:"flex h-full pl-1 items-center",onClick:v=>{ve({channel:"engine",event:"getHookStatus"}),v.stopPropagation()},children:e("img",{alt:"",src:"assets/refresh.svg"})})]}),e("div",{className:H.split}),l("div",{className:"flex h-full items-center",onClick:()=>k(!0),children:[e("div",{className:H.hookEntry,children:$===1?"WebContainer":z.hooksServerURL}),e("div",{className:"mr-5px ml-8px",style:{transform:I?"rotate(180deg)":""},children:e("img",{alt:"",src:"/assets/hook-arrow.svg"})})]}),I&&l(J,{children:[e("div",{className:H.hookMask,onClick:v=>{v.stopPropagation(),k(!1)}}),l("div",{className:H.hookContainer+" common-form",onClick:v=>{v.stopPropagation()},children:[e(Ee.Group,{onChange:v=>{var U;V(v.target.value);const u=(U={1:j,2:"http://127.0.0.1:9992",3:P}[v.target.value])!=null?U:"";i(u)},value:$,children:l(Ft,{direction:"vertical",children:[l(Ee,{value:1,children:["WebContainer",(A==null?void 0:A.webContainer)===ie.Running&&e(fe,{className:"!ml-2",color:"success",children:e(M,{id:"PpQOV5",defaultMessage:[{type:0,value:"\u5DF2\u542F\u52A8"}]})}),(A==null?void 0:A.webContainer)===ie.Stopped&&e(fe,{className:"!ml-2",color:"warning",children:e(M,{id:"GbiB/D",defaultMessage:[{type:0,value:"\u672A\u542F\u52A8"}]})})]}),l(Ee,{value:3,children:[e(M,{id:"17LOYz",defaultMessage:[{type:0,value:"\u624B\u52A8\u8BBE\u7F6E"}]}),(A==null?void 0:A.customer)===ie.Running&&e(fe,{className:"!ml-2",color:"success",children:e(M,{id:"PpQOV5",defaultMessage:[{type:0,value:"\u5DF2\u542F\u52A8"}]})}),(A==null?void 0:A.customer)===ie.Stopped&&e(fe,{className:"!ml-2",color:"warning",children:e(M,{id:"GbiB/D",defaultMessage:[{type:0,value:"\u672A\u542F\u52A8"}]})})]})]})}),e(n.exports.Suspense,{children:e(ia,{className:"mt-2",selectClassName:"!z-13000",value:P,onChange:v=>{$===3&&i(v),X(v),localStorage.setItem("hooksServerURL",v)}})})]})]})]}),l("span",{className:"ml-4.5",children:[e(M,{id:"wZkLCJ",defaultMessage:[{type:0,value:"\u7F16\u8BD1\u65F6\u95F4"}]}),":"," "]}),e("span",{className:H.errLabel,children:e("span",{className:"ml-1 text-[#649FFF]",children:B})})]})})})},la=ra,ua=we.lazy(()=>Fe(()=>import("./modelingWrapper.25b04cbd.js"),["assets/modelingWrapper.25b04cbd.js","assets/index.e5e6c754.js","assets/index.384edb68.css","assets/index.esm.0df65c6e.js","assets/index.esm.e5edd667.js","assets/use-immer.module.1d9a0526.js","assets/ModelingHelpers.b83dc1e3.js","assets/fireboom-prisma-ast.esm.6ae74454.js","assets/_createAggregator.87a98d7b.js","assets/get.131f9f4f.js","assets/_baseGet.6a7418c9.js","assets/_baseClone.e2094da0.js","assets/flatten.8e198855.js","assets/_baseSet.aed078ba.js","assets/uniq.2129c997.js","assets/_baseUniq.d23dbdee.js","assets/difference.6d57e3ed.js","assets/groupBy.88271069.js","assets/PrismaSchemaContext.c1116ab6.js","assets/keyBy.400ebaf7.js","assets/ApolloClient.110d7b2d.js","assets/index.b6cece06.js","assets/index.6edff92c.css","assets/printer.b0e2956d.js","assets/printer.3ab34835.css","assets/DownOutlined.75881d1e.js","assets/KeyCode.9c493596.js"])),ca=we.lazy(()=>Fe(()=>import("./index.dc13a533.js"),["assets/index.dc13a533.js","assets/index.9e52deba.css","assets/index.e5e6c754.js","assets/index.384edb68.css","assets/index.5e1fa168.js","assets/index.3603af3c.css","assets/groupBy.88271069.js","assets/_baseGet.6a7418c9.js","assets/_createAggregator.87a98d7b.js","assets/get.131f9f4f.js","assets/workbenchContext.a6b76e3b.js","assets/index.6f73eb32.js","assets/index.39f6a8a8.css","assets/DialogWrap.947e0e2f.js","assets/KeyCode.9c493596.js","assets/pickAttrs.c5bbb5fc.js","assets/conductUtil.03f406cc.js","assets/conductUtil.5824820e.css","assets/RightOutlined.73e4cc97.js","assets/index.e54b5c9c.js","assets/Overflow.321ca619.js","assets/use-immer.module.1d9a0526.js","assets/index.07d786b1.js","assets/index.e36cf68e.css","assets/index.3e81d184.js","assets/index.37679684.css","assets/index.8958a719.js","assets/index.886c36ca.css","assets/getDataOrAriaProps.e48b8c96.js","assets/printer.b0e2956d.js","assets/printer.3ab34835.css","assets/DownOutlined.75881d1e.js","assets/index.b6cece06.js","assets/index.6edff92c.css","assets/index.6926b693.js","assets/index.34425506.css","assets/index.esm.0df65c6e.js","assets/index.esm.e5edd667.js","assets/keyBy.400ebaf7.js","assets/index.67bc873e.js","assets/index.50ece414.css","assets/PrismaSchemaContext.c1116ab6.js","assets/index.6fa46df0.js","assets/index.698d0db5.css","assets/Tree.4b4dd3c6.js","assets/Tree.dba962ae.css","assets/uniq.2129c997.js","assets/_baseUniq.d23dbdee.js","assets/utils.aecd68b7.js","assets/index.60d20720.js","assets/index.73631269.css","assets/css.7dd30b7b.js","assets/dataSource.f9c7deae.js","assets/storage.aee759da.js","assets/db.84db3282.js","assets/index.8fd962f9.js","assets/index.0d63861b.css","assets/calcTime.a918c2eb.js","assets/dayjs.min.fccffbb3.js","assets/duration.1c0302a6.js"])),{Header:da,Footer:ha,Sider:pa,Content:ma}=_e;function fa(s){const a=le(),[o,d]=n.exports.useState(),[p,b]=n.exports.useState("--"),[f,r]=n.exports.useState("--"),[F,C]=n.exports.useState(!1),[y,x]=n.exports.useState(),[B,E]=n.exports.useState(!1),[I,k]=n.exports.useState(!1),[A,q]=n.exports.useState(!1),$=n.exports.useRef(),{mutate:V}=Ue();n.exports.useRef();const[P,X]=n.exports.useState(!1),[z,G]=dt({api:!1,auth:!1,dataSource:!1,storage:!1}),{setLogs:j,logs:oe,questions:i,setQuestions:w}=Te(u=>({logs:u.logs,setLogs:u.setLogs,questions:u.questions,setQuestions:u.setQuestions}));n.exports.useEffect(()=>{N.get("/wdg/barOnce").then(u=>{b(u.version),r(u.env)})},[]);const m=Oe();n.exports.useEffect(()=>{at(m!=null?m:"")},[m]),re("engine","getStatus",u=>{d(u),u.engineStatus===W.Started&&(V(),be.emit({event:"compileFinish"}))}),re("engine","pushStatus",u=>{d({...o,engineStatus:u.engineStatus,startTime:u.startTime}),u.engineStatus===W.Started&&(V(),be.emit({event:"compileFinish"}))}),re("engine","getHookStatus",u=>{d({...o,hookStatus:u.hookStatus})}),re("log","getLogs",u=>{j(u.logs)}),re("log","appendLog",u=>{j(oe.concat(u.logs))}),re("question","getQuestions",u=>{w(u.questions)}),re("question","setQuestions",u=>{w(u.questions)}),n.exports.useEffect(()=>{ve({channel:"engine",event:"getStatus"}),ve({channel:"log",event:"getLogs"}),ve({channel:"question",event:"getQuestions"})},[]),n.exports.useEffect(()=>{var Q;const u=new AbortController;return u.signal,new Headers().set("X-FB-Authentication",(Q=Oe())!=null?Q:""),()=>{u.abort()}},[A]);const g=u=>{G(U=>{U[u]=!U[u]})},O=u=>{X(u)},L=n.exports.useCallback(async()=>P?await new Promise(u=>{ue.confirm({title:a.formatMessage({id:"5gzWCE",defaultMessage:[{type:0,value:"\u5373\u5C06\u79BB\u5F00\u5F53\u524D\u9875\u9762\uFF0C\u672A\u4FDD\u5B58\u7684\u5185\u5BB9\u5C06\u88AB\u4E22\u5931\uFF0C\u662F\u5426\u786E\u8BA4\uFF1F"}]}),onOk:()=>{X(!1),u(!0)},onCancel:()=>u(!1)})}):!0,[P]),v=l(_e,{className:`h-100vh ${ge.workbench}`,children:[!I&&e(da,{className:ge.header,children:e(Wt,{onToggleSider:()=>E(!B),engineStatus:o==null?void 0:o.engineStatus})}),l(_e,{children:[e(pa,{width:230,style:{marginLeft:B||I?-230:0},theme:"light",className:ge.sider,children:e(Zs,{})}),l(_e,{className:"relative",children:[e(ma,{className:"bg-[#FBFBFB]",children:s.children}),F?e(n.exports.Suspense,{children:e(ca,{style:{left:0,right:0,bottom:0},toggleWindow:()=>C(!F),defaultTab:y})}):e(J,{})]})]}),!I&&e(ha,{className:ge.footer,children:e(la,{version:p,env:f,startTime:o==null?void 0:o.startTime,engineStatus:o==null?void 0:o.engineStatus,hookStatus:o==null?void 0:o.hookStatus,toggleWindow:u=>{x(u),C(!F)}})})]});return de().pathname.match(/^\/workbench\/modeling($|\/)/)?e(n.exports.Suspense,{children:e(ua,{children:v})}):e(he.Provider,{value:{engineStatus:o==null?void 0:o.engineStatus,triggerPageEvent:u=>{var U;(U=$.current)==null||U.call($,u)},registerPageListener:u=>{$.current=u},refreshMap:z,onRefreshMenu:g,onRefreshState:()=>q(!A),editFlag:P,markEdit:O,navCheck:L,setFullscreen:k,isFullscreen:I,setHideSide:E,isHideSide:B},children:v})}function ga(){const{config:s}=n.exports.useContext(nt);return s?e(fa,{children:e(n.exports.Suspense,{children:e(ot,{})})}):null}const Ua=Object.freeze(Object.defineProperty({__proto__:null,default:ga},Symbol.toStringTag,{value:"Module"}));export{Be as Q,Te as u,Ua as w};
