import{K as b,O as C,ag as s,j as e,ad as i,Q as d,V as u}from"./index-878ae04f.js";import{I as f}from"./index-413c3a0a.js";import{U as I}from"./index-d485821f.js";import{S as w}from"./index-8bc49bea.js";import{P as N}from"./PaperClipOutlined-23332043.js";import{S}from"./index-18b33e93.js";import{C as k}from"./index-f16a6ba4.js";import{I as g}from"./index-6cd687ed.js";import{M as x}from"./MinusCircleOutlined-22e202b9.js";import"./common-7ac8785d.js";import"./index-5eea6c2d.js";import"./useShowArrow-7d42e6af.js";import"./index-38205a49.js";import"./DownOutlined-5481b2e5.js";import"./PurePanel-bdac947e.js";import"./index-63198d2e.js";import"./index-90e62e13.js";function W(){const a=b(),{globalSetting:c,updateGlobalSetting:h}=C(),[n]=s.useForm(),o="globalRateLimit",j=s.useWatch([o,"enabled"],n);if(!c)return null;async function M(t){const r=u.loading(a.formatMessage({id:"IyVzrX",defaultMessage:[{type:0,value:"保存中"}]}),0);try{await h(t)&&u.success(a.formatMessage({id:"jhfb/7",defaultMessage:[{type:0,value:"保存成功"}]}))}catch{}r()}return e.jsx("div",{className:"pt-6",children:e.jsxs(s,{className:"common-form",form:n,labelCol:{span:5},wrapperCol:{span:12},onFinish:M,labelAlign:"right",initialValues:c,children:[e.jsxs(s.Item,{label:a.formatMessage({id:"mnyTZ7",defaultMessage:[{type:0,value:"CSRF 保护"}]}),tooltip:a.formatMessage({id:"ZrgikE",defaultMessage:[{type:0,value:"为POST请求添加 CSRF token 保护"}]}),children:[e.jsx(s.Item,{name:"enableCSRFProtect",valuePropName:"checked",noStyle:!0,children:e.jsx(w,{})}),e.jsx(i,{type:"link",icon:e.jsx(N,{}),href:"https://docs.fireboom.io/shi-yong-bu-shu-shang-xian/security/csrf-token-protection",target:"csrf",children:e.jsx(d,{id:"I2iPb9",defaultMessage:[{type:0,value:"查看文档"}]})})]}),e.jsx(s.Item,{label:a.formatMessage({id:"9sTPgx",defaultMessage:[{type:0,value:"允许HOST"}]}),tooltip:a.formatMessage({id:"Kc1PjJ",defaultMessage:[{type:0,value:"指定允许访问的源（域名、协议、端口），使用通配符 * 表示允许所有源进行访问，也可以指定具体的源"}]}),children:e.jsx(s.List,{name:["allowedHostNames"],children:(t,{add:r,remove:m},{errors:p})=>e.jsxs(e.Fragment,{children:[t.map((l,y)=>e.jsxs("div",{style:{width:"90%"},className:"flex items-center mb-4",children:[e.jsx(f,{className:"flex-1",formItemProps:{...l,noStyle:!0}}),e.jsx(x,{className:"ml-2",onClick:()=>m(l.name)})]},l.key)),e.jsxs(s.Item,{style:{marginTop:t.length?"16px":""},wrapperCol:{span:12},children:[e.jsx(i,{type:"dashed",onClick:()=>r(),style:{width:"60%"},children:a.formatMessage({id:"GEfsgi",defaultMessage:[{type:0,value:"增加允许HOST"}]})}),e.jsx(s.ErrorList,{errors:p})]})]})})}),e.jsx(s.Item,{label:a.formatMessage({id:"qZjJ7M",defaultMessage:[{type:0,value:"重定向URL"}]}),children:e.jsx(s.List,{name:"authorizedRedirectUris",children:(t,{add:r,remove:m},{errors:p})=>e.jsxs(e.Fragment,{children:[t.map((l,y)=>e.jsxs("div",{style:{width:"90%"},className:"flex items-center mb-4",children:[e.jsx(f,{className:"flex-1",formItemProps:{...l,noStyle:!0},inputRender:v=>e.jsx(I,{...v})}),e.jsx(x,{className:"ml-2",onClick:()=>m(l.name)})]},l.key)),e.jsxs(s.Item,{style:{marginTop:t.length?"16px":""},wrapperCol:{span:12},children:[e.jsx(i,{type:"dashed",onClick:()=>r(),style:{width:"60%"},children:a.formatMessage({id:"lMyO3E",defaultMessage:[{type:0,value:"增加重定向URL"}]})}),e.jsx(s.ErrorList,{errors:p})]})]})})}),e.jsx(s.Item,{label:a.formatMessage({id:"YdH1/x",defaultMessage:[{type:0,value:"全局 API 限流"}]}),children:e.jsxs(S,{className:"w-full",align:"center",children:[e.jsx(s.Item,{wrapperCol:{span:24},name:[o,"enabled"],valuePropName:"checked",children:e.jsx(k,{children:e.jsx(d,{id:"sZSyGZ",defaultMessage:[{type:0,value:"启用"}]})})}),j&&e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{className:"w-28",name:[o,"perSecond"],wrapperCol:{span:24},rules:[{required:!0,message:a.formatMessage({id:"H4TUEb",defaultMessage:[{type:0,value:"不能为空"}]})}],children:e.jsx(g,{min:1,precision:0,defaultValue:60,placeholder:a.formatMessage({id:"JjROJw",defaultMessage:[{type:0,value:"60"}]}),suffix:a.formatMessage({id:"XEPmlP",defaultMessage:[{type:0,value:"秒"}]})})}),e.jsx(s.Item,{className:"w-28",name:[o,"requests"],wrapperCol:{span:24},rules:[{required:!0,message:a.formatMessage({id:"H4TUEb",defaultMessage:[{type:0,value:"不能为空"}]})}],children:e.jsx(g,{min:0,precision:0,defaultValue:120,placeholder:a.formatMessage({id:"ZDww9z",defaultMessage:[{type:0,value:"100"}]}),suffix:a.formatMessage({id:"7cAtfM",defaultMessage:[{type:0,value:"次"}]})})})]})]})}),e.jsxs(s.Item,{wrapperCol:{offset:5,span:12},children:[e.jsx(i,{className:"btn-cancel mr-4",onClick:()=>n.resetFields(),children:e.jsx(d,{id:"r2dEd/",defaultMessage:[{type:0,value:"重置"}]})}),e.jsx(i,{className:"btn-save",onClick:n.submit,children:e.jsx(d,{id:"b5l2vN",defaultMessage:[{type:0,value:"保存"}]})})]})]})})}export{W as default};
