import{j as s,K as F,r as f}from"./index-a194352f.js";import{x as t,g as G,h as j,A as x}from"./hook-43824aee.js";import{g as R,S as o}from"./index-58652354.js";import"./interface-41bd3122.js";import"./engine-9b49d695.js";import"./workbenchContext-5e70c262.js";import"./index-ce3c58de.js";import"./lock-7553aa7c.js";import"./variable-62d048d3.js";import"./common-7ac8785d.js";import"./hotkey-3a258436.js";import"./store-fb3bcbe5.js";import"./parser-0b83345b.js";import"./Breadcrumb-a12a4712.js";import"./DownOutlined-41d61a23.js";import"./index-9ecf1558.js";import"./LeftOutlined-e97baa49.js";import"./PurePanel-1bea721a.js";import"./index-5ad4076b.js";import"./index-e03870b1.js";import"./EditFilled-90066675.js";import"./index-3bac1495.js";import"./index-a13c9690.js";import"./index-712741e9.js";import"./useShowArrow-630a3465.js";import"./index-66c15b14.js";import"./main-7459389b.js";import"./toNumber-ac9ebd8c.js";import"./utils-9cc409ea.js";import"./dayjs.min-3f69c204.js";import"./utils-9b986f1e.js";import"./DeleteOutlined-88a4ce35.js";import"./index-24b15e3c.js";import"./index-9c226ee5.js";import"./index-eb7e93a9.js";import"./index-cd2698a3.js";import"./index-8b7c4190.js";import"./PlusOutlined-1c56fe10.js";import"./index-a65b0c71.js";import"./index-4a7ab521.js";import"./index-ece89910.js";import"./globalContext-ca83e6af.js";const h=({index:d,text:r})=>s.jsxs("div",{className:"bg-white rounded-sm flex h-5 w-14 items-center justify-center",style:{border:"0.3px solid rgba(175, 176, 180, 0.6)"},children:[s.jsx("span",{className:"rounded-md bg-[#6F6F6F] h-3 text-white text-center leading-none text-[10px] w-3",children:d}),s.jsx("span",{className:"text-xs ml-1",children:r})]}),C=24,I=410,u=320,c=(I-u)/2,ye=({globalHookState:d,hookState:r,directiveState:n,apiDesc:m,onEditHook:a,onToggleHook:i})=>{const l=F(),g=f.useRef(null);return f.useEffect(()=>(t.Graph.registerNode("endpoint",{inherit:"rect",width:u,height:28,attrs:{body:{strokeWidth:.5,stroke:"rgba(95, 98, 105, 0.6)",fill:"#F3F9FD",rx:14,ry:14},text:{fontSize:14,fill:"#333333"}}}),t.Graph.registerNode("decision",{inherit:"polygon",width:112,height:50,attrs:{body:{strokeWidth:.5,stroke:"#F2B241",fill:"#ffffff",refPoints:"0,10 10,0 20,10 10,20"},text:{fontSize:14,fill:"#F3B13F"}}}),t.Graph.registerNode("operation",{inherit:"rect",width:u,height:44,attrs:{body:{strokeWidth:.5,stroke:{type:"linearGradient",attrs:{x1:"100%",y1:"100%",x2:"0%",y2:"0%"},stops:[{offset:"0%",color:"#FF9378"},{offset:"100%",color:"#E13D5B"}]},fill:{type:"linearGradient",attrs:{x1:"100%",y1:"0%",x2:"0%",y2:"100%"},stops:[{offset:"0%",color:"#FFF3F8"},{offset:"100%",color:"#FFDBDD"}]},rx:6,ry:6},text:{fontSize:14,fill:"#E92E5E"}}}),t.Graph.registerNode("globalHook",{inherit:"rect",width:20,height:20,markup:[{tagName:"image"}],attrs:{image:{"xlink:href":G,width:20,height:20,refX:0,refY:0,filter:{name:"dropShadow",args:{color:"rgba(202,83,206,0.33)",dx:0,dy:2,blur:7}}}}}),t.Graph.registerNode("hook",{inherit:"rect",width:20,height:20,markup:[{tagName:"image"}],attrs:{image:{"xlink:href":j,width:20,height:20,refX:0,refY:0,filter:{name:"dropShadow",args:{color:"rgba(56,110,252,0.23)",dx:0,dy:2,blur:4}}}}}),t.Graph.registerEdge("orange",{zIndex:-1,attrs:{line:{stroke:"#FF9810",strokeWidth:"1px",targetMarker:{name:"block",width:3,height:4}}}}),t.Graph.registerEdge("blue",{zIndex:-1,attrs:{line:{stroke:"#1034FF",strokeWidth:"1px",targetMarker:{name:"block",width:3,height:4}}}}),t.Graph.registerNode("flowLabel",{inherit:"rect",height:14,attrs:{body:{fill:"#fff",strokeWidth:.3,stroke:"rgba(175, 176, 180, 0.6)",rx:7,ry:7},text:{fontSize:12,fill:"#6f6f6f"}}}),t.Graph.registerEdge("rejectLine",{attrs:{line:{stroke:"#787D8B",strokeWidth:.5,strokeDasharray:"3 3",targetMarker:{name:"block",width:3,height:5}}}}),()=>{t.Graph.unregisterNode("endpoint"),t.Graph.unregisterNode("decision"),t.Graph.unregisterNode("operation"),t.Graph.unregisterNode("globalHook"),t.Graph.unregisterNode("hook"),t.Graph.unregisterNode("flowLabel"),t.Graph.unregisterEdge("orange"),t.Graph.unregisterEdge("blue"),t.Graph.unregisterEdge("rejectLine")}),[]),f.useEffect(()=>{var y,w;const e=new t.Graph({container:g.current,mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},interacting:{nodeMovable:!1,edgeMovable:!1,edgeLabelMovable:!1,arrowheadMovable:!1,vertexMovable:!1,useEdgeTools:!1},background:{color:"#F8F9FD",image:R,size:{width:22,height:22},repeat:"repeat"},autoResize:!0}),N=e.createNode({shape:"endpoint",label:l.formatMessage({id:"e42x18",defaultMessage:[{type:0,value:"客户端"}]}),x:c,y:C}),v=e.createNode({shape:"operation",label:"Subscription Operation",x:c,y:356}),M=e.createNode({shape:"endpoint",label:l.formatMessage({id:"bwYWez",defaultMessage:[{type:0,value:"事件源"}]}),x:c,y:507});e.addNodes([N,v,M]),e.addEdges([{shape:"orange",source:{x:160,y:52},target:{x:160,y:356}},{shape:"blue",source:{x:240,y:356},target:{x:240,y:52}},{shape:"orange",source:{x:300,y:52},target:{x:300,y:356}},{shape:"orange",source:{x:176,y:400},target:{x:176,y:507}},{shape:"blue",source:{x:220,y:507},target:{x:220,y:400}},{shape:"orange",source:{x:322,y:400},target:{x:322,y:507}}]),(n.fromClaim||(y=m.authenticationConfig)!=null&&y.authRequired)&&(e.addNode({shape:"decision",label:l.formatMessage({id:"3bdXhI",defaultMessage:[{type:0,value:"登录校验?"}]}),x:104,y:72}),e.addEdge({shape:"rejectLine",source:{x:100,y:97},target:{x:32,y:97}}),e.addNode({shape:"flowLabel",label:"401",width:26,height:14,x:58,y:90})),n.rbac&&(e.addNode({shape:"decision",label:l.formatMessage({id:"lPNqbT",defaultMessage:[{type:0,value:"授权校验?"}]}),x:104,y:139}),e.addEdge({shape:"rejectLine",source:{x:100,y:164},target:{x:32,y:164}}),e.addNode({shape:"flowLabel",label:"401",width:26,height:14,x:57,y:157})),n.jsonSchema&&(e.addNode({shape:"decision",label:l.formatMessage({id:"hv0Nju",defaultMessage:[{type:0,value:"入参校验?"}]}),x:104,y:208}),e.addEdge({shape:"rejectLine",source:{x:100,y:233},target:{x:32,y:233}}),e.addNode({shape:"flowLabel",label:"400",width:26,height:14,x:57,y:226})),(n.fromClaim||(w=m.authenticationConfig)!=null&&w.authRequired||n.rbac||n.jsonSchema)&&e.addNode({shape:"rect",label:l.formatMessage({id:"TxBFu3",defaultMessage:[{type:0,value:"结"},{type:1,value:"br"},{type:0,value:"束"}]},{br:`
`}),x:11,y:82,width:21,height:164,attrs:{body:{stroke:"#E9EBF3",strokeWidth:3,fill:"none"},text:{fill:"#B6BACC",fontSize:12}}}),new x({shape:"globalHook",x:166,y:450},[{shape:"react-shape",width:114,height:20,component:s.jsx(o,{enabled:d.onConnectionInit.enabled,label:"onConnectionInit",onClick:()=>{a==null||a(d.onConnectionInit)},onToggleEnabled:p=>i==null?void 0:i(d.onConnectionInit,p)}),x:50,y:480}],"arrow").addToGraph(e,{position:"left",fixedTargetPort:"top",customVertices:[{x:120,y:464}]});const b=[{shape:"react-shape",width:114,height:20,component:s.jsx(o,{enabled:r.preResolve.enabled,label:"preResolve",onClick:()=>{a==null||a(r.preResolve)},onToggleEnabled:p=>i==null?void 0:i(r.preResolve,p)}),x:4,y:264}];r.mutatingPreResolve.can&&b.push({shape:"react-shape",width:114,height:20,component:s.jsx(o,{enabled:r.mutatingPreResolve.enabled,label:"mutatingPreResolve",onClick:()=>{a==null||a(r.mutatingPreResolve)},onToggleEnabled:p=>i==null?void 0:i(r.mutatingPreResolve,p)}),x:4,y:298}),new x({shape:"hook",x:150,y:280},b,"arrow").addToGraph(e,{position:"left"}),new x({shape:"hook",x:230,y:240},[{shape:"react-shape",width:114,height:20,component:s.jsx(o,{enabled:r.mutatingPostResolve.enabled,label:"mutatingPostResolve",onClick:()=>{a==null||a(r.mutatingPostResolve)},onToggleEnabled:p=>i==null?void 0:i(r.mutatingPostResolve,p)}),x:288,y:224},{shape:"react-shape",width:114,height:20,component:s.jsx(o,{enabled:r.postResolve.enabled,label:"postResolve",onClick:()=>{a==null||a(r.postResolve)},onToggleEnabled:p=>i==null?void 0:i(r.postResolve,p)}),x:288,y:258}],"arrow").addToGraph(e),[{shape:"react-shape",x:132,y:315,component:s.jsx(h,{index:"1",text:l.formatMessage({id:"m6bUGD",defaultMessage:[{type:0,value:"订阅"}]})})},{shape:"react-shape",x:148,y:415,component:s.jsx(h,{index:"2",text:l.formatMessage({id:"m6bUGD",defaultMessage:[{type:0,value:"订阅"}]})})},{shape:"react-shape",x:192,y:466,component:s.jsx(h,{index:"3",text:l.formatMessage({id:"FbmCny",defaultMessage:[{type:0,value:"推送"}]})})},{shape:"react-shape",x:204,y:188,component:s.jsx(h,{index:"4",text:l.formatMessage({id:"FbmCny",defaultMessage:[{type:0,value:"推送"}]})})},{shape:"react-shape",x:272,y:305,component:s.jsx(h,{index:"5",text:l.formatMessage({id:"blp0RF",defaultMessage:[{type:0,value:"取消"}]})})},{shape:"react-shape",x:292,y:442,component:s.jsx(h,{index:"6",text:l.formatMessage({id:"blp0RF",defaultMessage:[{type:0,value:"取消"}]})})}].forEach(p=>{e.addNode(p)}),e.addNode({shape:"rect",x:286,y:552,label:l.formatMessage({id:"IoROAi",defaultMessage:[{type:0,value:"注：3 → 4 重复执行"}]}),attrs:{body:{fill:"none",stroke:"none"},text:{fill:"#9296A0",fontSize:12}}})},[m,n,d,r,a]),s.jsx("div",{className:"flex flex-shrink-0 w-full overflow-x-auto overflow-y-hidden !h-full",children:s.jsx("div",{className:"flex-1 min-h-175 min-w-102",ref:g})})};export{ye as default};
