import{d as S,Z as m,r as h,c,j as e,f as l,F as P,g as F,I as M}from"./index.e5e6c754.js";import{M as q}from"./index.6f73eb32.js";import"./index.67bc873e.js";import{P as R}from"./index.6fa46df0.js";import{T as K}from"./Table.08c4f5f5.js";import"./index.3e81d184.js";import"./conductUtil.03f406cc.js";import"./index.5e1fa168.js";import"./iconUtil.31c13224.js";import"./index.8958a719.js";import"./index.0cfa4828.js";import"./Tree.4b4dd3c6.js";import{i}from"./use-immer.module.1d9a0526.js";import{s as E}from"./subs.module.a70cc990.js";import"./DialogWrap.947e0e2f.js";import"./KeyCode.9c493596.js";import"./pickAttrs.c5bbb5fc.js";import"./css.7dd30b7b.js";import"./useForceUpdate.09faac07.js";import"./RightOutlined.73e4cc97.js";import"./index.daad23d2.js";import"./DownOutlined.75881d1e.js";import"./index.e54b5c9c.js";import"./Overflow.321ca619.js";import"./getDataOrAriaProps.e48b8c96.js";function pe(){const s=S(),[n]=m.useForm(),[d,p]=h.exports.useState();i(!1);const[C,D]=i({}),[x,u]=i(!1);i(!1);const[X,b]=i(!0),[Z,k]=i([]),[g,v]=i(-1),[y,A]=i([]);h.exports.useState(""),h.exports.useEffect(()=>{c.get("/env").then(a=>{a.forEach(t=>{t.oldKey=t.key}),A(a),k(a.filter(t=>{t.envType==1}))})},[d]);const B=a=>{if(g==-1)c.post("/env",a).then(()=>{p(!d),u(!1)});else{const t={...a,id:g};c.put("/env",t).then(()=>{p(!d),u(!1)})}},w=a=>{console.log("Failed:",a)},I=a=>{c.delete(`/env/${a}`).then(()=>{p(!d)})},N=()=>{n.resetFields(),u(!0)},V=()=>{const a=n.getFieldsError().some(({errors:t})=>t.length);b(a)},T=[{title:s.formatMessage({id:"GHE+9W",defaultMessage:[{type:0,value:"\u53D8\u91CF\u540D"}]}),dataIndex:"key",key:"key",width:320},{title:s.formatMessage({id:"KiiWJR",defaultMessage:[{type:0,value:"\u53D8\u91CF\u503C"}]}),dataIndex:"devEnv",key:"devEnv",render:(a,t)=>(console.log(t),e("span",{onClick:()=>D(o=>{o[t.key]=!o[t.key]}),children:C[t.key]?l("div",{children:[a,e("img",{alt:"xiaoyanjing-chakan",src:"assets/iconfont/xiaoyanjing-chakan.svg",style:{height:"1em",width:"1em"},className:"ml-6"})]}):l("div",{children:[e("span",{children:"**************"}),e("img",{alt:"xiaoyanjing-yincang",src:"assets/iconfont/xiaoyanjing-yincang.svg",style:{height:"1em",width:"1em"},className:"ml-6"})]})}))},{title:s.formatMessage({id:"UtE0dS",defaultMessage:[{type:0,value:"\u64CD\u4F5C"}]}),dataIndex:"action",width:200,render:(a,{id:t,key:o,devEnv:f,proEnv:j,oldKey:z})=>l("div",{children:[e("img",{alt:"zhongmingming",src:"assets/iconfont/zhongmingming.svg",style:{height:"1em",width:"1em"},onClick:()=>{u(!0),n.setFieldsValue({key:o,devEnv:f,proEnv:j,oldKey:z}),v(t)},className:"mr-3"}),e(R,{title:s.formatMessage({id:"nS8PfW",defaultMessage:[{type:0,value:"\u786E\u5B9A\u8981\u5220\u9664?"}]}),okText:s.formatMessage({id:"r0/TUu",defaultMessage:[{type:0,value:"\u786E\u5B9A"}]}),cancelText:s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"\u53D6\u6D88"}]}),onConfirm:r=>{r.stopPropagation(),I(o)},onCancel:r=>{r.stopPropagation()},children:e("img",{alt:"shanchu",src:"assets/iconfont/shanchu.svg",style:{height:"1em",width:"1em"},onClick:r=>r.stopPropagation()})})]})}];return e(P,{children:l("div",{className:"bg-white h-full px-8 pt-7",children:[l("div",{className:"flex justify-between",children:[e("div",{className:"mt-0",children:e("span",{children:e(F,{id:"txDRJz",defaultMessage:[{type:0,value:"\u73AF\u5883\u53D8\u91CF"}]})})}),e("button",{className:"btn-save mb-4 border-none font-14px",onClick:N,children:e("span",{className:"h-7",onClick:()=>{n.setFieldsValue({key:"",devEnv:"",proEnv:""}),u(!0),v(-1)},children:e(F,{id:"qx0Xj9",defaultMessage:[{type:0,value:"\u65B0\u5EFA\u73AF\u5883\u53D8\u91CF"}]})})})]}),e(q,{mask:!1,title:g===-1?s.formatMessage({id:"AeO+ID",defaultMessage:[{type:0,value:"\u65B0\u5EFA\u53D8\u91CF"}]}):s.formatMessage({id:"f0XHRN",defaultMessage:[{type:0,value:"\u4FEE\u6539\u73AF\u5883\u53D8\u91CF"}]}),forceRender:!0,transitionName:"",bodyStyle:{width:"549px",height:"150px",margin:"12px auto"},open:x,onCancel:()=>u(!1),okText:e("span",{className:E["save-env-btn"],onClick:()=>{n.submit()},children:g===-1?s.formatMessage({id:"BtZh7z",defaultMessage:[{type:0,value:"\u521B\u5EFA"}]}):s.formatMessage({id:"b5l2vN",defaultMessage:[{type:0,value:"\u4FDD\u5B58"}]})}),cancelText:l("span",{className:"w-10",children:[s.formatMessage({id:"2QzYmY",defaultMessage:[{type:0,value:"\u53D6\u6D88"}]})," "]}),okType:"text",children:l(m,{name:"envList",form:n,validateTrigger:["onBlur","onChange"],className:"ml-15",labelCol:{span:4},wrapperCol:{span:15},onFinish:a=>{B(a)},autoComplete:"off",onValuesChange:V,onFinishFailed:w,labelAlign:"left",children:[e(m.Item,{label:s.formatMessage({id:"ekxzlF",defaultMessage:[{type:0,value:"\u540D\u79F0"}]}),name:"key",rules:[{required:!0,message:s.formatMessage({id:"mfZMW6",defaultMessage:[{type:0,value:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]})},{pattern:new RegExp("^[a-zA-Z_][a-zA-Z0-9_]*$","g"),message:s.formatMessage({id:"VmsX4o",defaultMessage:[{type:0,value:"\u4EE5\u5B57\u6BCD\u6216\u4E0B\u5212\u7EBF\u5F00\u5934\uFF0C\u53EA\u80FD\u7531\u6570\u5B57\u3001\u5B57\u6BCD\u3001\u4E0B\u5212\u7EBF\u7EC4\u6210"}]})},{validator:(a,t)=>t===n.getFieldValue("oldKey")?Promise.resolve():y.find(f=>f.key==t)?Promise.reject(s.formatMessage({id:"/aSrX0",defaultMessage:[{type:0,value:"\u540D\u79F0\u91CD\u590D"}]})):Promise.resolve()}],children:e(M,{})}),e(m.Item,{name:"oldKey",hidden:!0}),e(m.Item,{label:s.formatMessage({id:"zbqD5q",defaultMessage:[{type:0,value:"\u503C"}]}),name:"devEnv",rules:[{required:!0,pattern:/^.{1,256}$/g,message:s.formatMessage({id:"ILCVXB",defaultMessage:[{type:0,value:"\u8BF7\u8F93\u5165\u957F\u5EA6\u4E0D\u5927\u4E8E256\u7684\u975E\u7A7A\u503C"}]})}],children:e(M,{})})]})}),e(K,{columns:T,dataSource:y,rowKey:a=>a.key,pagination:!1,className:"mb-3 "+E.envTable})]})})}export{pe as default};
