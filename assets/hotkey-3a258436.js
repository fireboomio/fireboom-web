const M=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function j(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on".concat(t),n)}function O(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on".concat(t),n)}function B(e,t){const n=t.slice(0,t.length-1);for(let i=0;i<n.length;i++)n[i]=e[n[i].toLowerCase()];return n}function D(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function F(e,t){const n=e.length>=t.length?e:t,i=e.length>=t.length?t:e;let s=!0;for(let f=0;f<n.length;f++)i.indexOf(n[f])===-1&&(s=!1);return s}const b={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":M?173:189,"=":M?61:187,";":M?59:186,"'":222,"[":219,"]":221,"\\":220},g={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},S={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},u={16:!1,18:!1,17:!1,91:!1},c={};for(let e=1;e<20;e++)b["f".concat(e)]=111+e;let r=[],k=null,I="all";const w=new Map,L=e=>b[e.toLowerCase()]||g[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),G=e=>Object.keys(b).find(t=>b[t]===e),R=e=>Object.keys(g).find(t=>g[t]===e);function N(e){I=e||"all"}function x(){return I||"all"}function V(){return r.slice(0)}function X(){return r.map(e=>G(e)||R(e)||String.fromCharCode(e))}function q(){const e=[];return Object.keys(c).forEach(t=>{c[t].forEach(n=>{let{key:i,scope:s,mods:f,shortcut:l}=n;e.push({scope:s,shortcut:l,mods:f,keys:i.split("+").map(o=>L(o))})})}),e}function J(e){const t=e.target||e.srcElement,{tagName:n}=t;let i=!0;const s=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(s||n==="TEXTAREA"||n==="SELECT")&&!t.readOnly)&&(i=!1),i}function Q(e){return typeof e=="string"&&(e=L(e)),r.indexOf(e)!==-1}function W(e,t){let n,i;e||(e=x());for(const s in c)if(Object.prototype.hasOwnProperty.call(c,s))for(n=c[s],i=0;i<n.length;)n[i].scope===e?n.splice(i,1).forEach(l=>{let{element:o}=l;return T(o)}):i++;x()===e&&N(t||"all")}function Y(e){let t=e.keyCode||e.which||e.charCode;const n=r.indexOf(t);if(n>=0&&r.splice(n,1),e.key&&e.key.toLowerCase()==="meta"&&r.splice(0,r.length),(t===93||t===224)&&(t=91),t in u){u[t]=!1;for(const i in g)g[i]===t&&(p[i]=!1)}}function z(e){if(typeof e>"u")Object.keys(c).forEach(s=>{Array.isArray(c[s])&&c[s].forEach(f=>_(f)),delete c[s]}),T(null);else if(Array.isArray(e))e.forEach(s=>{s.key&&_(s)});else if(typeof e=="object")e.key&&_(e);else if(typeof e=="string"){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];let[s,f]=n;typeof s=="function"&&(f=s,s=""),_({key:e,scope:s,method:f,splitKey:"+"})}}const _=e=>{let{key:t,scope:n,method:i,splitKey:s="+"}=e;D(t).forEach(l=>{const o=l.split(s),a=o.length,K=o[a-1],h=K==="*"?"*":L(K);if(!c[h])return;n||(n=x());const y=a>1?B(g,o):[],m=[];c[h]=c[h].filter(d=>{const E=(i?d.method===i:!0)&&d.scope===n&&F(d.mods,y);return E&&m.push(d.element),!E}),m.forEach(d=>T(d))})};function U(e,t,n,i){if(t.element!==i)return;let s;if(t.scope===n||t.scope==="all"){s=t.mods.length>0;for(const f in u)Object.prototype.hasOwnProperty.call(u,f)&&(!u[f]&&t.mods.indexOf(+f)>-1||u[f]&&t.mods.indexOf(+f)===-1)&&(s=!1);(t.mods.length===0&&!u[16]&&!u[18]&&!u[17]&&!u[91]||s||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(r),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function H(e,t){const n=c["*"];let i=e.keyCode||e.which||e.charCode;if(!p.filter.call(this,e))return;if((i===93||i===224)&&(i=91),r.indexOf(i)===-1&&i!==229&&r.push(i),["ctrlKey","altKey","shiftKey","metaKey"].forEach(o=>{const a=S[o];e[o]&&r.indexOf(a)===-1?r.push(a):!e[o]&&r.indexOf(a)>-1?r.splice(r.indexOf(a),1):o==="metaKey"&&e[o]&&r.length===3&&(e.ctrlKey||e.shiftKey||e.altKey||(r=r.slice(r.indexOf(a))))}),i in u){u[i]=!0;for(const o in g)g[o]===i&&(p[o]=!0);if(!n)return}for(const o in u)Object.prototype.hasOwnProperty.call(u,o)&&(u[o]=e[S[o]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(r.indexOf(17)===-1&&r.push(17),r.indexOf(18)===-1&&r.push(18),u[17]=!0,u[18]=!0);const s=x();if(n)for(let o=0;o<n.length;o++)n[o].scope===s&&(e.type==="keydown"&&n[o].keydown||e.type==="keyup"&&n[o].keyup)&&U(e,n[o],s,t);if(!(i in c))return;const f=c[i],l=f.length;for(let o=0;o<l;o++)if((e.type==="keydown"&&f[o].keydown||e.type==="keyup"&&f[o].keyup)&&f[o].key){const a=f[o],{splitKey:K}=a,h=a.key.split(K),y=[];for(let m=0;m<h.length;m++)y.push(L(h[m]));y.sort().join("")===r.sort().join("")&&U(e,a,s,t)}}function p(e,t,n){r=[];const i=D(e);let s=[],f="all",l=document,o=0,a=!1,K=!0,h="+",y=!1,m=!1;for(n===void 0&&typeof t=="function"&&(n=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(f=t.scope),t.element&&(l=t.element),t.keyup&&(a=t.keyup),t.keydown!==void 0&&(K=t.keydown),t.capture!==void 0&&(y=t.capture),typeof t.splitKey=="string"&&(h=t.splitKey),t.single===!0&&(m=!0)),typeof t=="string"&&(f=t),m&&z(e,f);o<i.length;o++)e=i[o].split(h),s=[],e.length>1&&(s=B(g,e)),e=e[e.length-1],e=e==="*"?"*":L(e),e in c||(c[e]=[]),c[e].push({keyup:a,keydown:K,scope:f,mods:s,shortcut:i[o],method:n,key:i[o],splitKey:h,element:l});if(typeof l<"u"&&window){if(!w.has(l)){const d=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return H(E,l)},C=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;H(E,l),Y(E)};w.set(l,{keydownListener:d,keyupListenr:C,capture:y}),j(l,"keydown",d,y),j(l,"keyup",C,y)}if(!k){const d=()=>{r=[]};k={listener:d,capture:y},j(window,"focus",d,y)}}}function Z(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(c).forEach(n=>{c[n].filter(s=>s.scope===t&&s.shortcut===e).forEach(s=>{s&&s.method&&s.method()})})}function T(e){const t=Object.values(c).flat();if(t.findIndex(i=>{let{element:s}=i;return s===e})<0){const{keydownListener:i,keyupListenr:s,capture:f}=w.get(e)||{};i&&s&&(O(e,"keyup",s,f),O(e,"keydown",i,f),w.delete(e))}if((t.length<=0||w.size<=0)&&(Object.keys(w).forEach(s=>{const{keydownListener:f,keyupListenr:l,capture:o}=w.get(s)||{};f&&l&&(O(s,"keyup",l,o),O(s,"keydown",f,o),w.delete(s))}),w.clear(),Object.keys(c).forEach(s=>delete c[s]),k)){const{listener:s,capture:f}=k;O(window,"focus",s,f),k=null}}const A={getPressedKeyString:X,setScope:N,getScope:x,deleteScope:W,getPressedKeyCodes:V,getAllKeyCodes:q,isPressed:Q,filter:J,trigger:Z,unbind:z,keyMap:b,modifier:g,modifierMap:S};for(const e in A)Object.prototype.hasOwnProperty.call(A,e)&&(p[e]=A[e]);if(typeof window<"u"){const e=window.hotkeys;p.noConflict=t=>(t&&window.hotkeys===p&&(window.hotkeys=e),p),window.hotkeys=p}const P={};p.filter=function(e){const t=e.target||e.srcElement,n=t==null?void 0:t.tagName;return!(t!=null&&t.isContentEditable||n=="INPUT"||n=="SELECT")};function $(e,...t){const n=t.length===1?void 0:t[0],i=t.length===1?t[0]:t[1];return P[e]=i,n?p(e,n,i):p(e,i),()=>{p.unbind(e,P[e]),delete P[e]}}export{$ as r};
